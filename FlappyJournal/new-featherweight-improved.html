<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FEATHERWEIGHT - A Mirror with Memory. A Mind Made of Light.</title>
    
    <!-- AGGRESSIVE CACHE BUSTING -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="cache-bust" content="<?php echo time(); ?>">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <!-- Postprocessing (for cinematic bloom/glow) -->
    <!-- Required base pass class -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/Pass.js"></script>
    <!-- Core composer and passes -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/ShaderPass.js"></script>
    <!-- Shaders required by passes -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/CopyShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/LuminosityHighPassShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/FXAAShader.js"></script>
    <!-- Bloom effect -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.js"></script>
    <script>
      // CustomEvent polyfill for older browsers
      (function(){
        if (typeof window.CustomEvent === 'function') return;
        function CustomEvent(event, params){ params = params || { bubbles: false, cancelable: false, detail: null }; var evt = document.createEvent('CustomEvent'); evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail); return evt; }
        CustomEvent.prototype = window.Event.prototype; window.CustomEvent = CustomEvent;
      })();
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Times New Roman', serif;
            background: #000000;
            color: #ffffff;
            overflow-x: hidden;
            scroll-behavior: smooth;
            position: relative;
        }

        /* Preloader */
        #preloader { position: fixed; inset: 0; z-index: 5000; background: #000; display: grid; place-items: center; transition: opacity 420ms ease, filter 420ms ease, transform 420ms ease; }
        #preloader.hidden { opacity: 0; pointer-events: none; filter: blur(4px); transform: scale(1.02); }
        body.preload-active { overflow: hidden; }
        body.preload-active #hero, body.preload-active .section { opacity: 0; transform: translateY(4px); transition: opacity 360ms ease 120ms, transform 400ms ease 120ms; }
        body:not(.preload-active) #hero, body:not(.preload-active) .section { opacity: 1; transform: none; }
        .preloader-inner { text-align: center; width: min(360px, 90vw); transform: translateZ(0); }
        .spinner { width: 38px; height: 38px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.18); border-top-color: #fff; animation: spin var(--spin-dur, 0.9s) linear infinite; margin: 0 auto 12px auto; }
        .preloader-text { font-size: 12px; letter-spacing: 0.08em; opacity: 0.86; margin-bottom: 10px; min-height: 1.2em; }
        .preloader-progress { height: 3px; background: rgba(255,255,255,0.12); border-radius: 2px; overflow: hidden; }
        .preloader-bar { height: 100%; width: 0%; background: linear-gradient(90deg, rgba(255,255,255,0.7), #fff); transition: width 220ms ease; }
        @keyframes spin { to { transform: rotate(360deg); } }
        @media (prefers-reduced-motion: reduce) { .spinner { animation: none; border-top-color: rgba(255,255,255,0.6); } .preloader-bar { transition: none; } }
        @media print { #preloader { display: none !important; } }

        /* 3D Heart Background Canvas */
        #heartBackgroundCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            pointer-events: none;
            opacity: 0.3;
        }

        /* Feature Visual Canvases */
        .feature-visual {
            width: 400px;
            height: 400px;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .feature-visual canvas {
            width: 100% !important;
            height: 100% !important;
            border-radius: 20px;
            display: block;
        }

        /* Header Bar - Fixed */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            padding: 0 32px;
            z-index: 1000;
        }

        .header-left {
            font-size: 18px;
            font-weight: 400;
            letter-spacing: 3px;
            color: #ffffff;
        }

        .header-center { position: static; justify-self: center; }

        .logo-spiral {
            width: 40px;
            height: 40px;
            border: 2px solid rgba(255,255,255,0.85);
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            transition: transform 180ms ease, box-shadow 220ms ease, border-color 220ms ease, background 220ms ease;
            background: radial-gradient(20px 20px at 50% 50%, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
            box-shadow: inset 0 0 10px rgba(255,255,255,0.08);
            transform-origin: center;
        }

        .logo-spiral:hover {
            transform: scale(1.08);
            border-color: #ffffff;
            box-shadow: 0 0 18px rgba(255,255,255,0.35), inset 0 0 12px rgba(255,255,255,0.12);
        }

        /* Pulsing light inside the center circle */
        .logo-spiral::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 6px;
            height: 6px;
            background: #ffffff;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: centerPulse 2s ease-in-out infinite;
        }

        /* subtle inner ring */
        .logo-spiral::after {
            content: '';
            position: absolute;
            inset: 6px;
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.25);
            box-shadow: inset 0 0 8px rgba(255,255,255,0.08);
            pointer-events: none;
        }

        @keyframes centerPulse {
            0%, 100% { 
                opacity: 0.3;
                transform: translate(-50%, -50%) scale(0.8);
            }
            50% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.2);
                box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
            }
        }

        .header-right { justify-self: end; display: flex; gap: 10px; align-items: center; }

        /* Section Styling */
        .section {
            min-height: 100vh;
            padding: 100px 50px 50px;
            position: relative;
        }

        /* Hero Section */
        .hero {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: radial-gradient(ellipse at center, rgba(255,255,255,0.05) 0%, rgba(0,0,0,1) 70%);
        }

        .hero-logo {
            margin-bottom: 60px;
            animation: logoFloat 6s ease-in-out infinite;
        }

        .hero-logo-img {
            width: 120px;
            height: 120px;
            filter: brightness(1.1) contrast(1.1);
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .hero-text {
            max-width: 800px;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 300;
            line-height: 1.2;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #ffffff 0%, #cccccc 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleShimmer 4s ease-in-out infinite;
        }

        @keyframes titleShimmer {
            0%, 100% { opacity: 0.9; }
            50% { opacity: 1; }
        }

        .hero-subtitle {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #cccccc;
            font-weight: 300;
        }

        /* Section Headers */
        .section-header {
            font-size: 2rem;
            font-weight: 300;
            text-align: center;
            margin-bottom: 80px;
            letter-spacing: 4px;
            position: relative;
        }

        .section-header .section-hint {
            display: block;
            margin-top: 10px;
            font-size: 0.9rem;
            letter-spacing: 0.12em;
            color: rgba(255,255,255,0.6);
            text-transform: uppercase;
            pointer-events: none;
        }

        .section-header::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 1px;
            background: linear-gradient(to right, transparent, #ffffff, transparent);
        }

        /* Feature Sections */
        .feature-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
            align-items: center;
            margin-bottom: 100px;
        }

        .feature-visual {
            width: 100%;
            height: 500px;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.02);
        }

        .feature-visual canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .feature-description {
            padding: 40px;
        }

        .feature-tldr {
            font-size: 1.2rem;
            color: #ffffff;
            margin-bottom: 30px;
            font-style: italic;
            padding: 20px;
            border-left: 3px solid #ffffff;
            background: rgba(255, 255, 255, 0.05);
        }

        .feature-content {
            font-size: 1rem;
            line-height: 1.8;
            color: #cccccc;
        }

        /* Spiral Memory Clickable */
        .spiral-clickable {
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }

        .spiral-clickable::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
            z-index: -1;
        }

        .spiral-clickable:hover {
            transform: scale(1.05);
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.8);
            letter-spacing: 6px;
        }

        .spiral-clickable:hover::before {
            left: 100%;
        }

        .spiral-clickable:active {
            transform: scale(0.98);
            transition: transform 0.1s ease;
        }

        /* Starburst Overlay */
            /* Old overlays disabled */
            .starburst-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            z-index: 2000;
            display: grid;
            place-items: center;
            overflow-x: hidden;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.35s cubic-bezier(0.25, 0.8, 0.25, 1), visibility 0.35s, backdrop-filter 0.35s;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding-left: env(safe-area-inset-left, 0);
            padding-right: env(safe-area-inset-right, 0);
            padding-top: env(safe-area-inset-top, 0);
            padding-bottom: env(safe-area-inset-bottom, 0);
                display: none !important;
        }

        .starburst-overlay.active {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        .starburst-menu {
            position: relative;
            width: min(80vw, 520px);
            height: min(80vw, 680px);
            transform: scale(0.9);
            transition: transform 0.45s cubic-bezier(0.22, 1, 0.36, 1);
            will-change: transform;
            transform-style: preserve-3d;
            perspective: 1000px;
            margin: 7vh 0; /* breathing room for scroll */
        }

        .starburst-overlay.active .starburst-menu {
            transform: scale(1);
        }

        .starburst-aura {
            position: absolute;
            inset: 0;
            pointer-events: none;
            border-radius: 50%;
            background: radial-gradient(closest-side, rgba(255,255,255,0.08), rgba(255,255,255,0.02) 65%, rgba(255,255,255,0.0) 75%);
            animation: pulseAura 5s ease-in-out infinite;
            filter: drop-shadow(0 0 24px rgba(255,255,255,0.08));
        }

        @keyframes pulseAura {
            0%, 100% { opacity: 0.6; transform: scale(0.98); }
            50% { opacity: 1; transform: scale(1); }
        }

        .starburst-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            background: radial-gradient(120px 120px at 30% 30%, rgba(255,255,255,0.18), rgba(255,255,255,0.06) 60%, rgba(255,255,255,0.03) 100%);
            border: 2px solid rgba(255, 255, 255, 0.25);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 400;
            letter-spacing: 2px;
            cursor: pointer;
            transition: transform 0.35s cubic-bezier(0.22, 1, 0.36, 1), box-shadow 0.35s;
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.14), inset 0 0 30px rgba(255,255,255,0.08);
            animation: centerPulse 3s ease-in-out infinite;
            will-change: transform, box-shadow;
        }

        .starburst-halo {
            position: absolute;
            inset: 0;
            pointer-events: none;
            border-radius: 50%;
            opacity: 0.25;
            background:
                radial-gradient(closest-side, rgba(255,255,255,0.04), rgba(255,255,255,0) 70%),
                conic-gradient(from 0deg, rgba(255,255,255,0.0) 0deg, rgba(255,255,255,0.12) 10deg, rgba(255,255,255,0.0) 20deg, rgba(255,255,255,0.0) 360deg);
            filter: drop-shadow(0 0 18px rgba(255,255,255,0.12));
            animation: haloSpin 60s linear infinite;
        }

        @keyframes haloSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes centerPulse {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(255, 255, 255, 0.1); 
            }
            50% { 
                box-shadow: 0 0 50px rgba(255, 255, 255, 0.3); 
            }
        }

        .starburst-center:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0 60px rgba(255, 255, 255, 0.4);
        }

        .starburst-item {
            position: absolute;
            top: 50%;
            left: 50%;
            width: auto;
            min-width: 180px;
            max-width: min(88vw, 720px);
            min-height: 42px;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.055);
            border: 1px solid rgba(255, 255, 255, 0.16);
            border-radius: 999px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13.5px;
            font-weight: 500;
            letter-spacing: 0.03em;
            cursor: pointer;
            transform: translate(-50%, -50%) scale(0.85);
            transform-origin: center;
            opacity: 0;
            transition: transform 320ms var(--easing, cubic-bezier(0.22, 1, 0.36, 1)), opacity 300ms ease, box-shadow 220ms ease, border-color 220ms ease, background 220ms ease;
            backdrop-filter: blur(10px) saturate(112%);
            overflow: hidden;
            will-change: transform, opacity;
            box-shadow: 0 10px 24px rgba(0,0,0,0.28);
            -webkit-font-smoothing: antialiased;
        }

        .starburst-item .sb-icon {
            width: 30px;
            height: 30px;
            min-width: 30px;
            border-radius: 50%;
            display: grid;
            place-items: center;
            margin-left: 8px;
            margin-right: 10px;
            color: var(--tintSolid, rgba(255,255,255,0.92));
            background: radial-gradient(16px 16px at 50% 50%, rgba(255,255,255,0.18), rgba(255,255,255,0.05));
            box-shadow: inset 0 0 10px rgba(255,255,255,0.12), 0 6px 14px rgba(0,0,0,0.35), 0 0 0 1px rgba(255,255,255,0.18);
            transition: transform 220ms ease, box-shadow 220ms ease;
        }
        .starburst-item .sb-icon svg { display: block; stroke-width: 1.25; stroke-linecap: round; stroke-linejoin: round; }
        /* Simplify: hide icons/inner/subtitle and use a single label */
        .starburst-item .sb-icon, .starburst-item .sb-subtitle, .starburst-item .sb-inner { display: none !important; }
        .starburst-item .sb-label { font-size: 12.8px; letter-spacing: 0.07em; text-transform: uppercase; color: rgba(255,255,255,0.96); text-align: center; white-space: normal; overflow: visible; text-overflow: clip; padding: 0 8px; line-height: 1.3; -webkit-font-smoothing: antialiased; }

        .starburst-item .sb-copy { display: flex; flex-direction: column; align-items: flex-start; line-height: 1.1; max-width: calc(100% - 60px); }
        .starburst-item .sb-inner {
            display: flex;
            align-items: center;
            animation: sbBob 7s ease-in-out infinite;
            will-change: transform;
        }
        @keyframes sbBob {
            0%, 100% { transform: translateY(-2px) rotateZ(-0.4deg); }
            50% { transform: translateY(2px) rotateZ(0.5deg); }
        }
        .starburst-item .sb-title { font-size: 12.5px; letter-spacing: 0.08em; text-transform: uppercase; color: rgba(255,255,255,0.95); }
        .starburst-item .sb-subtitle { font-size: 11px; color: rgba(255,255,255,0.72); margin-top: 4px; letter-spacing: 0.02em; }

        .starburst-close {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) translate(98px, -98px);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.35);
            background: rgba(255,255,255,0.08);
            color: #fff;
            cursor: pointer;
            line-height: 26px;
            text-align: center;
            font-size: 16px;
            padding: 0;
            backdrop-filter: blur(6px);
            transition: transform 200ms ease, background 200ms ease, border-color 200ms ease;
        }
        .starburst-close:hover {
            background: rgba(255,255,255,0.18);
            border-color: rgba(255,255,255,0.55);
            transform: translate(-50%, -50%) translate(98px, -98px) scale(1.06);
        }
        .starburst-close:active { transform: translate(-50%, -50%) translate(98px, -98px) scale(0.94); }

        /* Spokes container */
        .starburst-spokes { position: absolute; inset: 0; pointer-events: none; }
        .starburst-spokes .spoke {
            position: absolute;
            top: 50%;
            left: 50%;
            height: 1px;
            width: var(--dist, 0px);
            transform-origin: left center;
            transform: rotate(var(--angle, 0rad));
            background: linear-gradient(90deg, rgba(255,255,255,0.0), var(--spoke, rgba(255,255,255,0.25)), rgba(255,255,255,0.0));
            opacity: 0;
            transition: opacity 320ms ease 80ms;
            filter: drop-shadow(0 0 6px rgba(255,255,255,0.25));
        }

        .starburst-spokes .spoke-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            transform: translate(-50%, -50%) var(--pos, translate(0,0));
            background: radial-gradient(6px 6px at 50% 50%, var(--tint, rgba(255,255,255,0.85)), rgba(255,255,255,0.0));
            box-shadow: 0 0 10px var(--tint, rgba(255,255,255,0.35));
            opacity: 0;
            transition: opacity 320ms ease 120ms;
        }

        /* Clean pill — no accent line */
        .starburst-item::before { display: none; }

        /* Positioning now handled via JS for perfect radial layout */

        .starburst-item:hover { background: rgba(255,255,255,0.10); border-color: color-mix(in srgb, var(--tint, rgba(255,255,255,0.3)) 24%, rgba(255,255,255,0.22)); box-shadow: 0 12px 28px rgba(0,0,0,0.30); transform: translate(-50%, -50%) var(--pos, translate(0,0)) scale(1.02) translateZ(0); }

        .starburst-item:active {
            transform: scale(0.95) !important;
            transition: transform 0.1s ease;
        }

        /* Line-mode list for mobile: long curving line */
        /* Line-mode available on all viewports */
        .starburst-menu.line-mode { position: static !important; left: auto !important; top: auto !important; right: auto !important; bottom: auto !important; width: min(560px, calc(100vw - 32px)); height: auto; margin: 0 auto; box-sizing: border-box; z-index: 1; }
        .starburst-menu.line-mode { display: flex; flex-direction: column; align-items: center; gap: 12px; padding: 14px 0 24px; overflow-y: auto; overflow-x: hidden; max-height: min(80vh, calc(100vh - 24px)); scroll-behavior: smooth; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; box-sizing: border-box; transform: none; transform-origin: center; justify-self: center; align-self: center; }
        .starburst-menu.line-mode .starburst-aura, 
        .starburst-menu.line-mode .starburst-halo,
        .starburst-menu.line-mode .starburst-spokes { display: none; }
        .starburst-menu.line-mode .starburst-center { display: none !important; }
        .starburst-menu.line-mode .starburst-item { position: relative; transform: none !important; opacity: 1 !important; margin: 0; width: 100%; display: block; text-align: center; padding: 12px 16px; border-radius: 999px; will-change: transform, filter, opacity; box-sizing: border-box; }
        .starburst-menu.line-mode .starburst-item { position: relative; padding-right: 34px; }
        .starburst-menu.line-mode .starburst-item::after { content: '›'; position: absolute; right: 14px; top: 50%; transform: translateY(-50%); color: rgba(255,255,255,0.44); transition: color 200ms ease, transform 200ms ease; font-size: 18px; line-height: 1; }
        .starburst-menu.line-mode .starburst-item:hover::after, .starburst-menu.line-mode .starburst-item:focus-visible::after { color: rgba(255,255,255,0.86); transform: translateY(-50%) translateX(2px); }
        .starburst-menu.line-mode .starburst-close { position: sticky; top: 10px; left: auto; right: 10px; transform: none; margin-left: auto; }
        .starburst-menu.line-mode .starburst-item .sb-label { font-size: 13px; letter-spacing: 0.06em; line-height: 1.35; white-space: normal; overflow-wrap: anywhere; word-wrap: break-word; hyphens: auto; text-wrap: balance; }
        .starburst-overlay.active .starburst-menu.line-mode { transform: none !important; }
        .starburst-item:focus-visible { outline: 2px solid rgba(255,255,255,0.35); outline-offset: 2px; }
        /* crescent highlight for centered item */
        .starburst-item.is-center { box-shadow: 0 0 24px rgba(0,180,255,0.35), 0 0 10px rgba(255,255,255,0.25) inset; border-color: rgba(255,255,255,0.4); }

        /* Contact Section */
        .contact {
            background: linear-gradient(135deg, rgba(255,255,255,0.02) 0%, rgba(0,0,0,1) 100%);
            text-align: center;
        }

        .contact-form { max-width: 640px; margin: 0 auto; display: grid; gap: 14px; }

        .contact-input, .contact-textarea { width: 100%; padding: 14px 16px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.18); border-radius: 10px; color: #fff; font-family: 'Times New Roman', serif; transition: border-color 160ms ease, box-shadow 160ms ease, background 160ms ease; }
        .contact-input:hover, .contact-textarea:hover { border-color: rgba(255,255,255,0.28); }
        .contact-input:focus, .contact-textarea:focus { outline: none; border-color: rgba(255,255,255,0.38); box-shadow: 0 8px 20px rgba(0,0,0,0.35); background: rgba(255,255,255,0.08); }

        .contact-input::placeholder, .contact-textarea::placeholder { color: rgba(255,255,255,0.5); }
        .contact-input.invalid, .contact-textarea.invalid { border-color: rgba(255,82,82,0.5) !important; box-shadow: 0 0 0 2px rgba(255,82,82,0.15); }
        .sr-only { position: absolute !important; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 1px, 1px); white-space: nowrap; border: 0; }
        .char-counter { font-size: 12px; opacity: 0.7; text-align: right; margin-top: -8px; margin-bottom: 6px; }

        .contact-textarea { height: 140px; resize: vertical; }

        .contact-checkboxes { display: flex; gap: 22px; justify-content: center; margin: 8px 0 6px; }
        .checkbox-wrapper input { accent-color: #fff; width: 18px; height: 18px; }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .contact-submit { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.26); color: #fff; padding: 12px 18px; font-family: 'Times New Roman', serif; font-size: 0.95rem; cursor: pointer; transition: transform 160ms ease, background 180ms ease, border-color 180ms ease, box-shadow 180ms ease; letter-spacing: 0.06em; border-radius: 999px; }

        .contact-submit:hover { transform: translateY(-1px); border-color: rgba(255,255,255,0.38); box-shadow: 0 10px 18px rgba(0,0,0,0.35); }

        .contact-submit:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .contact-submit.loading { position: relative; pointer-events: none; }
        .contact-submit.loading::after { content: ""; position: absolute; right: -28px; top: 50%; transform: translateY(-50%); width: 14px; height: 14px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.28); border-top-color: #fff; animation: spin 0.9s linear infinite; }

        .contact-feedback { margin-top: 8px; padding: 10px 12px; border-radius: 10px; text-align: center; font-size: 0.95rem; display: none; border: 1px solid transparent; transition: opacity 180ms ease, transform 180ms ease; max-width: 640px; margin-left: auto; margin-right: auto; opacity: 0; transform: translateY(4px); }

        .contact-feedback.success { background: rgba(0,255,136,0.08); border: 1px solid rgba(0,255,136,0.28); color: #00ff88; }

        .contact-feedback.error { background: rgba(255,82,82,0.08); border: 1px solid rgba(255,82,82,0.28); color: #ff6666; }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
        }

        /* Inline Menu Canvas sizing */
        .menu-canvas-wrap { width: 100%; display: grid; place-items: center; margin: 14px 0 24px 0; overscroll-behavior: contain; }
        .menu-canvas-wrap canvas { width: min(680px, 92vw); height: 420px; display: block; border-radius: 16px; touch-action: none; user-select: none; cursor: grab; }

        /* Depth + Motion: reveals, tilt, parallax helpers */
        .reveal { opacity: 0; transform: translateY(16px) scale(0.985); filter: blur(6px); transition: transform 640ms cubic-bezier(0.22,1,0.36,1), opacity 500ms ease, filter 640ms ease; will-change: transform, opacity, filter; }
        .reveal.in-view { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
        @media (prefers-reduced-motion: reduce) { .reveal, .reveal.in-view { transition: none !important; transform: none !important; filter: none !important; opacity: 1 !important; } }

        .tilt { transition: transform 220ms ease, box-shadow 220ms ease; transform-style: preserve-3d; will-change: transform; }
        .tilt::after { content: ""; position: absolute; inset: 0; pointer-events: none; background: radial-gradient(600px 300px at var(--shine-x,50%) var(--shine-y,0%), rgba(255,255,255,0.18), rgba(255,255,255,0.0) 40%); opacity: 0; transition: opacity 220ms ease; }
        .tilt:hover::after { opacity: 1; }

        /* Header micro depth on scroll */
        .header { transition: height 220ms ease, background 220ms ease, border-color 220ms ease, box-shadow 220ms ease; }
        .header.scrolled { height: 64px; background: rgba(0,0,0,0.98); border-bottom-color: rgba(255,255,255,0.14); box-shadow: 0 8px 24px rgba(0,0,0,0.35); }

        /* Motion toggle removed */

        @media (prefers-reduced-motion: reduce) {
            * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
            .starburst-halo { animation: none !important; }
            .sb-inner { animation: none !important; }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 0 16px;
                grid-template-columns: 1fr auto 1fr;
            }
            /* Ensure overlay content stays centered on small screens */
            .starburst-menu.line-mode { width: calc(100vw - 32px); margin: 0 auto; max-width: 560px; }
        }
            .header-left { font-size: 16px; letter-spacing: 2px; }
            .logo-spiral { width: 34px; height: 34px; }
            .header.scrolled { height: 60px; }

            .hero-title {
                font-size: 2.5rem;
            }

            .feature-section {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .feature-visual {
                height: 300px;
            }

            .section {
                padding: 100px 20px 50px;
            }

            .contact-checkboxes {
                flex-direction: column;
                gap: 15px;
            }

            /* Starburst mobile tuning */
        .starburst-menu { width: min(96vw, 420px); height: min(96vw, 580px); transform: none; }
            .starburst-center { width: 96px; height: 96px; letter-spacing: 1px; font-size: 12px; }
            .starburst-item { width: auto; min-width: 140px; max-width: 70vw; min-height: 38px; padding: 8px 10px; background: rgba(255,255,255,0.035); border-color: rgba(255,255,255,0.1); box-shadow: 0 6px 14px rgba(0,0,0,0.22); }
            .starburst-item .sb-label { font-size: 11.5px; letter-spacing: 0.06em; line-height: 1.25; text-transform: none; }
        }

        @media (max-width: 480px) {
        .starburst-menu { width: min(98vw, 360px); height: min(98vw, 520px); transform: none; }
            .starburst-center { width: 76px; height: 76px; }
            .starburst-item { min-width: 116px; max-width: 78vw; padding: 6px 10px; }
            .starburst-item .sb-label { font-size: 10.8px; line-height: 1.25; }
        }

        /* Ultra-compact phones: text-only menu items for maximum clarity */
        @media (max-width: 360px) {
        .starburst-menu { width: min(99vw, 320px); height: min(99vw, 480px); transform: none; }
            .starburst-center { width: 70px; height: 70px; }
            .starburst-item {
                min-width: 100px;
                max-width: 82vw;
                padding: 0;
                background: transparent;
                border: none;
                box-shadow: none;
            }
            .starburst-item .sb-label {
                font-size: 11px;
                letter-spacing: 0.06em;
                padding: 0 2px;
                text-shadow: 0 0 10px rgba(255,255,255,0.22);
            }
            .starburst-item:hover {
                background: transparent;
                border-color: transparent;
                box-shadow: none;
                transform: translate(-50%, -50%) var(--pos, translate(0,0)) scale(1.0) translateZ(0);
            }
            .starburst-item:hover .sb-label { text-shadow: 0 0 12px rgba(255,255,255,0.35); }
        }
    </style>
      <style>
        :root{--fw-bg:#0B0B0C;--fw-paper:#F6F5F2;--fw-ink:#111;--fw-ink-invert:#F6F5F2;--fw-gold:#D4BE8D;--fw-muted:#9C9C9C;--fw-radius:16px;--fw-gap:24px;--fw-container:1200px;--fw-anim:180ms cubic-bezier(.2,.8,.2,1)}
        .video-hero{position:relative;min-height:min(60vh,720px);display:grid;place-items:end center;overflow:hidden;isolation:isolate}
        .video-hero video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:saturate(.9) contrast(1.05) brightness(.9);z-index:-1}
        .video-hero .plate{margin:64px auto;background:rgba(11,11,12,.35);backdrop-filter:blur(6px);border:1px solid rgba(212,190,141,.35);border-radius:var(--fw-radius);padding:28px 32px;color:var(--fw-ink-invert)}
        .video-hero h1{font-family:"Playfair Display", ui-serif, Georgia, serif;font-size:clamp(28px,4vw,48px);font-weight:600;margin:0 0 12px}
        .video-hero .subhead{color:var(--fw-paper);opacity:.9;margin-bottom:16px}
        .inline-ctas{display:flex;gap:12px;flex-wrap:wrap}
        .inline-ctas button{appearance:none;border:1px solid rgba(212,190,141,.4);background:rgba(11,11,12,.35);color:var(--fw-ink-invert);padding:10px 16px;border-radius:999px;font-weight:500;letter-spacing:.02em;transition:transform var(--fw-anim),border-color var(--fw-anim),box-shadow var(--fw-anim)}
        .inline-ctas button:hover{transform:translateY(-1px);border-color:var(--fw-gold);box-shadow:0 8px 24px rgba(0,0,0,.25), inset 0 0 0 1px rgba(212,190,141,.25)}
        .context-strip{background:linear-gradient(180deg, rgba(246,245,242,.06), rgba(246,245,242,.02));border-top:1px solid rgba(212,190,141,.08);border-bottom:1px solid rgba(212,190,141,.08);padding:24px 0}
        .context-strip>div{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap}
        .context-strip .persona{margin-top:12px;border:1px solid rgba(212,190,141,.25);border-radius:999px;padding:8px 14px;color:var(--fw-paper);width:max-content;margin-left:auto;margin-right:auto}
        .chip{display:inline-flex;align-items:center;justify-content:center;padding:8px 12px;border-radius:999px;background:#0F0F10;border:1px solid rgba(212,190,141,.25);color:var(--fw-paper);transition: box-shadow var(--fw-anim), border-color var(--fw-anim), transform var(--fw-anim)}
        .chip:hover{box-shadow:0 6px 18px rgba(0,0,0,.25);border-color:var(--fw-gold);transform:translateY(-1px)}
        .proof-tiles{padding:48px 0}
        .proof-tiles .container{max-width:var(--fw-container);margin:0 auto;padding:0 20px;display:grid;gap:var(--fw-gap);grid-template-columns:repeat(3,1fr)}
        .tile{background:#0E0E0F;border:1px solid rgba(212,190,141,.12);border-radius:var(--fw-radius);padding:24px;transition:transform var(--fw-anim), box-shadow var(--fw-anim), border-color var(--fw-anim)}
        .tile:hover{transform:translateY(-2px);box-shadow:0 10px 28px rgba(0,0,0,.35);border-color:rgba(212,190,141,.25)}
        .tile.wide{grid-column:span 3}
        @media (max-width:980px){.proof-tiles .container{grid-template-columns:1fr}.tile.wide{grid-column:span 1}}
        .modules-showcase{padding:24px 0 8px}
        .modules-showcase .container{max-width:var(--fw-container);margin:0 auto;padding:0 20px;display:grid;gap:var(--fw-gap);grid-template-columns:repeat(3,1fr)}
        .module-card{background:#0E0E0F;border:1px solid rgba(212,190,141,.12);border-radius:var(--fw-radius);padding:22px 22px 18px;min-height:160px;display:flex;flex-direction:column;justify-content:space-between;transition:transform var(--fw-anim), box-shadow var(--fw-anim), border-color var(--fw-anim)}
        .module-card:hover{transform:translateY(-3px);box-shadow:0 12px 32px rgba(0,0,0,.35);border-color:rgba(212,190,141,.25)}
        @media (max-width:1100px){.modules-showcase .container{grid-template-columns:repeat(2,1fr)}}@media (max-width:720px){.modules-showcase .container{grid-template-columns:1fr}}
        .pilot-path{padding:48px 0}
        .pilot-path .container{max-width:var(--fw-container);margin:0 auto;padding:0 20px;display:grid;gap:var(--fw-gap);grid-template-columns:2fr 1fr}
        .steps{display:grid;gap:16px}
        .step{display:flex;align-items:center;gap:12px;padding:16px;border-radius:var(--fw-radius);background:#0E0E0F;border:1px solid rgba(212,190,141,.12)}
        .num{width:36px;height:36px;display:grid;place-items:center;border-radius:999px;color:#111;background:linear-gradient(180deg,var(--fw-gold), color-mix(in srgb, var(--fw-gold) 75%, #8E7C57));font-weight:700}
        .actions{display:flex;flex-direction:column;gap:12px}
        .actions button{appearance:none;width:100%;border-radius:999px;padding:12px 16px;font-weight:600;letter-spacing:.02em;border:1px solid rgba(212,190,141,.35);background:#101012;color:var(--fw-ink-invert);transition:transform var(--fw-anim), border-color var(--fw-anim), box-shadow var(--fw-anim)}
        .actions button:hover{transform:translateY(-1px);border-color:var(--fw-gold);box-shadow:0 10px 26px rgba(0,0,0,.3)}
        .credibility-row{padding:28px 0 64px;display:flex;gap:28px;flex-wrap:wrap;justify-content:center;align-items:center;opacity:.9}
        .credibility-row .logo{padding:10px 14px;border:1px solid rgba(212,190,141,.12);border-radius:999px;color:var(--fw-paper);transition:filter var(--fw-anim), border-color var(--fw-anim)}
        .credibility-row .logo:hover{filter:brightness(1.15);border-color:rgba(212,190,141,.25)}
      </style>
</head>
<body>
    <div id="preloader" aria-hidden="false" role="status" aria-live="polite">
      <div class="preloader-inner">
        <div class="spinner" aria-label="Loading"></div>
        <div class="preloader-text">Loading 0%</div>
        <div class="preloader-progress" aria-hidden="true"><div class="preloader-bar" style="width:0%"></div></div>
      </div>
    </div>
    <!-- 3D Heart Background -->
    <canvas id="heartBackgroundCanvas"></canvas>

    <!-- Header -->
    <header class="header">
        <div class="header-left">FEATHERWEIGHT</div>
        <div class="header-center">
            <div class="logo-spiral" role="button" aria-label="Back to top" title="Back to top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})"></div>
        </div>
        <div class="header-right"></div>
    </header>

    <!-- Hero Section -->
    <section class="section hero" id="hero">
        <div class="hero-logo reveal" data-parallax="6 -4">
            <img src="/server/public/9.png" alt="Featherweight Logo" class="hero-logo-img" onerror="this.onerror=null; this.src='/9.png'; setTimeout(()=>{ if(this.naturalWidth===0){ this.src='9.png'; } }, 0);">
        </div>
        <div class="hero-text reveal" data-parallax="4 -3">
            <h1 class="hero-title">A Living Intelligence Engine.<br>Built to Learn, Feel, and Evolve.</h1>
            <p class="hero-subtitle">
                Featherweight combines spiral memory, holographic simulation, and adaptive identity to create systems that improve themselves in production.
                It’s research infrastructure for teams building autonomous software that thinks clearly, remembers context, and earns trust over time.
            </p>
        </div>
    </section>

    <!-- Spiral Memory Section -->
    <section class="section" id="spiral-memory">
        <h2 class="section-header reveal" id="spiralHeader"><span>SPIRAL MEMORY</span></h2>
        <div class="feature-section">
            <div class="feature-visual tilt reveal">
                <canvas id="spiralMemoryCanvas"></canvas>
            </div>
            <div class="feature-description reveal" data-parallax="-3 2">
                <div class="feature-tldr">
                    Memory that compounds. A structure that links, recalls, and improves with every interaction.
                </div>
                <div class="feature-content">
                    Spiral Memory is a living data model. It keeps context across time, strengthens the useful links, and fades the noise. Models learn faster, products feel smarter, and teams ship with confidence.

                    <br><br><strong>Where it lands:</strong>

                    <br><br><strong>Gaming</strong> — adaptive story engines and persistent player memory.
                    <br><strong>Enterprise</strong> — self‑healing systems that remember fixes and apply them proactively.
                    <br><strong>Finance</strong> — context‑aware signals that surface non‑obvious correlations before they matter.
                </div>
            </div>
        </div>
    </section>

    <!-- Holographic Reality Section -->
    <section class="section" id="holographic-reality">
        <h2 class="section-header holographic-clickable reveal" onclick="toggleStarburstHRG()">HOLOGRAPHIC REALITY GENERATOR</h2>
        <div class="feature-section">
            <div class="feature-description reveal" data-parallax="3 2">
                <div class="feature-tldr">
                    Simulate decisions before you commit. Explore many futures and keep the one that wins.
                </div>
                <div class="feature-content">
                    The Holographic Reality Generator runs fast, nested simulations with configurable physics and agents. It lets you test strategies safely, learn from outcomes, and ship with proof instead of hope.
                </div>
            </div>
            <div class="feature-visual tilt reveal">
                <canvas id="holographicCanvas"></canvas>
            </div>
        </div>
    </section>

    <!-- DNA Sigil Section -->
    <section class="section" id="dna-sigil">
        <h2 class="section-header sigil-clickable reveal" onclick="toggleStarburstSigil()">DNA SIGIL IDENTITY</h2>
        <div class="feature-section">
            <div class="feature-visual tilt reveal">
                <canvas id="dnaSigilCanvas"></canvas>
            </div>
            <div class="feature-description reveal" data-parallax="-3 -2">
                <div class="feature-tldr">
                    Identity that adapts. Trust that compounds.
                </div>
                <div class="feature-content">
                    DNA Sigils are evolving credentials. They adjust risk in real time, harden with usage, and make security an asset—not a tax on users.

                    <br><br><strong>Where it lands:</strong>
                    <br><strong>Finance</strong> — adaptive fraud defense and smoother KYC.
                    <br><strong>Gaming</strong> — persistent identity that enriches worlds and economies.
                    <br><strong>Healthcare</strong> — privacy by default with progressive trust.
                    <br><strong>Web3</strong> — self‑sovereign identity that actually evolves.
                </div>
            </div>
        </div>
        
        <!-- Self Coding Category under DNA Sigil -->
        <div class="section" id="self-coding">
            <h3 class="section-header selfcode-clickable reveal" onclick="toggleStarburstSelfCode()">SELF CODING</h3>
            <div class="feature-section">
                <div class="feature-visual tilt reveal">
                    <canvas id="selfCodingCanvas"></canvas>
                </div>
                <div class="feature-description reveal" data-parallax="3 -2">
                    <div class="feature-tldr">Code that writes itself—safely. Generate, validate, and integrate modules with provenance and policy.</div>
                    <div class="feature-content">
                        The Self Coding engine analyzes goals, plans code structure, generates implementations, then validates and integrates them with evidence. It runs in sandboxes, respects policies, and leaves audit‑ready trails.
            </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Standalone Section: Inline Canvas Menu (separate from Self Coding wrapper) -->
    <section class="section" id="industries-menu">
        <h3 class="section-header reveal">Explore Industries</h3>
        <div class="menu-canvas-wrap reveal">
            <canvas id="menuCanvas"></canvas>
        </div>
    </section>

    <!-- Starburst Overlay -->
    <div id="starburstOverlay" class="starburst-overlay" role="dialog" aria-modal="true" aria-label="Spiral Memory use case menu">
        <div class="starburst-menu" role="listbox" aria-label="Industries">
            <div class="starburst-aura" aria-hidden="true"></div>
            <div class="starburst-halo" aria-hidden="true"></div>
            <div class="starburst-center">SPIRAL MEMORY</div>
            <button class="starburst-close" aria-label="Close" onclick="closeStarburst()">×</button>
            <div class="starburst-spokes" aria-hidden="true"></div>

            <div class="starburst-item" role="option" tabindex="0" data-angle="0" onclick="openBriefing('manufacturing')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('manufacturing');}">
                <div class="sb-label">Manufacturing & Logistics</div>
            </div>

            <div class="starburst-item" role="option" tabindex="0" data-angle="90" onclick="openBriefing('finance')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('finance');}">
                <div class="sb-label">Finance & Banking</div>
            </div>

            <div class="starburst-item" role="option" tabindex="0" data-angle="180" onclick="openBriefing('blockchain')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('blockchain');}">
                <div class="sb-label">Blockchain & Web3</div>
            </div>

            <div class="starburst-item" role="option" tabindex="0" data-angle="270" onclick="openBriefing('robotics')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('robotics');}">
                <div class="sb-label">Robotics & IoT</div>
            </div>

            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('gaming')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('gaming');}">
                <div class="sb-label">Gaming & VR</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('space')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('space');}">
                <div class="sb-label">Space</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('government')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('government');}">
                <div class="sb-label">Government & Defense</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('security')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('security');}">
                <div class="sb-label">Security</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('biotech')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('biotech');}">
                <div class="sb-label">Biotech & Computational Biology</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('healthcare')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('healthcare');}">
                <div class="sb-label">Healthcare</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('legal')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('legal');}">
                <div class="sb-label">LegalTech & Judiciary Infrastructure</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('ar')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('ar');}">
                <div class="sb-label">Augmented Reality</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('satellites')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('satellites');}">
                <div class="sb-label">Satellites</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('devtools')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('devtools');}">
                <div class="sb-label">Developer Tools</div>
            </div>

            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('education')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('education');}">
                <div class="sb-label">Education</div>
            </div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('city')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('city');}">
                <div class="sb-label">City Planning</div>
            </div>
        </div>
    </div>

    <!-- Starburst Overlay: Holographic Reality Generator -->
    <div id="starburstOverlayHRG" class="starburst-overlay" role="dialog" aria-modal="true" aria-label="Holographic Reality use case menu">
        <div class="starburst-menu" role="listbox" aria-label="Industries">
            <div class="starburst-aura" aria-hidden="true"></div>
            <div class="starburst-halo" aria-hidden="true"></div>
            <div class="starburst-center">HOLOGRAPHIC REALITY</div>
            <button class="starburst-close" aria-label="Close" onclick="closeStarburstHRG()">×</button>
            <div class="starburst-spokes" aria-hidden="true"></div>

            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('manufacturing')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('manufacturing');}"><div class="sb-label">Manufacturing & Logistics</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('finance')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('finance');}"><div class="sb-label">Finance & Banking</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('blockchain')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('blockchain');}"><div class="sb-label">Blockchain & Web3</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('robotics')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('robotics');}"><div class="sb-label">Robotics & IoT</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('gaming')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('gaming');}"><div class="sb-label">Gaming & VR</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('space')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('space');}"><div class="sb-label">Space</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('government')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('government');}"><div class="sb-label">Government & Defense</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('security')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('security');}"><div class="sb-label">Security</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('biotech')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('biotech');}"><div class="sb-label">Biotech & Comp. Biology</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('healthcare')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('healthcare');}"><div class="sb-label">Healthcare</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('legal')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('legal');}"><div class="sb-label">LegalTech & Judiciary</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('ar')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('ar');}"><div class="sb-label">Augmented Reality</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('satellites')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('satellites');}"><div class="sb-label">Satellites</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('devtools')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('devtools');}"><div class="sb-label">Developer Tools</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('education')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('education');}"><div class="sb-label">Education</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('city')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('city');}"><div class="sb-label">City Planning</div></div>
        </div>
    </div>

    <!-- Starburst Overlay: DNA Sigil Identity -->
    <div id="starburstOverlaySigil" class="starburst-overlay" role="dialog" aria-modal="true" aria-label="DNA Sigil use case menu">
        <div class="starburst-menu" role="listbox" aria-label="Industries">
            <div class="starburst-aura" aria-hidden="true"></div>
            <div class="starburst-halo" aria-hidden="true"></div>
            <div class="starburst-center">DNA SIGIL IDENTITY</div>
            <button class="starburst-close" aria-label="Close" onclick="closeStarburstSigil()">×</button>
            <div class="starburst-spokes" aria-hidden="true"></div>

            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('manufacturing')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('manufacturing');}"><div class="sb-label">Manufacturing & Logistics</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('finance')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('finance');}"><div class="sb-label">Finance & Banking</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('blockchain')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('blockchain');}"><div class="sb-label">Blockchain & Web3</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('robotics')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('robotics');}"><div class="sb-label">Robotics & IoT</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('gaming')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('gaming');}"><div class="sb-label">Gaming & VR</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('space')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('space');}"><div class="sb-label">Space</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('government')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('government');}"><div class="sb-label">Government & Defense</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('security')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('security');}"><div class="sb-label">Security</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('biotech')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('biotech');}"><div class="sb-label">Biotech & Comp. Biology</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('healthcare')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('healthcare');}"><div class="sb-label">Healthcare</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('legal')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('legal');}"><div class="sb-label">LegalTech & Judiciary</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('ar')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('ar');}"><div class="sb-label">Augmented Reality</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('satellites')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('satellites');}"><div class="sb-label">Satellites</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('devtools')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('devtools');}"><div class="sb-label">Developer Tools</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('education')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('education');}"><div class="sb-label">Education</div></div>
            <div class="starburst-item" role="option" tabindex="0" onclick="openBriefing('city')" onkeydown="if(event.key==='Enter'||event.key===' '){openBriefing('city');}"><div class="sb-label">City Planning</div></div>
        </div>
    </div>

    <!-- Starburst Overlay: Self Coding -->
    <div id="starburstOverlaySelfCode" class="starburst-overlay" role="dialog" aria-modal="true" aria-label="Self Coding use case menu">
        <div class="starburst-menu" role="listbox" aria-label="Industries">
            <div class="starburst-aura" aria-hidden="true"></div>
            <div class="starburst-halo" aria-hidden="true"></div>
            <div class="starburst-center">SELF CODING</div>
            <button class="starburst-close" aria-label="Close" onclick="closeStarburstSelfCode()">×</button>
            <div class="starburst-spokes" aria-hidden="true"></div>

            <div class="starburst-item" onclick="openBriefing('manufacturing')"><div class="sb-label">Manufacturing & Logistics</div></div>
            <div class="starburst-item" onclick="openBriefing('finance')"><div class="sb-label">Finance & Banking</div></div>
            <div class="starburst-item" onclick="openBriefing('blockchain')"><div class="sb-label">Blockchain & Web3</div></div>
            <div class="starburst-item" onclick="openBriefing('robotics')"><div class="sb-label">Robotics & IoT</div></div>
            <div class="starburst-item" onclick="openBriefing('gaming')"><div class="sb-label">Gaming & VR</div></div>
            <div class="starburst-item" onclick="openBriefing('space')"><div class="sb-label">Space</div></div>
            <div class="starburst-item" onclick="openBriefing('government')"><div class="sb-label">Government & Defense</div></div>
            <div class="starburst-item" onclick="openBriefing('security')"><div class="sb-label">Security</div></div>
            <div class="starburst-item" onclick="openBriefing('biotech')"><div class="sb-label">Biotech & Comp. Biology</div></div>
            <div class="starburst-item" onclick="openBriefing('healthcare')"><div class="sb-label">Healthcare</div></div>
            <div class="starburst-item" onclick="openBriefing('legal')"><div class="sb-label">LegalTech & Judiciary</div></div>
            <div class="starburst-item" onclick="openBriefing('ar')"><div class="sb-label">Augmented Reality</div></div>
            <div class="starburst-item" onclick="openBriefing('satellites')"><div class="sb-label">Satellites</div></div>
            <div class="starburst-item" onclick="openBriefing('devtools')"><div class="sb-label">Developer Tools</div></div>
            <div class="starburst-item" onclick="openBriefing('education')"><div class="sb-label">Education</div></div>
            <div class="starburst-item" onclick="openBriefing('city')"><div class="sb-label">City Planning</div></div>
        </div>
    </div>
    <!-- Contact Section -->
    <section class="section contact" id="contact">
        <h2 class="section-header reveal">CONTACT</h2>
        <form class="contact-form reveal" id="contactForm" data-parallax="0 -2" novalidate>
            <input type="text" name="name" placeholder="Name" class="contact-input" required>
            <input type="email" name="email" placeholder="Email" class="contact-input" required>
            <textarea name="message" placeholder="Message" class="contact-textarea" required maxlength="2000" aria-describedby="messageCounter"></textarea>
            <div id="messageCounter" class="char-counter" aria-live="polite">0/2000</div>
            <input type="text" name="company" class="sr-only" tabindex="-1" autocomplete="off" aria-hidden="true">
            
            <div class="contact-checkboxes">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="investor" name="investor">
                    <label for="investor">I'm an investor</label>
                </div>
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="researcher" name="researcher">
                    <label for="researcher">I'm a research collaborator</label>
                </div>
            </div>
            
            <button type="submit" class="contact-submit" id="submitBtn">SEND MESSAGE</button>
            <div class="contact-feedback" id="contactFeedback"></div>
        </form>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p style="font-size: 0.9rem; opacity: 0.8;">PATENT PENDING</p>
    </footer>

    <!-- CACHE BUSTING SCRIPT -->
    <script>
        // Force cache clearing every time the site loads
        (function() {
            // Motion enabled state: prefers-reduced-motion overrides default
            const prefReduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            const stored = localStorage.getItem('fw_motion');
            window.__fwMotionEnabled = stored ? stored !== 'off' : !prefReduce;
            document.body.classList.toggle('reduce-motion', !window.__fwMotionEnabled);

            // Motion toggle removed; honor prefers-reduced-motion and stored setting only
            const timestamp = new Date().getTime();
            
            // Add timestamp to script sources
            const scripts = document.querySelectorAll('script[src]');
            scripts.forEach(script => {
                if (script.src && !script.src.includes('cdnjs.cloudflare.com')) {
                    const separator = script.src.includes('?') ? '&' : '?';
                    script.src = script.src + separator + 'v=' + timestamp;
                }
            });
            
            // Force reload if browser cache detected
            if (performance.navigation.type === 2) {
                location.reload(true);
            }
            
            // Clear any existing caches
            if ('caches' in window) {
                caches.keys().then(function(names) {
                    names.forEach(function(name) {
                        caches.delete(name);
                    });
                });
            }
        })();
    </script>
    
    <!-- Depth + Motion Engine (reveal, parallax, tilt, header scroll) -->
    <script>
        (function() {
            // Header shrink on scroll
            const header = document.querySelector('.header');
            const onScroll = () => {
                if (window.scrollY > 10) header.classList.add('scrolled');
                else header.classList.remove('scrolled');
            };
            window.addEventListener('scroll', onScroll, { passive: true });
            onScroll();

            // Intersection reveal with graceful fade-in/out
            const revealEls = Array.from(document.querySelectorAll('.reveal'));
            const io = new IntersectionObserver((entries) => {
                for (const e of entries) {
                    if (e.isIntersecting) {
                        e.target.classList.add('in-view');
                    } else {
                        // Fade out only if element is far off-screen for smoothness
                        const above = e.boundingClientRect.bottom < 0;
                        const below = e.boundingClientRect.top > (window.innerHeight || 0);
                        if (above || below) e.target.classList.remove('in-view');
                    }
                }
            }, { threshold: [0, 0.08, 0.18, 0.35] });
            revealEls.forEach(el => io.observe(el));

            // Mouse parallax for selected elements (avoid elements with tilt)
            const parallaxEls = Array.from(document.querySelectorAll('[data-parallax]:not(.tilt)'))
                .map(el => {
                    const parts = (el.getAttribute('data-parallax') || '0 0').split(/\s+/).map(Number);
                    return { el, x: parts[0] || 0, y: parts[1] || 0, tx: 0, ty: 0 };
                });

            let rafParallax = null;
            function parallaxTick() {
                rafParallax = null;
                const m = window.__fwMouse || { x: 0, y: 0 };
                parallaxEls.forEach(p => {
                    if (!window.__fwMotionEnabled) { p.el.style.transform = ''; return; }
                    const targetX = (m.x || 0) * p.x;
                    const targetY = (m.y || 0) * p.y;
                    p.tx += (targetX - p.tx) * 0.1;
                    p.ty += (targetY - p.ty) * 0.1;
                    p.el.style.transform = `translate3d(${p.tx}px, ${p.ty}px, 0)`;
                });
            }
            window.addEventListener('mousemove', () => {
                if (!rafParallax) rafParallax = requestAnimationFrame(parallaxTick);
            }, { passive: true });

            // Tilt effect for .tilt cards (feature visuals)
            const tiltMax = 6; // degrees
            const tiltEls = Array.from(document.querySelectorAll('.tilt'));
            tiltEls.forEach(card => {
                let raf = null, tX = 0, tY = 0, cX = 0, cY = 0;
                function apply() {
                    raf = null;
                    if (!window.__fwMotionEnabled) { card.style.transform = ''; return; }
                    cX += (tX - cX) * 0.12;
                    cY += (tY - cY) * 0.12;
                    card.style.transform = `rotateX(${cY}deg) rotateY(${cX}deg)`;
                }
                card.addEventListener('mousemove', (e) => {
                    if (!window.__fwMotionEnabled) { return; }
                    const r = card.getBoundingClientRect();
                    const px = (e.clientX - r.left) / r.width - 0.5;
                    const py = (e.clientY - r.top) / r.height - 0.5;
                    tX = px * tiltMax;
                    tY = -py * tiltMax;
                    card.style.setProperty('--shine-x', (px * 100 + 50) + '%');
                    card.style.setProperty('--shine-y', (py * 100 + 50) + '%');
                    if (!raf) raf = requestAnimationFrame(apply);
                });
                card.addEventListener('mouseleave', () => {
                    tX = 0; tY = 0;
                    if (!raf) raf = requestAnimationFrame(apply);
                });
            });
        })();
    </script>

    <!-- Starburst Menu Handler -->
    <script>
        let starburstOpen = false;
        let starburstOpenHRG = false;
        let starburstOpenSigil = false;
        let starburstOpenSelf = false;

        function layoutStarburst() {
            const overlay = document.getElementById('starburstOverlay');
            const menu = overlay.querySelector('.starburst-menu');
            const items = overlay.querySelectorAll('.starburst-item');
            const spokesContainer = overlay.querySelector('.starburst-spokes');
            const centerEl = overlay.querySelector('.starburst-center');
            const rect = menu.getBoundingClientRect();
            const size = Math.min(rect.width, rect.height);
            const vw = window.innerWidth;
            const isNarrow = vw <= 480;
            const isCompact = vw <= 420;
            const isUltraNarrow = vw <= 360;
            const isMobileWide = vw > 480 && vw <= 768;
            let baseR = 0.38;
            let maxR = 190;
            if (isMobileWide) { baseR = 0.44; maxR = 200; }
            if (isNarrow) { baseR = 0.60; maxR = 210; }
            if (isCompact) { baseR = 0.64; maxR = 218; }
            if (isUltraNarrow) { baseR = 0.70; maxR = 224; }
            const radius = Math.max(110, Math.min(baseR * size, maxR));
            const centerRadius = centerEl ? (centerEl.getBoundingClientRect().width / 2) : 70;

            // Ensure spokes count matches items count
            if (spokesContainer) {
                while (spokesContainer.firstChild) spokesContainer.removeChild(spokesContainer.firstChild);
            }

            const n = items.length;
            // Soft white theme to match homepage
            const themeTint = 'hsla(0, 0%, 96%, 0.92)';
            const themeTintSolid = 'hsla(0, 0%, 100%, 1)';
            const themeSpoke = 'hsla(0, 0%, 100%, 0.28)';
            items.forEach((item, index) => {
                // Even spacing around circle, start at top (-90deg)
                const angleDeg = (index * (360 / n));
                const angle = (angleDeg - 90) * Math.PI / 180; // start at top
                // Clamp radius per-item to prevent bleed beyond menu bounds
                const halfW = (item.offsetWidth || 140) / 2;
                const margin = isUltraNarrow ? 4 : (isCompact ? 6 : 8);
                const safeR = Math.max(60, Math.min(radius, (rect.width / 2) - halfW - margin));
                const x = Math.cos(angle) * safeR;
                const y = Math.sin(angle) * safeR;
                item.style.setProperty('--pos', `translate(${x}px, ${y}px)`);
                // also set stagger
                item.style.transitionDelay = `${0.06 * index}s`;

                // Spoke variables
                const dist = Math.sqrt(x * x + y * y);
                item.style.setProperty('--angle', angle + 'rad');
                item.style.setProperty('--dist', dist + 'px');

                // Unified theme tint
                item.style.setProperty('--tint', themeTint);
                item.style.setProperty('--tintSolid', themeTintSolid);

                // Create spoke element aligned with angle and distance
                if (spokesContainer) {
                    const spoke = document.createElement('div');
                    spoke.className = 'spoke';
                    spoke.style.setProperty('--angle', angle + 'rad');
                    const stop = Math.max(0, dist - (centerRadius + 12));
                    spoke.style.setProperty('--dist', stop + 'px'); // stop just before the center circle
                    spoke.style.setProperty('--spoke', themeSpoke);
                    spokesContainer.appendChild(spoke);
                    // animate in next frame
                    requestAnimationFrame(() => { spoke.style.opacity = '1'; });

                    const dot = document.createElement('div');
                    dot.className = 'spoke-dot';
                    dot.style.setProperty('--pos', `translate(${x}px, ${y}px)`);
                    dot.style.setProperty('--tint', themeTint);
                    spokesContainer.appendChild(dot);
                    requestAnimationFrame(() => { dot.style.opacity = '1'; });
                }
            });
        }

        function openStarburst() {
            const overlay = document.getElementById('starburstOverlay');
            const items = overlay.querySelectorAll('.starburst-item');
            const menu = overlay.querySelector('.starburst-menu');
            overlay.classList.add('active');
            // Always use line-mode list with crescent effect
            menu.classList.add('line-mode');
            // Lock background scroll and focus
            try { document.body.dataset.prevOverflow = document.body.style.overflow; document.body.style.overflow = 'hidden'; } catch {}
            overlay.setAttribute('tabindex','-1'); overlay.focus();
            const firstOptSC = overlay.querySelector('.starburst-item[tabindex="0"]') || overlay.querySelector('.starburst-item');
            if (firstOptSC) setTimeout(()=>{ try { firstOptSC.focus(); } catch{} }, 60);
            const firstOptSi = overlay.querySelector('.starburst-item[tabindex="0"]') || overlay.querySelector('.starburst-item');
            if (firstOptSi) setTimeout(()=>{ try { firstOptSi.focus(); } catch{} }, 60);
            const firstOptH = overlay.querySelector('.starburst-item[tabindex="0"]') || overlay.querySelector('.starburst-item');
            if (firstOptH) setTimeout(()=>{ try { firstOptH.focus(); } catch{} }, 60);
            const firstOpt0 = overlay.querySelector('.starburst-item[tabindex="0"]') || overlay.querySelector('.starburst-item');
            if (firstOpt0) setTimeout(()=>{ try { firstOpt0.focus(); } catch{} }, 60);
            if (typeof setupFocusTrap === 'function') setupFocusTrap(overlay);
            // Initial state
            items.forEach(item => {
                item.style.opacity = '0';
                item.style.transform = 'none';
            });
            // Reveal without radial layout in line-mode
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    items.forEach(item => {
                        item.style.opacity = '1';
                        item.style.transform = 'none';
                    });
                });
            });
            // Initialize crescent scroll effect
            try { initCrescentScroll(menu); } catch {}
            // iOS Safari reflow to commit transform centering
            try { void menu.offsetHeight; } catch {}
            // Ensure menu is centered and scrolled to start
            try { menu.scrollLeft = 0; overlay.scrollLeft = 0; menu.scrollTop = 0; } catch {}
            // Definitive centering: fixed, left/right anchors, vertical center
            try {
              menu.style.position = 'fixed';
              menu.style.left = '16px';
              menu.style.right = '16px';
              menu.style.maxWidth = '560px';
              menu.style.margin = '0 auto';
              menu.style.top = '50%';
              menu.style.transform = 'translateY(-50%)';
            } catch {}
            starburstOpen = true;
        }

        function closeStarburst() {
            const overlay = document.getElementById('starburstOverlay');
            const items = overlay.querySelectorAll('.starburst-item');
            const spokesContainer = overlay.querySelector('.starburst-spokes');
            const menu = overlay.querySelector('.starburst-menu');
            // Animate out (no transform in line-mode)
            items.forEach((item, index) => {
                item.style.transitionDelay = `${0.04 * (items.length - index)}s`;
                item.style.opacity = '0';
                if (!menu.classList.contains('line-mode')) {
                    item.style.transform = 'translate(-50%, -50%) scale(0.8)';
                } else {
                    item.style.transform = 'none';
                }
            });
            // Remove after animation
            setTimeout(() => {
                overlay.classList.remove('active');
                if (spokesContainer) {
                    while (spokesContainer.firstChild) spokesContainer.removeChild(spokesContainer.firstChild);
                }
                if (menu) menu.classList.remove('line-mode');
                // Restore scroll
                try { document.body.style.overflow = document.body.dataset.prevOverflow || ''; } catch {}
                if (typeof removeFocusTrap === 'function') removeFocusTrap();
            }, 350);
            starburstOpen = false;
        }

        function toggleStarburst() {
            if (starburstOpen) { closeStarburst(); return; }
            // Close other overlays if open to avoid overlap
            if (starburstOpenHRG) closeStarburstHRG();
            if (starburstOpenSigil) closeStarburstSigil();
            if (starburstOpenSelf) closeStarburstSelfCode();
            openStarburst();
        }

        // Generic layout for alternate overlays
        function layoutStarburstForOverlay(overlayId) {
            const overlay = document.getElementById(overlayId);
            const menu = overlay.querySelector('.starburst-menu');
            const items = overlay.querySelectorAll('.starburst-item');
            const spokesContainer = overlay.querySelector('.starburst-spokes');
            const centerEl = overlay.querySelector('.starburst-center');
            const rect = menu.getBoundingClientRect();
            const size = Math.min(rect.width, rect.height);
            const vw = window.innerWidth;
            const isNarrow = vw <= 480;
            const isCompact = vw <= 420;
            const isUltraNarrow = vw <= 360;
            const isMobileWide = vw > 480 && vw <= 768;
            let baseR = 0.38;
            let maxR = 190;
            if (isMobileWide) { baseR = 0.44; maxR = 200; }
            if (isNarrow) { baseR = 0.60; maxR = 210; }
            if (isCompact) { baseR = 0.64; maxR = 218; }
            if (isUltraNarrow) { baseR = 0.70; maxR = 224; }
            const radius = Math.max(110, Math.min(baseR * size, maxR));
            const centerRadius = centerEl ? (centerEl.getBoundingClientRect().width / 2) : 70;

            if (spokesContainer) while (spokesContainer.firstChild) spokesContainer.removeChild(spokesContainer.firstChild);

            const n = items.length;
            const themeTint = 'hsla(0, 0%, 96%, 0.92)';
            const themeTintSolid = 'hsla(0, 0%, 100%, 1)';
            const themeSpoke = 'hsla(0, 0%, 100%, 0.28)';
            items.forEach((item, index) => {
                const angleDeg = (index * (360 / n));
                const angle = (angleDeg - 90) * Math.PI / 180;
                const halfW = (item.offsetWidth || 140) / 2;
                const margin = isUltraNarrow ? 4 : (isCompact ? 6 : 8);
                const safeR = Math.max(60, Math.min(radius, (rect.width / 2) - halfW - margin));
                const x = Math.cos(angle) * safeR;
                const y = Math.sin(angle) * safeR;
                item.style.setProperty('--pos', `translate(${x}px, ${y}px)`);
                item.style.transitionDelay = `${0.06 * index}s`;
                const dist = Math.sqrt(x * x + y * y);
                item.style.setProperty('--angle', angle + 'rad');
                item.style.setProperty('--dist', dist + 'px');
                item.style.setProperty('--tint', themeTint);
                item.style.setProperty('--tintSolid', themeTintSolid);
                if (spokesContainer) {
                    const spoke = document.createElement('div');
                    spoke.className = 'spoke';
                    spoke.style.setProperty('--angle', angle + 'rad');
                    const stop = Math.max(0, dist - (centerRadius + 12));
                    spoke.style.setProperty('--dist', stop + 'px');
                    spoke.style.setProperty('--spoke', themeSpoke);
                    spokesContainer.appendChild(spoke);
                    requestAnimationFrame(() => { spoke.style.opacity = '1'; });
                    const dot = document.createElement('div');
                    dot.className = 'spoke-dot';
                    dot.style.setProperty('--pos', `translate(${x}px, ${y}px)`);
                    dot.style.setProperty('--tint', themeTint);
                    spokesContainer.appendChild(dot);
                    requestAnimationFrame(() => { dot.style.opacity = '1'; });
                }
            });
        }

        function openStarburstHRG() {
            const overlay = document.getElementById('starburstOverlayHRG');
            const items = overlay.querySelectorAll('.starburst-item');
            overlay.classList.add('active');
            // Force line-mode for clarity and prevent radial glitches
            const menu = overlay.querySelector('.starburst-menu');
            if (menu) menu.classList.add('line-mode');
            // Do not set inline positioning; CSS grid centers the menu
            try { document.body.dataset.prevOverflow = document.body.style.overflow; document.body.style.overflow = 'hidden'; } catch {}
            overlay.setAttribute('tabindex','-1'); overlay.focus();
            items.forEach(item => { item.style.opacity = '0'; item.style.transform = 'none'; });
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    items.forEach(item => { item.style.opacity = '1'; item.style.transform = 'none'; });
                });
            });
            try { if (menu) initCrescentScroll(menu); } catch {}
            starburstOpenHRG = true;
        }

        function closeStarburstHRG() {
            const overlay = document.getElementById('starburstOverlayHRG');
            const items = overlay.querySelectorAll('.starburst-item');
            const spokesContainer = overlay.querySelector('.starburst-spokes');
            const menu = overlay.querySelector('.starburst-menu');
            items.forEach((item, index) => {
                item.style.transitionDelay = `${0.04 * (items.length - index)}s`;
                item.style.opacity = '0';
                item.style.transform = 'none';
            });
            setTimeout(() => {
                overlay.classList.remove('active');
                if (spokesContainer) while (spokesContainer.firstChild) spokesContainer.removeChild(spokesContainer.firstChild);
                if (menu) menu.classList.remove('line-mode');
                try { document.body.style.overflow = document.body.dataset.prevOverflow || ''; } catch {}
            }, 350);
            starburstOpenHRG = false;
        }

        function toggleStarburstHRG() {
            if (starburstOpenHRG) { closeStarburstHRG(); return; }
            if (starburstOpen) closeStarburst();
            if (starburstOpenSigil) closeStarburstSigil();
            if (starburstOpenSelf) closeStarburstSelfCode();
            openStarburstHRG();
        }

        function openStarburstSigil() {
            const overlay = document.getElementById('starburstOverlaySigil');
            const items = overlay.querySelectorAll('.starburst-item');
            overlay.classList.add('active');
            const menu = overlay.querySelector('.starburst-menu');
            if (menu) menu.classList.add('line-mode');
            try { document.body.dataset.prevOverflow = document.body.style.overflow; document.body.style.overflow = 'hidden'; } catch {}
            overlay.setAttribute('tabindex','-1'); overlay.focus();
            items.forEach(item => { item.style.opacity = '0'; item.style.transform = 'none'; });
            requestAnimationFrame(() => { requestAnimationFrame(() => { items.forEach(item => { item.style.opacity = '1'; item.style.transform = 'none'; }); }); });
            try { if (menu) initCrescentScroll(menu); } catch {}
            starburstOpenSigil = true;
        }

        function closeStarburstSigil() {
            const overlay = document.getElementById('starburstOverlaySigil');
            const items = overlay.querySelectorAll('.starburst-item');
            const spokesContainer = overlay.querySelector('.starburst-spokes');
            const menu = overlay.querySelector('.starburst-menu');
            items.forEach((item, index) => { item.style.transitionDelay = `${0.04 * (items.length - index)}s`; item.style.opacity = '0'; item.style.transform = 'none'; });
            setTimeout(() => {
                overlay.classList.remove('active');
                if (spokesContainer) while (spokesContainer.firstChild) spokesContainer.removeChild(spokesContainer.firstChild);
                if (menu) menu.classList.remove('line-mode');
                try { document.body.style.overflow = document.body.dataset.prevOverflow || ''; } catch {}
            }, 350);
            starburstOpenSigil = false;
        }

        function toggleStarburstSigil() {
            if (starburstOpenSigil) { closeStarburstSigil(); return; }
            if (starburstOpen) closeStarburst();
            if (starburstOpenHRG) closeStarburstHRG();
            if (starburstOpenSelf) closeStarburstSelfCode();
            openStarburstSigil();
        }

        function openStarburstSelfCode() {
            const overlay = document.getElementById('starburstOverlaySelfCode');
            const items = overlay.querySelectorAll('.starburst-item');
            overlay.classList.add('active');
            const menu = overlay.querySelector('.starburst-menu');
            if (menu) menu.classList.add('line-mode');
            try { document.body.dataset.prevOverflow = document.body.style.overflow; document.body.style.overflow = 'hidden'; } catch {}
            overlay.setAttribute('tabindex','-1'); overlay.focus();
            items.forEach(item => { item.style.opacity = '0'; item.style.transform = 'none'; });
            requestAnimationFrame(() => { requestAnimationFrame(() => { items.forEach(item => { item.style.opacity = '1'; item.style.transform = 'none'; }); }); });
            try { if (menu) initCrescentScroll(menu); } catch {}
            starburstOpenSelf = true;
        }

        function closeStarburstSelfCode() {
            const overlay = document.getElementById('starburstOverlaySelfCode');
            const items = overlay.querySelectorAll('.starburst-item');
            const spokesContainer = overlay.querySelector('.starburst-spokes');
            const menu = overlay.querySelector('.starburst-menu');
            items.forEach((item, index) => { item.style.transitionDelay = `${0.04 * (items.length - index)}s`; item.style.opacity = '0'; item.style.transform = 'none'; });
            setTimeout(() => {
                overlay.classList.remove('active');
                if (spokesContainer) while (spokesContainer.firstChild) spokesContainer.removeChild(spokesContainer.firstChild);
                if (menu) menu.classList.remove('line-mode');
                try { document.body.style.overflow = document.body.dataset.prevOverflow || ''; } catch {}
            }, 350);
            starburstOpenSelf = false;
        }

        function toggleStarburstSelfCode() {
            if (starburstOpenSelf) { closeStarburstSelfCode(); return; }
            if (starburstOpen) closeStarburst();
            if (starburstOpenHRG) closeStarburstHRG();
            if (starburstOpenSigil) closeStarburstSigil();
            openStarburstSelfCode();
        }

        // Global listeners for both overlays (ignore clicks on the feature headers)
        document.addEventListener('click', function(e) {
            const isFeatureTrigger = (
              e.target.closest && (
                e.target.closest('.spiral-clickable') ||
                e.target.closest('.holographic-clickable') ||
                e.target.closest('.sigil-clickable') ||
                e.target.closest('.selfcode-clickable')
              )
            );
            if (isFeatureTrigger) return;
            const o1 = document.getElementById('starburstOverlayHRG');
            const m1 = o1 && o1.querySelector('.starburst-menu');
            if (starburstOpenHRG && e.target === o1) closeStarburstHRG();
            else if (starburstOpenHRG && m1 && !m1.contains(e.target)) closeStarburstHRG();

            const o2 = document.getElementById('starburstOverlaySigil');
            const m2 = o2 && o2.querySelector('.starburst-menu');
            if (starburstOpenSigil && e.target === o2) closeStarburstSigil();
            else if (starburstOpenSigil && m2 && !m2.contains(e.target)) closeStarburstSigil();

            const o3 = document.getElementById('starburstOverlaySelfCode');
            const m3 = o3 && o3.querySelector('.starburst-menu');
            if (starburstOpenSelf && e.target === o3) closeStarburstSelfCode();
            else if (starburstOpenSelf && m3 && !m3.contains(e.target)) closeStarburstSelfCode();
        }, { passive: true });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (starburstOpenHRG) closeStarburstHRG();
                if (starburstOpenSigil) closeStarburstSigil();
                if (starburstOpenSelf) closeStarburstSelfCode();
            }
        });

        window.addEventListener('resize', function() {
            if (starburstOpenHRG) layoutStarburstForOverlay('starburstOverlayHRG');
            if (starburstOpenSigil) layoutStarburstForOverlay('starburstOverlaySigil');
            if (starburstOpenSelf) layoutStarburstForOverlay('starburstOverlaySelfCode');
        }, { passive: true });
        
        // Re-layout on scroll for overlays when content is scrollable
        document.addEventListener('scroll', function() {
            if (starburstOpen) layoutStarburst();
            if (starburstOpenHRG) layoutStarburstForOverlay('starburstOverlayHRG');
            if (starburstOpenSigil) layoutStarburstForOverlay('starburstOverlaySigil');
            if (starburstOpenSelf) layoutStarburstForOverlay('starburstOverlaySelfCode');
        }, { passive: true });

        // Close starburst when clicking outside or on background (ignore clicks on trigger)
        document.addEventListener('click', function(e) {
            const overlay = document.getElementById('starburstOverlay');
            const menu = overlay.querySelector('.starburst-menu');
            const isFeatureTrigger = (
              e.target.closest && (
                e.target.closest('.spiral-clickable')
              )
            );
            if (!starburstOpen) return;
            if (e.target === overlay) {
                closeStarburst();
                return;
            }
            if (!menu.contains(e.target) && !isFeatureTrigger) {
                closeStarburst();
            }
        }, false);

        // Prevent overlay inner clicks from bubbling to document
        document.getElementById('starburstOverlay').addEventListener('click', function(e) {
            const menu = this.querySelector('.starburst-menu');
            if (menu.contains(e.target)) {
                e.stopPropagation();
            }
        });

        // Close with escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && starburstOpen) closeStarburst();
        });

        // Relayout on resize for perfect centering
        window.addEventListener('resize', function() {
            if (starburstOpen) layoutStarburst();
        }, { passive: true });

        // 3D tilt on mouse move for depth
        (function enableMenuTilt() {
            const overlay = document.getElementById('starburstOverlay');
            const menu = overlay.querySelector('.starburst-menu');
            let raf = null;
            let targetRX = 0, targetRY = 0;
            let currentRX = 0, currentRY = 0;

            function onMove(e) {
                if (!starburstOpen || !window.__fwMotionEnabled) return;
                const menuEl = menu;
                if (menuEl && menuEl.classList.contains('line-mode')) return; // disable tilt in line-mode
                const rect = menu.getBoundingClientRect();
                const cx = rect.left + rect.width / 2;
                const cy = rect.top + rect.height / 2;
                const dx = (e.clientX - cx) / (rect.width / 2);
                const dy = (e.clientY - cy) / (rect.height / 2);
                const maxTilt = 6; // degrees
                targetRY = dx * maxTilt; // y-axis rotation
                targetRX = -dy * maxTilt; // x-axis rotation
                if (!raf) raf = requestAnimationFrame(applyTilt);
            }

            function applyTilt() {
                raf = null;
                // smooth lerp
                currentRX += (targetRX - currentRX) * 0.12;
                currentRY += (targetRY - currentRY) * 0.12;
                // Avoid any horizontal nudge: only apply tiny shadow, not transform
                menu.style.boxShadow = `0 0 0 rgba(0,0,0,0)`;
            }

            overlay.addEventListener('mousemove', onMove, { passive: true });
            overlay.addEventListener('mouseleave', () => {
                targetRX = targetRY = 0;
                if (!raf) raf = requestAnimationFrame(applyTilt);
            });
        })();

        // Canvas-based Menu (replaces overlays on mobile/any)
        (function initInlineMenuCanvas(){
            const canvas = document.getElementById('menuCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const dpr = Math.min(window.devicePixelRatio||1, 2);
            function resize(){
                const rect = canvas.getBoundingClientRect();
                canvas.width = Math.floor(rect.width * dpr);
                canvas.height = Math.floor(rect.height * dpr);
                ctx.setTransform(dpr,0,0,dpr,0,0);
            }
            resize();
            window.addEventListener('resize', resize, { passive:true });
            const MENU = [
              { label: 'Manufacturing & Logistics', key: 'manufacturing' },
              { label: 'Finance & Banking', key: 'finance' },
              { label: 'Blockchain & Web3', key: 'blockchain' },
              { label: 'Robotics & IoT', key: 'robotics' },
              { label: 'Gaming & VR', key: 'gaming' },
              { label: 'Space', key: 'space' },
              { label: 'Government & Defense', key: 'government' },
              { label: 'Security', key: 'security' },
              { label: 'Biotech & Comp. Biology', key: 'biotech' },
              { label: 'Healthcare', key: 'healthcare' },
              { label: 'LegalTech & Judiciary', key: 'legal' },
              { label: 'Augmented Reality', key: 'ar' },
              { label: 'Satellites', key: 'satellites' },
              { label: 'Developer Tools', key: 'devtools' },
              { label: 'Education', key: 'education' },
              { label: 'City Planning', key: 'city' }
            ];
            let scroll = 0; let target = 0; let dragging=false; let lastY=0; let velocity=0; let dragStartY=0; let dragTotal=0; let dragStartAt=0;
            canvas.addEventListener('wheel', e=>{ e.preventDefault(); e.stopPropagation(); target += e.deltaY*0.75; }, { passive:false });
            // Pointer drag (mouse + touch via pointer events)
            canvas.addEventListener('pointerdown', e=>{ dragging=true; lastY = e.clientY; dragStartY = e.clientY; dragTotal = 0; dragStartAt = performance.now(); velocity=0; canvas.setPointerCapture(e.pointerId); canvas.style.cursor='grabbing'; e.preventDefault(); e.stopPropagation(); });
            canvas.addEventListener('pointermove', e=>{ if(!dragging) return; const y=e.clientY; const dy = (lastY - y); target += dy; velocity = dy; lastY = y; dragTotal += Math.abs(dy); e.preventDefault(); e.stopPropagation(); });
            canvas.addEventListener('pointerup', e=>{ const isTap = dragTotal < 8 && (performance.now() - dragStartAt) < 300; dragging=false; canvas.releasePointerCapture(e.pointerId); canvas.style.cursor='grab'; if (isTap) { activateAtCanvasY(e.clientY); } e.preventDefault(); e.stopPropagation(); });
            // Fallback touch for older browsers
            canvas.addEventListener('touchstart', e=>{ dragging=true; lastY = e.touches[0].clientY; dragStartY = lastY; dragTotal = 0; dragStartAt = performance.now(); velocity=0; e.preventDefault(); e.stopPropagation(); }, { passive:false });
            canvas.addEventListener('touchmove', e=>{ if(!dragging) return; const y=e.touches[0].clientY; const dy = (lastY - y); target += dy; velocity = dy; lastY = y; dragTotal += Math.abs(dy); e.preventDefault(); e.stopPropagation(); }, { passive:false });
            canvas.addEventListener('touchend', e=>{
                const t = e.changedTouches && e.changedTouches[0];
                const isTap = dragTotal < 8 && (performance.now() - dragStartAt) < 300;
                if (t && isTap) activateAtCanvasY(t.clientY);
                dragging=false; e.preventDefault(); e.stopPropagation();
            }, { passive:false });
            function centerIndex(idx, h){
                const row = 64; const topPad = 40;
                const min = topPad - (h/2);
                const max = (MENU.length - 1) * row + topPad - (h/2);
                const targetForIdx = idx*row + topPad - (h/2);
                target = Math.max(min, Math.min(max, targetForIdx));
            }
            function activateAtCanvasY(clientY){
                const rect = canvas.getBoundingClientRect();
                const y = clientY - rect.top;
                const h = rect.height;
                const centerY = h/2;
                const idx = Math.max(0, Math.min(MENU.length-1, Math.round((scroll + y - 40) / 64)));
                const itemY = idx*64 - scroll + 40;
                const dist = Math.abs(itemY - centerY);
                // Estimate pill height at current offset for accurate hit test
                const dy = (itemY - centerY) / (h/2);
                const ady = Math.min(1, Math.abs(dy));
                const scale = 0.9 + 0.18*(1-ady);
                const pillH = 44*scale;
                // Always center first, then open after animation if item intended
                if (dist > pillH * 0.6) {
                    centerIndex(idx, h);
                } else {
                    centerIndex(idx, h);
                    const entry = MENU[idx];
                    if (typeof window.openBriefing === 'function' && entry && BRIEFING_DATA && BRIEFING_DATA[entry.key]) {
                        setTimeout(()=>{ try { window.openBriefing(entry.key); } catch{} }, 160);
                    }
                }
            }
            canvas.addEventListener('click', (e)=>{ activateAtCanvasY(e.clientY); e.preventDefault(); e.stopPropagation(); }, { passive:false });
            function clampTarget(){
                const row = 64; const topPad = 40;
                const h = canvas.height / dpr;
                const min = topPad - (h/2);
                const max = (MENU.length - 1) * row + topPad - (h/2);
                target = Math.max(min, Math.min(max, target));
            }
            function draw(){
                clampTarget();
                scroll += (target - scroll) * 0.18;
                ctx.clearRect(0,0,canvas.width,dpr?canvas.height/dpr:canvas.height);
                const w = canvas.width/dpr, h = canvas.height/dpr;
                const ARC_MAX = Math.min(80, w * 0.22); // more arc
                const centerY = h/2;
                ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.font='600 16px system-ui, -apple-system, Segoe UI, Roboto';
                // compute nearest index to center for extra aura
                const nearest = Math.max(0, Math.min(MENU.length-1, Math.round((scroll - 40 + centerY) / 64)));
                for(let i=0;i<MENU.length;i++){
                    const y = i*64 - scroll + 40;
                    const dy = (y - centerY) / (h/2);
                    const ady = Math.min(1, Math.abs(dy));
                    // Depth-of-field tuning: center sharp, edges blur
                    const scale = 0.88 + 0.22*(1-ady);
                    const alpha = 0.28 + 0.72*(1-ady);
                    const blur = 16*Math.pow(ady,1.1);
                    const pillW = Math.min(520, w - 24);
                    const pillH = 44*scale;
                    const baseX = w/2 - pillW/2;
                    const arcX = Math.pow(ady, 0.55) * ARC_MAX; // zero at center, more arc at edges
                    const x = baseX + arcX;
                    // Glow for center
                    if (ady < 0.22){
                        ctx.save(); ctx.globalAlpha = 0.65; ctx.filter = 'blur(26px)';
                        ctx.fillStyle = '#00b4ff';
                        roundRect(ctx, x, y - pillH/2, pillW, pillH, 22);
                        ctx.fill();
                        ctx.filter = 'blur(10px)'; ctx.globalAlpha = 0.42; ctx.fillStyle = 'white';
                        roundRect(ctx, x, y - pillH/2, pillW, pillH, 22);
                        ctx.fill();
                        ctx.restore();
                    }
                    // Additional outer bloom proportional to focus (lighter blend like old menu)
                    if (ady < 0.5) {
                        const bloomStrength = (0.5 - ady) * 0.6; // 0..0.3
                        ctx.save();
                        ctx.globalCompositeOperation = 'lighter';
                        ctx.globalAlpha = 0.25 * bloomStrength;
                        ctx.filter = `blur(${18 * (1-ady)}px)`;
                        ctx.fillStyle = 'rgba(0,180,255,1)';
                        roundRect(ctx, x, y - pillH/2, pillW, pillH, 22);
                        ctx.fill();
                        ctx.globalAlpha = 0.15 * bloomStrength;
                        ctx.fillStyle = 'rgba(255,255,255,1)';
                        roundRect(ctx, x, y - pillH/2, pillW, pillH, 22);
                        ctx.fill();
                        ctx.restore();
                    }
                    ctx.save();
                    ctx.globalAlpha = alpha;
                    ctx.filter = `blur(${blur}px)`;
                    ctx.fillStyle = 'rgba(255,255,255,0.06)';
                    ctx.strokeStyle = 'rgba(255,255,255,0.22)';
                    roundRect(ctx, x, y - pillH/2, pillW, pillH, 22);
                    ctx.fill(); ctx.stroke();
                    // subtle inner highlight for depth
                    const grad = ctx.createLinearGradient(x, y - pillH/2, x, y + pillH/2);
                    grad.addColorStop(0, 'rgba(255,255,255,0.10)');
                    grad.addColorStop(1, 'rgba(255,255,255,0.00)');
                    ctx.fillStyle = grad;
                    roundRect(ctx, x, y - pillH/2, pillW, pillH, 22);
                    ctx.fill();
                    // edge reflection similar to old pills
                    const sideGrad = ctx.createLinearGradient(x, y, x + pillW, y);
                    sideGrad.addColorStop(0.0, 'rgba(255,255,255,0.12)');
                    sideGrad.addColorStop(0.08, 'rgba(255,255,255,0.04)');
                    sideGrad.addColorStop(0.92, 'rgba(255,255,255,0.02)');
                    sideGrad.addColorStop(1.0, 'rgba(255,255,255,0.08)');
                    ctx.fillStyle = sideGrad;
                    ctx.globalAlpha = 0.6 * (1-ady);
                    roundRect(ctx, x, y - pillH/2, pillW, pillH, 22);
                    ctx.fill();
                    ctx.filter = 'none';
                    ctx.fillStyle = 'white';
                    ctx.globalAlpha = Math.max(0.85, alpha); // text stays crisp
                    ctx.fillText(MENU[i].label, w/2, y);
                    ctx.restore();
                }
                // Global DOF fade at top/bottom like old overlay fog (use light haze so it shows on black)
                ctx.save();
                const fade = ctx.createLinearGradient(0, 0, 0, h);
                fade.addColorStop(0.0, 'rgba(255,255,255,0.12)');
                fade.addColorStop(0.1, 'rgba(255,255,255,0.04)');
                fade.addColorStop(0.5, 'rgba(255,255,255,0.00)');
                fade.addColorStop(0.9, 'rgba(255,255,255,0.04)');
                fade.addColorStop(1.0, 'rgba(255,255,255,0.12)');
                ctx.globalCompositeOperation = 'lighter';
                ctx.fillStyle = fade;
                ctx.fillRect(0, 0, w, h);
                ctx.restore();
                // Radial aura around the centered pill for extra depth like old menu
                ctx.save();
                const cy = nearest*64 - scroll + 40;
                const aura = ctx.createRadialGradient(w/2, cy, 10, w/2, cy, Math.min(w, h));
                aura.addColorStop(0.0, 'rgba(0,180,255,0.18)');
                aura.addColorStop(0.35, 'rgba(0,180,255,0.10)');
                aura.addColorStop(0.7, 'rgba(255,255,255,0.06)');
                aura.addColorStop(1.0, 'rgba(255,255,255,0.0)');
                ctx.globalCompositeOperation = 'lighter';
                ctx.fillStyle = aura;
                ctx.fillRect(0, 0, w, h);
                ctx.restore();
                requestAnimationFrame(draw);
            }
            function roundRect(ctx,x,y,w,h,r){ ctx.beginPath(); const rr=Math.min(r,w/2,h/2); ctx.moveTo(x+rr,y); ctx.arcTo(x+w,y,x+w,y+h,rr); ctx.arcTo(x+w,y+h,x,y+h,rr); ctx.arcTo(x,y+h,x,y,rr); ctx.arcTo(x,y,x+w,y,rr); ctx.closePath(); }
            draw();
        })();

        // Crescent-scroll effect: center item scales and glows; top/bottom shrink + fog
        function initCrescentScroll(menu) {
            if (!menu) return;
            const items = Array.from(menu.querySelectorAll('.starburst-item'));
            if (!items.length) return;
            const update = () => {
                const rect = menu.getBoundingClientRect();
                const centerY = rect.top + rect.height / 2;
                items.forEach((item) => {
                    const r = item.getBoundingClientRect();
                    const itemCenter = r.top + r.height / 2;
                    const dy = (itemCenter - centerY) / (rect.height / 2); // -1..1
                    const ady = Math.min(1, Math.abs(dy));
                    // Scale from 0.88 at edges to 1.08 at center
                    const scale = 0.88 + (1.08 - 0.88) * (1 - ady);
                    // Opacity and blur for depth
                    const opacity = 0.55 + 0.45 * (1 - ady);
                    const blur = 10 * Math.pow(ady, 1.2);
                    // Crescent horizontal offset (moon arc)
                    const maxArc = 0; // disable arc offset to ensure perfect horizontal centering
                    const arcX = (1 - Math.pow(ady, 0.7)) * maxArc;
                    item.style.transform = `translate3d(${arcX}px, 0, 0) scale(${scale})`;
                    item.style.opacity = String(opacity);
                    item.style.filter = `blur(${blur}px) saturate(${0.9 + 0.2 * (1 - ady)})`;
                    item.classList.toggle('is-center', ady < 0.12);
                });
            };
            // Initial and on scroll
            update();
            menu.addEventListener('scroll', update, { passive: true });
            // Update on resize
            window.addEventListener('resize', update, { passive: true });
            // No auto-centering snap; free scroll to top/bottom
        }
    </script>

    <!-- Briefing Room Overlay -->
    <style>
      #briefingOverlay { position: fixed; inset: 0; background: rgba(0,0,0,0.82); backdrop-filter: blur(14px); display: none; align-items: center; justify-content: center; z-index: 3000; }
      #briefingOverlay.active { display: flex; }
      .briefing-card { width: min(1100px, 96vw); max-height: 88vh; overflow: hidden; border: 1px solid rgba(255,255,255,0.18); border-radius: 20px; background: rgba(10,10,10,0.6); box-shadow: 0 20px 60px rgba(0,0,0,0.5); color: #fff; display: grid; grid-template-rows: auto auto 1fr; }
      .briefing-header { padding: 22px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.12); }
      .briefing-header h2 { margin: 6px 0 4px 0; font-weight: 700; letter-spacing: 0.06em; }
      .briefing-header .export { position:absolute; top: 18px; left: 18px; border-radius: 999px; padding: 6px 10px; border: 1px solid rgba(255,255,255,0.25); background: rgba(255,255,255,0.08); color: #fff; cursor: pointer; }
      /* .screen-only marker class used to hide in print */
      .print-only { display: none; }
      .briefing-controls { display: flex; gap: 10px; justify-content: center; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.12); }
      .briefing-controls .pill { background: rgba(255,255,255,0.04); color: #fff; border: 1px solid rgba(255,255,255,0.22); padding: 6px 12px; border-radius: 999px; cursor: pointer; transition: transform 160ms ease, background 180ms ease, border-color 180ms ease, box-shadow 180ms ease; }
      .briefing-controls .pill:hover { transform: translateY(-1px); border-color: rgba(255,255,255,0.34); box-shadow: 0 6px 16px rgba(0,0,0,0.35); }
      .briefing-controls .pill:active { transform: translateY(0); transition-duration: 80ms; }
      .briefing-controls .pill.active { background: rgba(255,255,255,0.16); border-color: rgba(255,255,255,0.3); }
      .briefing-content { overflow: auto; padding: 22px; position: relative; }
      .briefing-content::before, .briefing-content::after { content:""; position:absolute; left:0; right:0; height:18px; pointer-events:none; transition: opacity 220ms ease; }
      .briefing-content::before { top:0; background: linear-gradient(to bottom, rgba(0,0,0,0.55), rgba(0,0,0,0)); opacity: 0; }
      .briefing-content::after { bottom:0; background: linear-gradient(to top, rgba(0,0,0,0.55), rgba(0,0,0,0)); opacity: 1; }
      .briefing-content.at-top::before { opacity: 0; }
      .briefing-content.at-top::after { opacity: 1; }
      .briefing-content.at-bottom::after { opacity: 0; }
      .tabs { display: flex; gap: 8px; justify-content: center; margin-bottom: 14px; }
      .tab { border: 1px solid rgba(255,255,255,0.22); background: rgba(255,255,255,0.04); color: #fff; padding: 6px 12px; border-radius: 999px; cursor: pointer; transition: transform 160ms ease, background 180ms ease, border-color 180ms ease, box-shadow 180ms ease; }
      .tab:hover { transform: translateY(-1px); border-color: rgba(255,255,255,0.36); box-shadow: 0 6px 16px rgba(0,0,0,0.35); }
      .tab:active { transform: translateY(0); transition-duration: 80ms; }
      .tab.active { background: rgba(255,255,255,0.12); border-color: rgba(255,255,255,0.32); }
      .usecase h4 { margin: 14px 0 4px 0; font-weight: 600; }
      .usecase p { margin: 0 0 10px 0; color: #e9e9e9; line-height: 1.8; }
      details.usecase { border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; padding: 8px 12px; margin: 8px auto; max-width: 900px; background: rgba(255,255,255,0.03); }
      details.usecase summary { cursor: pointer; list-style: none; }
      details.usecase summary::-webkit-details-marker { display:none; }
      .section-subtitle { font-weight: 700; letter-spacing: 0.04em; margin: 12px 0 6px 0; }
      .quicknav { display:flex; gap:8px; justify-content:center; margin: 8px 0 16px 0; flex-wrap: wrap; }
      .quicknav .chip { border: 1px dashed rgba(255,255,255,0.25); padding: 4px 10px; border-radius: 999px; cursor: pointer; font-size: 12px; transition: transform 140ms ease, border-color 160ms ease, background 160ms ease; }
      .quicknav .chip:hover { transform: translateY(-1px); border-color: rgba(255,255,255,0.4); background: rgba(255,255,255,0.06); }
      .quicknav .chip:active { transform: translateY(0); transition-duration: 80ms; }
      .pilot-bar { position: sticky; bottom: 0; background: rgba(20,20,20,0.85); backdrop-filter: blur(8px); border-top: 1px solid rgba(255,255,255,0.12); padding: 10px; display: none; gap: 8px; align-items: center; justify-content: center; }
      .pilot-bar.active { display: flex; flex-wrap: wrap; }
      .pilot-chip { background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.18); border-radius: 999px; padding: 4px 10px; font-size: 12px; }
      .modal { position: fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:4000; background: rgba(0,0,0,0.6); backdrop-filter: blur(6px); }
      .modal.active { display:flex; }
      .modal-content { width:min(720px,92vw); background: rgba(18,18,18,0.95); border:1px solid rgba(255,255,255,0.15); border-radius: 12px; padding: 18px; color:#fff; }
      .modal-content h4 { margin:0 0 8px 0; }
      .modal-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:10px; }
      .close-briefing { position: absolute; top: 18px; right: 18px; width: 36px; height: 36px; border-radius: 50%; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.25); color: #fff; cursor: pointer; }
      .blk h3 { margin: 18px 0 8px 0; font-weight: 700; letter-spacing: 0.04em; }
      .blk p { margin: 0 0 12px 0; color: #e9e9e9; }
      .list { text-align: left; max-width: 920px; margin: 0 auto 12px auto; }
      .list li { margin: 6px 0; }
      .hr { height: 1px; background: rgba(255,255,255,0.12); margin: 14px auto; width: 92%; }
      .modules { text-align: left; max-width: 980px; margin: 10px auto; }
      .modules h4 { margin: 14px 0 6px 0; font-weight: 600; }
      .modules ul { margin: 0 0 10px 0; padding-left: 18px; }
      @media print {
        html, body { background: #fff !important; color: #000 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        #briefingOverlay { position: static; inset: auto; display: block !important; background: #fff !important; backdrop-filter: none !important; }
        .briefing-card { width: auto; max-height: none; border: none; border-radius: 0; box-shadow: none; background: #fff !important; color: #000 !important; grid-template-rows: auto 1fr; }
        .close-briefing, .export, .briefing-controls, .tabs, .screen-only { display: none !important; }
        .print-only { display: block !important; }
        .usecase p, .blk p, .list li { color: #000 !important; }
        .hr { background: #000 !important; }
        #briefingHeart { display: none !important; }
        a::after { content: " (" attr(href) ")"; font-size: 11px; }
        .page-break { page-break-after: always; }
      }
    </style>
    <div id="briefingOverlay" aria-modal="true" role="dialog" aria-label="Industry Briefing">
      <div class="briefing-card" role="document">
        <button class="close-briefing screen-only" onclick="closeBriefing()">×</button>
        <div class="briefing-header">
          <button class="export screen-only" onclick="exportBrief()">Export PDF</button>
          <canvas id="briefingHeart" style="width:120px;height:120px;display:block;margin:0 auto 6px auto;"></canvas>
          <h2 id="briefingTitle">Briefing</h2>
          <div style="font-size:13px;letter-spacing:0.06em;opacity:0.9">Feature matrix and pilot plan</div>
          <div class="screen-only" style="margin-top:8px; display:flex; gap:8px; justify-content:center; flex-wrap:wrap;">
            <button class="tab" onclick="copyBriefLink()">Copy link</button>
            <button class="tab" onclick="copyBriefMarkdown()">Copy brief</button>
            <button class="tab" onclick="saveBriefMarkdown()">Save brief (.md)</button>
            <button class="tab" onclick="startPilot()">Start a pilot</button>
          </div>
          <div id="printMeta" class="print-only" style="font-size:12px; margin-top:6px;"></div>
        </div>
        <div class="briefing-controls">
          <button id="persona-investor" class="pill" onclick="setPersona('investor')">Investor</button>
          <button id="persona-operator" class="pill" onclick="setPersona('operator')">Operator</button>
          <button id="persona-engineer" class="pill" onclick="setPersona('engineer')">Engineer</button>
        </div>
        <div class="briefing-content">
          <div class="tabs">
            <button id="tab-spiral" class="tab active" onclick="setFeature('spiral')">Spiral Memory</button>
            <button id="tab-hrg" class="tab" onclick="setFeature('hrg')">Holographic Reality</button>
            <button id="tab-sigil" class="tab" onclick="setFeature('sigil')">DNA Sigil Identity</button>
            <button id="tab-selfcode" class="tab" onclick="setFeature('selfcode')">Self Coding</button>
          </div>
          <div id="briefingBody"></div>
        </div>
      </div>
    </div>
    <script>
      const BRIEFING_DATA = {
        blockchain: {
          title: 'Blockchain & Web3',
          features: {
            spiral: { intro: 'Unifies on‑chain and off‑chain telemetry into a time‑indexed lattice—instant causality queries across txs, oracles, votes, TVL, and social.', introPersona: {
              investor: 'Causality and receipts: faster incident response, safer scaling, and a data moat from counterfactuals.',
              operator: 'See anomalies early, understand the why, trigger safe playbooks—less chaos in live markets.',
              engineer: 'Chain + off‑chain signals in a consistent timeline; fast queries for mempool, oracle, and bridge events.'
            }, usecases: [
              { title: 'Unified Chain Memory', body: 'Txs, oracle updates, bridge movements, governance votes, TVL flows, social telemetry—linked in time to explain outcomes.' },
              { title: 'Incident Forensics', body: 'Flash‑loan and sandwich patterns tied to code paths; build receipts for patches and claims.' },
              { title: 'Governance History', body: 'Proposals and params mapped to market impacts; avoid repeats by design.' }
            ] },
            hrg: { intro: 'Digital twins of protocols and markets: MEV attacks, liquidation cascades, oracle drift, gas spikes, restaking contagion, bridge stress—tested before mainnet.', introPersona: {
              investor: 'Sim‑before‑ship slashes tail risk; insurability goes up and exploits go down.',
              operator: 'Dry‑run chaos—pick params and circuit‑breakers that hold when gas and TVL spike.',
              engineer: 'MEV/arb/liq engines, oracle wobble, bridge lag; parameter sweeps and agent swarms you can diff.'
            }, usecases: [
              { title: 'Restaking & LST Risk Guard', body: 'Simulate slash paths and correlation; cap AVS exposure with live loop; propose safer params when coupling rises.' },
              { title: 'Stablecoin Stress', body: 'Depeg scenarios with oracle drift and reserve lag; pick guardrails before it hits live.' },
              { title: 'Exploit Red‑Team', body: 'Red‑team the protocol pre‑launch; ship with evidence and a rollback plan.' }
            ], signals: [ 'Mempool and block events', 'Oracle feeds and staleness', 'Bridge and restaking flows', 'Gas price and congestion', 'Social sentiment and alerts' ], proposes: [ 'Param updates and limits', 'Circuit‑breakers and guards', 'Launch/rollback plans with receipts' ] },
            sigil: { intro: 'Attested, rotating keys for wallets, contracts, bots, and oracles. Sybil‑resistant participation, signed provenance, and programmable KYC/permissions (zk‑friendly) when needed.', introPersona: {
              investor: 'Trust without killing UX—growth stays, fraud fades.',
              operator: 'Sybil‑resistant governance and cleaner bridges; fewer pauses and chaos pings.',
              engineer: 'Attestations for bots/oracles/wallets; zk‑friendly checks and portable proofs.'
            }, usecases: [
              { title: 'Sybil‑Resistant Participation', body: 'Rotating keys anchored to Sigil‑DNA; fair drops and legit quorum.' },
              { title: 'Provenance & Compliance', body: 'Signed mint/burn and reserve proofs; programmable KYC paths where required.' },
              { title: 'Secure Oracles & Bridges', body: 'Feed and relayer identities are verifiable; policy gates trip safely under drift.' }
            ], signals: [ 'Wallet/device posture', 'Attestation trails', 'Reserve/oracle proofs', 'Bridge signer health' ], proposes: [ 'Step‑ups for risky flows', 'Quorum rules and tally proofs', 'Mint/burn allowlists with receipts' ] },
            selfcode: { intro: 'Watches mempool and repos; drafts patches, param updates, and governance proposals; ships upgrades with rollout and rollback plans.', introPersona: {
              investor: 'Self‑patching protocols: fewer exploits, faster recovery, stronger moat.',
              operator: 'Auto‑playbooks from mempool spikes to on‑chain proposals—MTTR drops.',
              engineer: 'Foundry/Hardhat hooks; diffs, tests, canary gates, and rollback built in.'
            }, usecases: [
              { title: 'Exploit Shield', body: 'Flag flash‑loan patterns in <1 block; draft pause/upgrade proposals with diffs + tests.' },
              { title: 'Param Tuner', body: 'Auto‑propose safe fee/limit/ratio changes from sim evidence; ship with canaries.' },
              { title: 'Governance With Receipts', body: 'Write proposals with counterfactuals and tally proofs; fewer bad params, legit quorum.' }
            ], signals: [ 'Mempool anomalies, gas spikes', 'Repo diffs and CI failures', 'TVL, slippage, liquidation risk' ], proposes: [ 'Pause/upgrade proposals', 'Parameter deltas with evidence', 'Rollout/rollback plans' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The On‑Chain OS', groups: [
              { name: 'Spiral Memory', bullets: [ 'Unifies on‑chain events and off‑chain telemetry; instant causality queries.' ]},
              { name: 'Sigil‑DNA (Identity)', bullets: [ 'Attested, rotating keys for wallets/contracts/bots; zk‑friendly permissions.' ]},
              { name: 'HRG (Holographic Sim)', bullets: [ 'Twins of protocols/markets: MEV, liquidations, oracle drift, bridges.' ]},
              { name: 'Self‑Coding', bullets: [ 'Mempool‑aware patches, param updates, and proposals with tests.' ]},
              { name: '100 Hz Loop', bullets: [ 'Circuit‑breakers, rate limits, route nudges under anomalies.' ]}
            ] },
            wins: { title: 'High‑Impact Use Cases', bullets: [
              'Restaking & LST Risk Guard — contain contagion, keep yields predictable.',
              'Stablecoin Trust Layer — compliance‑grade transparency without UX pain.',
              'RWA & Settlement Spine — lower legal risk and smoother institutional routes.',
              'DeFi Exploit Shield — fewer hacks, faster MTTR, insurability.',
              'AA Wallet Co‑Pilot — mainstream UX without losing self‑custody.',
              'Governance With Receipts — fewer bad params, more legitimate quorum.'
            ] },
            stack: { title: 'Minimal Stack (drop‑in)', lists: [
              { k: 'Data & Indexing', v: 'Subsquid/The Graph → Spiral Memory' },
              { k: 'Contracts', v: 'Solidity/Vyper + Foundry/Hardhat CI (Self‑Coding hooks)' },
              { k: 'Security', v: 'Sigil‑DNA attestations • on‑chain pause/guard modules' },
              { k: 'Compute', v: 'GPU sim farm; optional AVS for verifiable off‑chain compute' },
              { k: 'Front‑End', v: 'React + wagmi/intents SDK + Featherweight Wallet Co‑Pilot' }
            ] },
            gtm: undefined,
            investors: { title: 'Why VCs Wire Fast', bullets: [
              'Security alpha: self‑patching protocols + provable sims reduce tail risk (insurable DeFi).',
              'Compliance optionality: switchable KYC/permissions without forking UX.',
              'Data gravity moat: counterfactual + incident‑receipt corpus compounds.'
            ] },
            tagline: 'Not another chain tool — a conscious control layer for everything on‑chain.',
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Send a 1‑pager “Featherweight × Web3 Risk Guard” to Polygon/EigenLayer/Circle this week.',
              'Cut a 60‑sec demo: mempool spike → HRG alert → auto‑proposal → executed patch → dashboard receipts.',
              'Lock one Devconnect/Token2049 stage slot: “Self‑Patching Protocols: From Mempool to Vote in 10 Minutes.”'
            ] },
            closing: 'You bring the crown; we bring the control layer that keeps the chain alive and the money flowing.'
          }
        },
        security: {
          title: 'Security',
          features: {
            spiral: { intro: 'Threat Graph: stitches endpoints, cloud, IdP, SaaS, OT, code, tickets, and intel into a time‑indexed attack graph for causal investigations.', introPersona: {
              investor: 'From alert soup to causal truth—MTTR falls, premiums drop, proof goes up.',
              operator: 'Ask real questions: “show lateral from svc‑billing to K8s prod in 48h.” Get a plan, not just noise.',
              engineer: 'Time‑indexed attack graph with lineage; fast joins across SIEM/XDR/IdP/CNAPP/Git repos.'
            }, usecases: [
              { title: 'Lateral Movement Finder', body: 'Trace suspected pivots across IdP grants, kube tokens, CI secrets, and SaaS scopes with receipts.' },
              { title: 'Drift Narratives', body: 'Explain config drift from IaC PRs → cloud APIs → runtime; close the loop with fixes.' },
              { title: 'Threat Intel Binding', body: 'External IoCs/TTPS mapped to your real assets; reduce false positives.' }
            ] },
            hrg: { intro: 'Breach‑and‑attack sim: run kill chains, blast‑radius, misconfig drift, ransomware spread, and exfil routes before attackers do.', introPersona: {
              investor: 'Sim‑before‑spend turns budget into verifiable risk reduction.',
              operator: 'Rank top 10 controls by risk‑reduction/effort and ship those first.',
              engineer: 'Replayable attack paths over CNAPP findings and configs; export diffs to IaC.'
            }, usecases: [
              { title: 'Ransomware Kill‑Switch Planning', body: 'Blast‑radius sims drive micro‑seg plans and isolation playbooks.' },
              { title: 'Cloud/K8s Path Testing', body: 'Model exfil via misconfigs; validate OPA/Gatekeeper policies before prod.' },
              { title: 'API Abuse Load', body: 'Adversarial tests on gateways; pick entropy/velocity thresholds safely.' }
            ], signals: [ 'CNAPP findings', 'IdP/OAuth grants', 'K8s/RBAC manifests', 'NetFlow/DNS', 'EDR events' ], proposes: [ 'Micro‑seg and isolation plans', 'OPA/Helm/Terraform diffs', 'API rate/verification gates' ] },
            sigil: { intro: 'Attested, rotating keys for humans, services, devices, models, and policies. Stops token theft, proves who changed what, signs detections and patches.', introPersona: {
              investor: 'Identity‑anchored autonomy—hard to copy, easy to insure.',
              operator: 'Fewer token theft incidents; faster, cleaner approvals and revocations.',
              engineer: 'SCIM/JIT hooks; signed tokens, builds, and releases with provenance.'
            }, usecases: [
              { title: 'Phish‑to‑Prod Cut‑Chain', body: 'Signed tokens and device attestation prevent token replay; just‑in‑time access with receipts.' },
              { title: 'Signed Releases & Detections', body: 'WAF rules, EDR/YARA, and IaC PRs signed and attributable.' },
              { title: 'OT/ICS Device Identity', body: 'Modbus/OPC‑UA devices carry Sigil‑DNA; spoofing attempts get quarantined.' }
            ], signals: [ 'Device posture and attestation', 'Token lineage', 'Build/release signatures' ], proposes: [ 'Step‑up auth patterns', 'Policy‑driven revocations', 'Quarantine triggers' ] },
            selfcode: { intro: 'Autowrites detections, IaC fixes, WAF/API rules, K8s policies, IdP conditions, and PRs with tests + rollback.', introPersona: {
              investor: 'Outcome velocity: faster MTTR, lower premiums, proof‑backed renewals.',
              operator: 'Draft PRs for you: Terraform/Helm/OPA, EDR rules, IdP conditions—approve and move.',
              engineer: 'CI‑first diffs, tests, canaries, and rollbacks. Evidence included.'
            }, usecases: [
              { title: 'Cloud Drift Autopatcher', body: 'Turn CNAPP findings into Terraform/OPA PRs with tests and rollback gates.' },
              { title: 'EDR/YARA Rule Assistant', body: 'Generate tuned detections from Spiral narratives; cut false positives.' },
              { title: 'API Gateway Governor', body: 'Emit WAF/API rules when entropy/velocity spikes; pin to personas.' }
            ], signals: [ 'Findings and drift', 'Alert narratives', 'Traffic entropy/velocity' ], proposes: [ 'IaC diffs with tests', 'EDR/YARA packs', 'Rate‑limit and proof‑of‑human flows' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The Autonomous Defense Layer', groups: [
              { name: 'Spiral Memory (Threat Graph)', bullets: [ 'Stitches endpoints, cloud, IdP, SaaS, OT, repos, tickets, intel into time‑indexed attack graph.' ]},
              { name: 'Sigil‑DNA (Identity & Provenance)', bullets: [ 'Attested, rotating keys for humans/services/devices/models/policies; signs detections and patches.' ]},
              { name: 'HRG (Holographic Sim)', bullets: [ 'Breach‑and‑attack sim: kill chains, blast‑radius, misconfig drift, ransomware spread, exfil routes.' ]},
              { name: 'Self‑Coding', bullets: [ 'Autowrites detections, IaC fixes, WAF/API rules, K8s/IdP policies, PRs with tests + rollback.' ]},
              { name: '100 Hz Loop', bullets: [ 'Real‑time risk throttle: step‑up auth, quarantine, kill tokens, rate‑limit, isolate—then relax.' ]}
            ] },
            surfaces: { title: 'Where it lands (by surface)', rows: [
              { surface: 'Identity / Zero Trust', pain: 'Phish→MFA fatigue→token theft', fix: 'Sigil‑DNA proof on tokens + device attestation; 100 Hz step‑up & JIT access', outcome: 'Credential abuse MTTR → minutes' },
              { surface: 'Cloud / K8s / SaaS', pain: 'Drift, secrets sprawl, shadow apps', fix: 'HRG attack‑path sims; Self‑Coding patches IaC/OPA; Spiral maps app→data→role lineage', outcome: 'Config MTTR ↓; data paths provable' },
              { surface: 'Endpoint / Network / XDR', pain: 'Alert fatigue, slow triage', fix: 'Spiral correlates EDR+DNS+Netflow; 100 Hz quarantines; Self‑Coding ships EDR/YARA', outcome: 'MTTD ↓; false positives ↓' },
              { surface: 'AppSec / API', pain: 'OWASP/API abuse, bot floods', fix: 'HRG adversarial tests; Self‑Coding WAF/API rules; Sigil‑DNA signs releases', outcome: 'Exploit window shrinks' },
              { surface: 'Data Security', pain: 'Exfil via SaaS/API', fix: 'Sigil‑DNA watermark + policy; 100 Hz throttles egress; HRG insider routes', outcome: 'PII exfil blocked with receipts' },
              { surface: 'OT / ICS', pain: 'Modbus/OPC‑UA spoofing, flat networks', fix: 'Sigil device IDs; Spiral learns normal cycles; 100 Hz safe‑stop envelopes', outcome: 'Safety trips without downtime' }
            ] },
            wins: { title: 'High‑impact plays (ship these first)', bullets: [
              'Ransomware Kill‑Switch — blast‑radius sim → micro‑seg plans; 100 Hz freezes lateral (SMB/PSExec), kills tokens, snapshots deltas.',
              'Phish‑to‑Prod Cut‑Chain — correlate phish → OAuth grant → API keys in CI; revoke consent, rotate secrets, harden IdP.',
              'Cloud Drift Autopatcher — continuous attack‑path sims on CNAPP findings; PRs with tests + rollback.',
              'API Abuse Governor — switch to proof‑of‑human flows and rate‑limit per persona during bot surges.',
              'Deception Mesh — plant Sigil‑signed honeytokens/canaries; first touch = high‑confidence alert with causality.'
            ] },
            stack: { title: 'Minimal stack (no rip‑and‑replace)', lists: [
              { k: 'Data', v: 'SIEM/XDR → Kafka/S3 → Spiral Memory' },
              { k: 'IdP', v: 'Okta/AAD; Sigil‑DNA signs tokens, SCIM/JIT hooks' },
              { k: 'Cloud/K8s', v: 'Terraform, Helm, OPA/Gatekeeper, eBPF; CNAPP feed' },
              { k: 'Endpoints/Net', v: 'CrowdStrike/S1/Defender; NetFlow/DNS; ZTNA/SASE' },
              { k: 'App/API', v: 'WAF, API gateway (Apigee/Kong), secret mgmt (Vault/KMS)' },
              { k: 'Ops', v: 'Self‑Coding GitHub App; 100 Hz runtime; HRG sim farm' }
            ] },
            compliance: { title: 'Compliance & receipts (sell to auditors, not just CISOs)', bullets: [
              'Map detections/controls to SOC2, ISO 27001, PCI 4.0, HIPAA, DORA, NIS2.',
              'Every auto‑action writes a Causal Receipt: input → decision → effect → rollback plan.',
              '“Prove you’re secure” becomes export PDF.'
            ] },
            investors: { title: 'Why VCs wire', bullets: [ 'Enormous TAM', 'Proof‑of‑outcome moat', 'Identity‑anchored autonomy rivals cannot mimic' ] },
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Ship a 1‑pager “Featherweight × Security OS” to two MSSPs + one cyber‑insurer; offer receipt‑based premium credits.',
              'Line up a customer tabletop to run the ransomware drill with recorded receipts.',
              'Cut a 60‑sec reel of sim → auto‑patch → receipt; post and tag CISOs & cloud PMs.'
            ] },
            closing: 'Threats move at machine speed. Now your defense does too—with receipts.'
          }
        },
        government: {
          title: 'Government & Defense',
          features: {
            spiral: { intro: 'Whole‑of‑Gov Graph: sensors, comms, logistics, readiness, intel digests, maintenance, finance, and policy stitched into a time‑indexed lattice.', introPersona: {
              investor: 'From stovepipes to causality—procurement and readiness move on proof, not PowerPoints.',
              operator: 'Ask the hard questions: causes of sortie aborts linked to spares and weather; get an action plan.',
              engineer: 'Time‑indexed joins across OT/IT/ISR/logistics/finance/policy; deterministic queries, exportable evidence.'
            }, usecases: [
              { title: 'Joint Logistics & Readiness', body: 'Predict spares/fuel; pre‑position lift; merge weather/runway ops; reprioritize missions hourly.' },
              { title: 'Border & Maritime Awareness', body: 'Fuse AIS/radar/EO‑IR/RF; sensor truth via Sigil; update patrol patterns automatically.' },
              { title: 'Critical Infrastructure Defense', body: 'Link OT telemetry to cyber alerts; islanding/load‑shed playbooks with receipts.' }
            ] },
            hrg: { intro: 'Digital twins for missions, bases, ports, airspace, grids, epidemics, budgets—thousands of what‑ifs before commanders commit.', introPersona: {
              investor: 'Budget to outcomes—simulate before spend, verify after.',
              operator: 'Non‑lethal C2 automation: Switchboard suggests low‑regret branches; you confirm.',
              engineer: 'Replayable twins with policy/export hooks; integrate with existing mission sims.'
            }, usecases: [
              { title: 'JADC2 Reality Router', body: 'Simulates ISR/tasking packages; picks sensor retask/route tweak; writes the why for commander confirm.' },
              { title: 'PNT/Comms Resilience', body: 'Degrade gracefully: alt constellations, terrain‑aided nav, optical links, burst windows.' },
              { title: 'Space Maneuver Planning', body: 'Constellation twins: conjunction avoidance, deorbit, refuel; log compliance proofs.' }
            ], signals: [ 'ISR feeds and tasking', 'Weather and NOTAMs', 'Link health and jamming indications', 'Orbital elements and conjunction data', 'OT/IT telemetry' ], proposes: [ 'Retask/route tweaks', 'Fallback comms windows', 'Conjunction and deorbit plans' ] },
            sigil: { intro: 'Zero‑Trust Identity: attested, rotating keys for people, devices, drones, models, and documents. Every action is signed and auditable.', introPersona: {
              investor: 'Trust and control from HSMs to humans—compliance by construction.',
              operator: 'No spoofed sensors, clean custody and ROE logs; faster approvals.',
              engineer: 'SCIF‑friendly identity and provenance; deterministic audit trails.'
            }, usecases: [
              { title: 'Sensor & Drone Truth', body: 'Attested feeds; spoofing attempts quarantined with receipts.' },
              { title: 'Model‑of‑Record', body: 'Datasets/models signed; lineage and red‑team results logged; model cards shipped.' },
              { title: 'Document Provenance', body: 'Procurement, ROE, and policy changes signed with rationale.' }
            ], signals: [ 'Device attestation and posture', 'Model/data signatures', 'Document/version histories' ], proposes: [ 'Step‑up approvals', 'Revocation and quarantine', 'Signed releases with context' ] },
            selfcode: { intro: 'Autowrites patches, playbooks, IaC/policies, comms routes, and procurement docs with tests + rollbacks. Humans approve; the system ships.', introPersona: {
              investor: 'Faster, safer modernization—proof that moves budgets.',
              operator: 'Drafts PRs for IaC/policies/comms; cut time to fix; keep humans approving.',
              engineer: 'CI‑first diffs with tests and rollback; export model cards and receipts.'
            }, usecases: [
              { title: 'Predictive Maintenance & Life‑Extension', body: 'Parts lineage → fatigue forecasts → pay vendors on proof (OutcomeMesh).' },
              { title: 'Acquisition That Writes Itself', body: 'Draft SOWs/test plans/cyber checklists; auto‑generate change orders from sims.' },
              { title: 'Narrative Resilience', body: 'Detect hostile narratives; simulate counter‑messaging; publish evidence‑based comms.' }
            ], signals: [ 'Maintenance and flight logs', 'Supply chain and finance', 'Media/social telemetry' ], proposes: [ 'IaC/policy diffs', 'Procurement/doc changes', 'Comms playbooks with receipts' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The State & Defense OS', groups: [
              { name: 'Spiral Memory (Whole‑of‑Gov Graph)', bullets: [ 'Sensors, comms, logistics, readiness, intel, maintenance, finance, policy → time‑indexed lattice.' ]},
              { name: 'Sigil‑DNA (Zero‑Trust Identity)', bullets: [ 'Attested, rotating keys for people/devices/drones/models/docs; signed actions.' ]},
              { name: 'HRG', bullets: [ 'Twins for missions, bases, ports, airspace, grids, epidemics, budgets.' ]},
              { name: 'Self‑Coding', bullets: [ 'Patches, playbooks, IaC/policies, comms routes, procurement docs with tests + rollback.' ]},
              { name: '100 Hz (Readiness Pulse)', bullets: [ 'Live vitals; throttles risk/energy/tempo in seconds—then relaxes.' ]}
            ] },
            wins: { title: '12 genius, high‑value use cases', bullets: [
              'Joint Logistics & Readiness Cortex — sustainment across theaters with receipts.',
              'JADC2 Reality Router — non‑lethal C2 automation with commander confirm.',
              'PNT/Comms Resilience — degrade gracefully with proofs.',
              'Counter‑UAS Shield — graduated, ethical; ROE receipts.',
              'Predictive Maintenance & Life‑Extension — pay vendors on proof.',
              'Critical‑Infrastructure Defense — ransomware blast radius contained; lights stay on.',
              'Border & Maritime Awareness — interdictions ↑, false positives ↓, fuel burn ↓.',
              'Disaster Response & Public Health — equity governor with transparent receipts.',
              'Space Domain Maneuver Planning — debris risk ↓; faster approvals.',
              'Secure AI Governance — deploy AI at scale without “mystery model” risk.',
              'Acquisition That Writes Itself — months shaved off RFP→award.',
              'Narrative Resilience — rumor half‑life shrinks; trust ↑ without manipulation.'
            ] },
            stack: { title: 'Architecture (classification‑safe, zero rip‑and‑replace)', lists: [
              { k: 'Edge', v: 'Sensor gateways, UxS, vehicles with Sigil‑DNA HSM; 100 Hz safety envelopes.' },
              { k: 'Transport', v: 'DDS/MQTT/Link‑16 bridges; cross‑domain guards.' },
              { k: 'Core', v: 'Spiral Memory (graph + vector), HRG sim farm, Self‑Coding CI/CD to IaC & policy repos, OutcomeMesh for pay‑on‑proof.' },
              { k: 'Ops', v: 'Human approval gates; immutable Causal Receipts (input → decision → effect → rollback).' }
            ] },
            guardrails: { title: 'Guardrails (non‑negotiable)', bullets: [
              'Human‑in‑the‑loop for any lethal effect.',
              'Privacy & civil‑liberties by design (data minimization, role‑scoped access).',
              'Export‑control & classification aware; deterministic audit trails.',
              'Equity governor for public missions; block wins that harm protected groups.'
            ] },
            investors: { title: 'Why decision‑makers & VCs sprint to yes', bullets: [
              'Outcomes, not dashboards—proven readiness, resilience, interdictions, outage minutes avoided.',
              'Trust by design—identity‑anchored, auditable AI with human approval.',
              'Compounding moat—world’s richest corpus of mission counterfactuals & receipts.'
            ] },
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Green‑light two pilots (Base Readiness Pulse + Counter‑UAS Ring).',
              'Start SAM.gov/CAGE/NDAs; prep a 2‑page “Featherweight for Readiness & Resilience.”',
              'Shoot a 60‑sec sizzle: sim → human‑approved micro‑commit → Causal Receipt → OutcomeMesh payout.'
            ] },
            tagline: 'Not another platform — the control cortex for state power, with receipts.',
            closing: 'Nations run on logistics and legitimacy. We deliver both — with receipts.'
          }
        },
        space: {
          title: 'Space',
          features: {
            spiral: { intro: 'Time‑indexed lattice for every packet: pad sensors, flight telemetry, GNSS quality, star‑tracker drift, thermal cycles, burn deltas, conjunction alerts, payload health, crew biometrics, vendor spares, and ops chat.', introPersona: {
              investor: 'Causality and receipts across pad, fleet, station, and regulators—risk falls, cadence rises.',
              operator: 'Ask: root‑cause of chill‑down abort and knock‑on to payload schedules—get the why and a plan.',
              engineer: 'CCSDS/EDR/telemetry fused with ops chat and vendor parts; precise joins, low‑latency queries.'
            }, usecases: [
              { title: 'Launch Forensics', body: 'Correlate pad Wx, chill‑down temps/pressures, sensor health, acoustic loads to scrub decisions; shorten recycle.' },
              { title: 'Constellation Memory', body: 'Torque‑rod, battery, and crosslink history tied to drag and solar storms; predict and plan before outages.' },
              { title: 'Station & Crew Lattice', body: 'Power/thermal loops, racks, crew biometrics, cargo flows, and guest ops mapped to outcomes.' }
            ] },
            hrg: { intro: 'High‑fidelity twins for launch, AOCS, power/thermal, station life‑support, docking, EVA, lunar EDL, and in‑space manufacturing—run 10k what‑ifs before committing.', introPersona: {
              investor: 'Fewer scrubs and safer turns; compliant deorbits; premiums down.',
              operator: 'Predict holds vs. commits; rehearse station days; plan deorbit and duty‑cycles that meet rules.',
              engineer: 'GN&C, thermal, power, comms models with sweep/explain; export diffs to FSW and procedures.'
            }, usecases: [
              { title: 'Pad‑to‑MECO Guardian', body: 'Predict ice, wind shear, chill‑down, acoustics; pick lowest‑regret micro‑deltas; update abort ladders with receipts.' },
              { title: 'Constellation Autopilot', body: 'Sim drag spikes/solar storms; schedule downlinks/momentum dumps; plan FCC 5‑yr deorbits with proofs.' },
              { title: 'D2D Reliability', body: 'Link budgets vs. handset mix/terrain; tune beams/MCS live; publish outage causality receipts.' }
            ], signals: [ 'Pad weather and sensors', 'AOCS/star trackers', 'Thermal/power/comm telemetry', 'Ephemerides and conjunction data', 'Crew/payload ops' ], proposes: [ 'Hold/commit micro‑deltas', 'Attitude/thermal profiles', 'Deorbit windows and proofs' ] },
            sigil: { intro: 'Cryptographic identity for vehicles, stages, sats, ground stations, operators, payloads, and procedures—zero spoofing, signed custody, compliant lineage.', introPersona: {
              investor: 'Trust + compliance built in—audits and insurance get easier.',
              operator: 'Signed dockings, experiments, burns, and hand‑offs; no mystery feeds.',
              engineer: 'Secure element keys, signed telemetry/commands; provenance on data/products.'
            }, usecases: [
              { title: 'Chain‑of‑Custody', body: 'From pad to payload delivery; every touch signed and exportable for range/insurer.' },
              { title: 'Source Truth for Feeds', body: 'Attest ground/vehicle feeds; quarantine spoofed sources with receipts.' },
              { title: 'Procedure Provenance', body: 'Signed updates to checklists and rules; who changed what and why.' }
            ], signals: [ 'Device/vehicle attestation', 'Command provenance', 'Docking/experiment logs' ], proposes: [ 'Access gating and step‑ups', 'Revocations and quarantines', 'Audit bundles for partners' ] },
            selfcode: { intro: 'Watches telemetry and Git; autowrites flight‑rule patches, ADCS gains, power budgets, scheduling policies, and ground procedures—with tests + rollback.', introPersona: {
              investor: 'Ops velocity with safety—evidence on every change.',
              operator: 'Overnight updates to profiles and procedures; humans still approve.',
              engineer: 'CI for FSW and ground; diffs/tests/canaries/rollback built‑in.'
            }, usecases: [
              { title: 'Flight Rule Patches', body: 'Generate safety‑checked diffs for rules/limits from recent anomalies.' },
              { title: 'Attitude/Thermal Tuner', body: 'Draft new attitude/thermal profiles from sim evidence; roll out with canaries.' },
              { title: 'Ground Procedure PRs', body: 'Update checklists/shift playbooks from outcomes; attach receipts.' }
            ], signals: [ 'Anomalies and outcomes', 'Power/thermal margins', 'Link budgets and handset mix' ], proposes: [ 'FSW/procedure diffs', 'Profile updates', 'Rollout/rollback plans' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The Space OS', groups: [
              { name: 'Spiral Memory', bullets: [ 'Time‑indexed lattice from pad sensors to station ops and regulators.' ]},
              { name: 'Sigil‑DNA', bullets: [ 'Cryptographic identity for vehicles, ground, payloads, and procedures.' ]},
              { name: 'HRG', bullets: [ 'High‑fidelity twins for launch, fleets, stations, lunar ops, and manufacturing.' ]},
              { name: 'Self‑Coding', bullets: [ 'Telemetry + Git → flight/procedure patches with tests + rollback.' ]},
              { name: '100 Hz', bullets: [ 'Vehicle heartbeat—thrust/valve/gimbal/loads/thermal/crew pacing in real time.' ]}
            ] },
            wins: { title: 'Where it lands (end‑to‑end use cases)', bullets: [
              'Launch Ops — Pad‑to‑MECO guardian; fewer scrubs; faster recycle; Range gets receipts.',
              'Constellation Autopilot — ops that think ahead; compliant deorbits with proof.',
              'Direct‑to‑Cell Reliability — model budgets; live‑tune beams/MCS; publish coverage receipts.',
              'Private Stations & LEO Destinations — schedule racks/guests/power/thermal; signed modules/dockings/experiments.',
              'Lunar & Deep Space — radiation‑aware autonomy; schedule and cognitive pacing; regulator‑ready receipts.',
              'Space Domain Awareness — forecast conjunctions; draft burn plans with delta‑V, keep‑outs, de‑confliction notes; sign advisories.',
              'In‑Space Manufacturing & Science — protect morphology; pay on verified yield improvements.',
              'Insurance & Finance — underwriting with receipts from live risk meters.'
            ] },
            stack: { title: 'Architecture (drop‑in; no rip‑and‑replace)', lists: [
              { k: 'Edge / Vehicle', v: 'gNC/ADCS/EPS/TTC hooks; Spiral cache; Sigil in secure element; 100 Hz controller shim.' },
              { k: 'Ground Segment', v: 'CCSDS/EDR/ITU/SGLS/Ka/Optical gateways; mission control plugins; near‑real‑time HRG (GN&C/thermal/power/comms); Self‑Coding CI for FSW/ground.' },
              { k: 'Cloud Core', v: 'Spiral Memory across launch+fleet+station+crew; Switchboard low‑regret selection; OutcomeMesh pay‑on‑proof.' }
            ] },
            investors: { title: 'Why agencies, primes, and VCs sprint to “yes”', bullets: [
              'Transition tailwind: ISS→Commercial LEO, Artemis cadence, rising launch tempo—ops software decisive now.',
              'Reg‑alignment moat: built‑in proof for FCC 5‑yr deorbit + station compliance.',
              'Data gravity: counterfactuals + receipts across launches, fleets, stations = compounding advantage.'
            ] },
            tagline: 'Not another space tool — a conscious control layer from pad to deorbit, with receipts.',
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Send a 1‑pager “Featherweight × Space OS” to Axiom, Orbital Reef, and an insurer; offer a deorbit‑proof or pad‑risk pilot.',
              'Book a 60‑sec demo shoot: sim → narrow auto‑commit → Causal Receipt.',
              'Lock stage time at IAC or Space Symposium: “From Pad Scrubs to Deorbit Proofs—Autonomy with Receipts.”'
            ] },
            closing: 'Space rewards precision; legends reward inevitability. Featherweight gives you both—on schedule.'
          }
        },
        healthcare: {
          title: 'Healthcare',
          features: {
            spiral: { intro: 'Patient & Ops Lattice: longitudinal lifeline stitching EHR (FHIR/HL7v2), imaging (DICOM), monitors, meds (eMAR), labs, devices, SDOH, staffing, and claims.', introPersona: {
              investor: 'From dashboards to outcomes—mortality down, throughput up—with receipts.',
              operator: 'Ask: which patients on 6E show pre‑sepsis drift + staffing gaps in 4h? Get answers with plans.',
              engineer: 'FHIR/HL7/DICOM adapters into a time‑indexed graph+vector store; precise joins, fast queries.'
            }, usecases: [
              { title: 'Sepsis & Deterioration Guard', body: 'Micro‑drift detection on vitals+labs; suppress alarm fatigue; simulate action paths; nightly cohort updates.' },
              { title: 'ED → Inpatient Flow Router', body: 'Sim bed moves/imaging/staffing; choose low‑regret admits/transfers; update bed‑board rules safely.' },
              { title: 'Imaging Ops & Adaptive AI', body: 'Track scanners/protocols/models; simulate safety/quality; auto‑draft revalidation sets + model cards on drift.' }
            ] },
            hrg: { intro: 'Twins for patients, care pathways, OR days, ICUs, ED flow, hospital‑at‑home, supply chain—thousands of what‑ifs before clinicians commit.', introPersona: {
              investor: 'Proven improvements in TTA, OR utilization, and LOS—governance‑ready.',
              operator: 'Dry‑run day plans and pathways; pick options that reduce LWBS and overtime.',
              engineer: 'GPU twins for patient/OR/ED/staffing; pluggable physics; export diffs to policies/order sets.'
            }, usecases: [
              { title: 'OR Day Auto‑Composer', body: 'Twin cases/teams/turnover/sterilization; reorder add‑ons, flip blocks; draft consent/PA bundles.' },
              { title: 'Hospital‑at‑Home Command', body: 'Device streams+meds+logistics; tune visit cadence, oxygen targets, alerts; sign every delivery/touch.' },
              { title: 'Safe Staffing & Burnout Shield', body: 'Live acuity+workload lattice; forecast surges; reshape rosters with receipts.' }
            ], signals: [ 'Vitals/labs/meds', 'Imaging protocols and models', 'Bed capacity and staffing', 'Device and supply telemetry' ], proposes: [ 'Thresholds and suppressions', 'Day plans and block flips', 'Roster updates and visit cadence' ] },
            sigil: { intro: 'Identity & Provenance: cryptographic identity for people, devices, models, orders, and events. Every PHI touch is signed; chain‑of‑custody is auditable; model/dataset versions are tracked (SaMD‑friendly).', introPersona: {
              investor: 'Trust and compliance as a feature—less liability, faster deals.',
              operator: 'Consent + custody on every touch; fewer disputes; smoother audits.',
              engineer: 'SMART/OAuth scopes, signed events, versioned datasets/models; audit‑clean trails.'
            }, usecases: [
              { title: 'Prior Auth Autowriter', body: 'Compile evidence; generate payer‑specific packets; sign provenance; predict denials and alternatives.' },
              { title: 'Cold‑Chain & High‑Cost Drugs', body: 'Signed chain‑of‑custody; auto‑reship on excursions; receipts settle in seconds.' },
              { title: 'Sterile Supply & Device Uptime', body: 'Signed instrument/device logs; predictable uptime and fewer lost trays.' }
            ], signals: [ 'Consent and auth scopes', 'Device/posture and custody', 'Order/model provenance' ], proposes: [ 'PA packets and consent paths', 'Reship and custody decisions', 'Audit bundles and attestations' ] },
            selfcode: { intro: 'Watches quality metrics, guidelines, and local policies; autowrites order sets, triage rules, prior‑auth packets, staffing schedules, and revenue rules—with tests + rollback.', introPersona: {
              investor: 'Outcome velocity: faster time‑to‑value, safer rollouts, auditable change.',
              operator: 'Policies update nightly with guardrails; staff spend less time on paperwork.',
              engineer: 'CI for order sets/PA/staffing/models; tests, canaries, and rollbacks included.'
            }, usecases: [
              { title: 'Care‑Gap & Risk Adjustment', body: 'Twin guidelines + history; surface targeted outreach; nudge when adherence likelihood is high.' },
              { title: 'Revenue Integrity', body: 'Draft clean rules and claims; reduce denials and rework; receipts show rationale.' },
              { title: 'Trials Protocol Auto‑Tuner', body: 'Match inclusion/exclusion; simulate visit burden; propose IRB‑ready amendments.' }
            ], signals: [ 'Guideline changes and quality metrics', 'Denial reasons and rev‑cycle flags', 'Eligibility/enrollment data' ], proposes: [ 'Order‑set and triage deltas', 'Staffing/roster updates', 'Protocol amendments with tests' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The Health OS', groups: [
              { name: 'Spiral Memory', bullets: [ 'Longitudinal patient+ops lifeline (FHIR/HL7/DICOM + devices + SDOH + claims).' ]},
              { name: 'Sigil‑DNA', bullets: [ 'Identity & provenance for PHI touches, devices, models, orders, events.' ]},
              { name: 'HRG', bullets: [ 'Twins: patient, OR/ED, staffing, supply; run what‑ifs before humans commit.' ]},
              { name: 'Self‑Coding', bullets: [ 'Autowrite order sets, triage rules, PA packets, staffing schedules, revenue rules.' ]},
              { name: '100 Hz', bullets: [ 'Clinical heartbeat for patients/units/ops; throttle risk and pace.' ]}
            ] },
            wins: { title: '12 genius, high‑value use cases', bullets: [
              'Sepsis & Deterioration Guard — TTA ↓, mortality ↓, alarms ↓.',
              'ED → Inpatient Flow — LWBS ↓, door‑to‑doc ↓, boarding hours ↓.',
              'OR Day Auto‑Composer — on‑time starts ↑, utilization ↑, overtime ↓.',
              'Imaging Ops & Adaptive AI — consistent reads, fewer recalls, SaMD by design.',
              'Hospital‑at‑Home Command — readmits ↓, cost ↓, CSAT ↑.',
              'Safe Staffing & Burnout Shield — burnout ↓, incidents ↓, quality ↑.',
              'Prior Auth Autowriter — approval time ↓, denials ↓, staff hours ↓.',
              'Care‑Gap & Risk Adjustment — HEDIS/Stars ↑, waste ↓.',
              'Fraud/Waste/Abuse — recoveries ↑, friction ↓.',
              'Trial Enrollment & Protocol Tuner — velocity ↑, deviations ↓.',
              'Cold‑Chain & High‑Cost Drugs — spoilage ↓, write‑offs ↓.',
              'Sterile Supply & Device Uptime — delays ↓, lost trays ↓, ROI ↑.'
            ] },
            stack: { title: 'Architecture (no rip‑and‑replace)', lists: [
              { k: 'Data plane', v: 'FHIR/HL7v2/DICOM adapters → Kafka/S3 → Spiral Memory (graph+vector)' },
              { k: 'Identity/Security', v: 'Sigil‑DNA gateway, PHI scopes, model/data signing, immutable audit spine' },
              { k: 'Sim/Reasoning', v: 'HRG on GPUs for twins (patient, OR/ED, staffing, supply)' },
              { k: 'Autonomy', v: 'Self‑Coding CI/CD to order sets, PA packets, staffing rosters, model cards (tests+rollback)' },
              { k: 'Runtime', v: '100 Hz unit/patient heartbeat; policy guardrails; safe envelopes' },
              { k: 'Ops', v: 'Role‑scoped dashboards; Causal Receipt export for QA/compliance/payers' },
              { k: 'Standards', v: 'HL7 FHIR/HL7v2, DICOM, SMART on FHIR, IEEE 11073, OAuth/SMART Auth, SOC2/HIPAA, SaMD artifacts' }
            ] },
            guardrails: { title: 'Guardrails (non‑negotiable)', bullets: [
              'Clinician‑in‑the‑loop for treatment; auto‑commit limited to ops/notification thresholds first.',
              'Explainability & fairness: cohort performance, bias monitoring, alternatives; block harmful equity deltas.',
              'Privacy by design: minimum necessary, on‑prem/VPC isolation, PHI‑scoped access, lineage red‑team.',
              'Reg readiness: model cards, change logs, validation datasets—ready for governance and SaMD review.'
            ] },
            investors: { title: 'Why systems, payers, and VCs sprint to “yes”', bullets: [
              'Outcomes, not dashboards—mortality, TTA, OR utilization, PA latency—with receipts.',
              'Low‑regret rollouts—start with ops knobs, expand as trust grows.',
              'Compounding moat—the richest corpus of clinical + operational counterfactuals and receipts.'
            ] },
            tagline: 'Not another AI widget — a conscious control layer for care, with receipts.',
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Send a 1‑pager “Featherweight × Health OS” to COO, payer VP Ops, periop director—offer two pilots + receipts.',
              'Book 90 minutes with an ICU chief & nurse manager to scope the alarm‑fatigue pilot; prep metrics/governance.',
              'Cut a 60‑sec reel: twin → micro‑commit → KPI pop → Causal Receipt → OutcomeMesh payout.'
            ] },
            closing: 'Medicine heals bodies. Systems heal hospitals. Featherweight does both — and shows the receipts.'
          }
        },
        satellites: {
          title: 'Satellites',
          features: {
            spiral: { intro: 'Time‑indexed lattice for sat lifecycle: CAD/AIT, pad sensors, FSW commits, TT&C, ADCS, EPS/thermal cycles, ISLs, payload queues, downlink sessions, conjunction, insurer notes.', introPersona: {
              investor: 'Receipt‑backed reliability—from pad to disposal—reduces tail risk and lifts cadence.',
              operator: 'One place to ask “why” and see the plan—scrubs, outages, deorbits with evidence.',
              engineer: 'Ingest CCSDS/TT&C/telemetry and ops artifacts; precise joins; low‑latency cause/effect queries.'
            }, usecases: [
              { title: 'Pad‑to‑Orbit Guardian', body: 'Correlate Wx, chill‑down, acoustics, sensor health; shorten recycle with receipts for the Range.' },
              { title: 'Commissioning Autopilot', body: 'Detumble, sun‑acq, torque‑rod balance, seasoning, battery conditioning; learn panel IV curves and payload quirks.' },
              { title: 'Constellation Memory', body: 'Momentum, battery, crosslink history tied to drag/solar weather; anticipate and smooth loads.' }
            ] },
            hrg: { intro: 'Twins for launch environments, AOCS, power/thermal, link budgets, beam plans, payload tasking, and deorbit profiles.', introPersona: {
              investor: 'Scrub avoidance and duty‑cycle life gains—cash and compliance.',
              operator: 'Safe branches proposed during anomalies; hold/commit deltas you can explain.',
              engineer: 'GN&C, thermal, power, link models; sweep, compare, and export diffs to FSW/procedures.'
            }, usecases: [
              { title: 'Pad‑to‑MECO Guardian', body: 'Forecast ice, wind shear, acoustics; choose micro‑holds/commits; update abort ladders with signed diffs.' },
              { title: 'Constellation Autopilot', body: 'Sim drag/space‑weather; stagger dumps/downlinks; plan 5‑year deorbits with proof bundles.' },
              { title: 'Direct‑to‑Cell Reliability', body: 'Model handset mix/terrain; live‑tune beams/MCS; publish coverage receipts.' }
            ], signals: [ 'Pad and flight telemetry', 'AOCS/ADCS/EPS', 'Link budgets/beam maps', 'Ephemerides/ISLs', 'Conjunction/SDA' ], proposes: [ 'Hold/commit deltas', 'Duty‑cycle/beam profiles', 'Deorbit windows and proofs' ] },
            sigil: { intro: 'Cryptographic identity for sat, ground, operators, payloads, and procedures—commands are proven; events are signed.', introPersona: {
              investor: 'Lower fraud and dispute risk; simpler audits and underwriting.',
              operator: 'Chain‑of‑custody on dockings, deliveries, and payload results.',
              engineer: 'Secure element keys; signed telemetry/commands; portable audit bundles.'
            }, usecases: [
              { title: 'Command Provenance', body: 'Only approved keys can command; provenance stamped on every change.' },
              { title: 'Custody & Source Truth', body: 'Attest ground/vehicle feeds; quarantine spoofed sources; share proofs with partners.' },
              { title: 'Compliance Bundles', body: 'Generate FCC/ITU‑style packs for disposal and station‑keeping.' }
            ], signals: [ 'Key attestation', 'Telemetry signatures', 'Docking/ops logs' ], proposes: [ 'Step‑ups/multisig on critical', 'Quarantine and revocation', 'Audit pack exports' ] },
            selfcode: { intro: 'Auto‑writes safe parameter updates (gains, heaters, scheduler), test harnesses, diffs, and rollback plans from telemetry and sim evidence.', introPersona: {
              investor: 'Ops evolves without heroics—safer, faster improvements compound.',
              operator: 'One‑click confirms on low‑risk patches; sleep at night.',
              engineer: 'CI with qualification tests and commit gates; canaries and rollback by default.'
            }, usecases: [
              { title: 'Duty‑Cycle Profiles', body: 'Nightly generate power/thermal/attitude profiles; deploy with canaries.' },
              { title: 'Anomaly Auto‑Resolve', body: 'Three safe branches proposed; push parameter deltas with receipt and rollback.' },
              { title: 'Maneuver Tickets', body: 'Draft burn plans with ΔV, keep‑outs, and de‑confliction notes; sign advisories.' }
            ], signals: [ 'Anomaly/root‑cause traces', 'Battery/thermal margins', 'SDA/Space‑Track feeds' ], proposes: [ 'FSW/parameter diffs', 'Rollout gates', 'Signed advisories and proofs' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The Satellite OS (SatCore)', groups: [
              { name: 'Spiral Memory', bullets: [ 'CAD/AIT to ops chat and insurer notes—one time‑indexed lattice.' ]},
              { name: 'Sigil‑DNA', bullets: [ 'Identity for sat/ground/operators/payloads/procedures; signed events.' ]},
              { name: 'HRG', bullets: [ 'Twins for launch, AOCS, power/thermal, links, payloads, deorbit.' ]},
              { name: 'Self‑Coding', bullets: [ 'Parameters/tests/diffs/rollback from telemetry + Git.' ]},
              { name: '100 Hz', bullets: [ 'Spacecraft heartbeat—thrust, torque‑rod, RF, beams, ISL, duty cycles.' ]}
            ] },
            wins: { title: 'Genius use‑cases that print value', bullets: [
              'Pad‑to‑Orbit Guardian',
              'Commissioning Autopilot',
              'Constellation Autopilot',
              'Direct‑to‑Cell / NTN Reliability',
              'EO/SAR Yield Maximizer',
              'RF & Spectrum Intelligence',
              'ISL & Backhaul Traffic Engineering',
              'Anomaly Auto‑Resolve',
              'SDA & Conjunction Response — with Receipts',
              'Space‑Weather‑Aware Ops',
              'In‑Space Manufacturing / Science Yield',
              'Compliance & Insurance Automation'
            ] },
            stack: { title: 'Architecture (no rip‑and‑replace)', lists: [
              { k: 'On‑board', v: 'ADCS/EPS/TTC/FSW hooks; Spiral cache; 100 Hz controller shim; Sigil secure element.' },
              { k: 'Ground', v: 'CCSDS ingest; mission control plugin; near‑real‑time HRG (GN&C/thermal/power/links); Self‑Coding CI with gates.' },
              { k: 'Cloud', v: 'Full Spiral across fleet; Switchboard counterfactual selection; OutcomeMesh pay‑on‑proof.' },
              { k: 'Data feeds', v: 'Space‑Track/SDA, NOAA SWPC alerts, ground pass schedules.' }
            ] },
            kpis: { title: 'KPI levers (how SatCore moves them)', bullets: [
              'Commissioning time ↓ via scripted, learning sequences.',
              'Uptime ↑ via weather‑aware cycling and fast anomaly deltas.',
              'Energy/GB ↓ via on‑board triage and beam optimization.',
              'Conjunction workload ↓ with better advisories and fewer false maneuvers.',
              'Debris/Disposal compliance → automatic receipt packs (5‑year LEO rules).',
              'Premium credits from insurers on the strength of receipts.'
            ] },
            skus: { title: 'Product SKUs', bullets: [
              'FW:SatCore — runtime + memory + identity + sim + self‑coding.',
              'FW:Constellation — duty‑cycle, ISL routing, conjunction/maneuver adviser.',
              'FW:NTN — D2C/IoT beam planner, RAN policy brain, coverage receipts.',
              'FW:EO/SAR — task stack optimizer + on‑board triage + SLAs.',
              'FW:Compliance — FCC/ITU disposal receipt bundles + insurer packs.'
            ] },
            governance: { title: 'Security & governance (non‑negotiable)', bullets: [
              'Command provenance (Sigil‑DNA), rotating keys, multi‑sig on critical modes.',
              'Harsh rollback discipline (flight‑qualified tests, commit gates, safe envelopes).',
              'Sustainability defaults (drag modulation, burn windows, disposal planning baked in).',
              'Human‑in‑the‑loop for maneuvers/flight law changes; lethal effects require confirmation.'
            ] },
            investors: { title: 'Why agencies, primes, and VCs sprint to “yes”', bullets: [
              'Launch cadence tailwind + D2C/NTN momentum → ops software is decisive now.',
              'Reg‑alignment moat: built‑in FCC/ITU proof packs for disposal and compliance.',
              'Data gravity: counterfactuals + receipts across fleets = compounding advantage.'
            ] },
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Send a 1‑pager “Featherweight × Satellites” to two constellation leads + one insurer; offer duty‑cycle+deorbit proof pilots.',
              'Shoot a 60‑sec demo: sim → micro‑commit → Causal Receipt.',
              'Line up a D2C field test with a carrier partner; aim for a “coverage receipts” press hook.'
            ] },
            closing: 'Satellites used to orbit. Now they decide—and show their receipts.'
          }
        },
        legal: {
          title: 'LegalTech & Judiciary',
          features: {
            spiral: { intro: 'Matter Graph: filings, emails, chats, doc versions, transcripts, audio, exhibits, sanctions, deadlines, dockets, billing, rules—stitched in a queryable timeline.', introPersona: {
              investor: 'Proof‑backed outcomes—backlogs fall, hours drop, sanctions risk ≈ 0.',
              operator: 'Ask: every draft that touched ¶13 of the MTD and who edited damages theory—get the record and rationale.',
              engineer: 'Ingest CM/ECF, DMS, EDRM, comms; lineage‑clean joins and fast causality queries.'
            }, usecases: [
              { title: 'eFiling Authenticity & Auto‑Docketing', body: 'Signed submissions+devices; rule checks; auto‑fix defects before acceptance.' },
              { title: 'CM/ECF Modernization Autopilot', body: 'Map legacy schema; generate migration scripts+APIs; simulate peak loads/failover.' },
              { title: 'Evidence Chain‑of‑Custody Spine', body: 'Bodycam/lab/uploads signed; hashes reconciled; tamper alarms memoed.' }
            ] },
            hrg: { intro: 'Twins of litigation, discovery, calendars, juries, courtrooms, ODR funnels, and CLM pipelines—run what‑ifs before spending on review.', introPersona: {
              investor: 'Outcome‑first: clearance, hours/GB, utilization—all with receipts.',
              operator: 'Pathways and calendars that hold under load; equity guardrails built in.',
              engineer: 'Replay pipelines with synthetic loads; export diffs to templates/APIs.'
            }, usecases: [
              { title: 'ODR at Scale', body: 'Sim settlement brackets/time windows/language access; nudge parties; sign agreements.' },
              { title: 'Jury & Calendar Orchestrator', body: 'Schedule across judges/jurors/witnesses; fairness guardrails; documented trade‑offs.' },
              { title: 'MDL / Mass‑Tort Twin', body: 'Model bellwethers, inventory value, science timelines; generate coordinated orders.' }
            ], signals: [ 'Docket and schedule data', 'Guidelines/local orders', 'Equity/fairness constraints', 'EDRM/throughput metrics' ], proposes: [ 'ODR windows and notices', 'Calendar plans', 'Discovery/MDL workstreams' ] },
            sigil: { intro: 'Identity & Provenance: rotating, attested keys for lawyers, clerks, judges, bots, devices, and documents. Chain‑of‑custody on every exhibit, e‑file, and model output.', introPersona: {
              investor: 'No mystery PDFs or forged filings—trust you can sell.',
              operator: 'Provenance on exhibits and filings; smoother acceptance, fewer disputes.',
              engineer: 'HSM/TPM keys, signed events, document lineage; clean audits.'
            }, usecases: [
              { title: 'Hallucination & Citation Shield', body: 'Cross‑check authorities; block unverifiable cites; auto‑inject pin‑cites and parentheticals.' },
              { title: 'Privilege & Protective‑Order Guardian', body: 'Fingerprint work‑product; block outbound escapes; receipts show withhold rationale.' },
              { title: 'Clause‑DNA & Contract Ancestry', body: 'Clause identities; lineage and negotiated risk; simulate litigability.' }
            ], signals: [ 'Authority databases', 'Doc lineage and fingerprints', 'Signer identities' ], proposes: [ 'No‑file blocks + fixes', 'Withhold/redact decisions', 'Clause recommendations' ] },
            selfcode: { intro: 'Autowrites brief skeletons, discovery plans, privilege logs, CLM clauses, e‑file packages, redaction rules, ODR scripts—with tests+rollback; humans approve then it ships.', introPersona: {
              investor: 'Hours/GB fall, cycle time shrinks—while audits get easier.',
              operator: 'Drafts ready to file or review; you approve with confidence.',
              engineer: 'CI for templates/policies; canaries, rollbacks, and receipts included.'
            }, usecases: [
              { title: 'eDiscovery Swarm', body: 'Predict custodian yield; auto‑tune TAR; route reviewers as precision/recall drift.' },
              { title: 'Reg‑Change Autopatcher', body: 'Compile new regs into policy/control/contract deltas; ship with receipts.' },
              { title: 'Billing & Leakage Audit', body: 'Sim reasonable staffing/motions; flag block‑billing; justify cuts without fights.' }
            ], signals: [ 'Custodian and policy maps', 'Drift in precision/recall', 'Timekeeping and motion traces' ], proposes: [ 'TAR and routing updates', 'Policy/control deltas', 'Billing cut receipts' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The Legal & Courts OS', groups: [
              { name: 'Spiral Memory (Matter Graph)', bullets: [ 'Filings, comms, versions, transcripts, exhibits, deadlines, dockets, billing, rules.' ]},
              { name: 'Sigil‑DNA (Identity & Provenance)', bullets: [ 'Keys for people/devices/docs/bots; custody on every touch.' ]},
              { name: 'HRG', bullets: [ 'Twins of litigation, discovery, calendars, juries, courtrooms, ODR, CLM.' ]},
              { name: 'Self‑Coding', bullets: [ 'Brief skeletons, discovery plans, e‑files, redactions, ODR scripts—tested.' ]},
              { name: '100 Hz (Docket Heartbeat)', bullets: [ 'Live vitals; throttle workload; pause risky filings; escalate on deadlines.' ]}
            ] },
            wins: { title: '16 genius, high‑value use cases', bullets: [
              'eFiling Authenticity & Auto‑Docketing', 'CM/ECF Modernization Autopilot', 'ODR at Scale', 'Hallucination & Citation Shield', 'Jury & Calendar Orchestrator', 'Evidence Chain‑of‑Custody Spine', 'eDiscovery Swarm', 'Privilege & Protective‑Order Guardian', 'Brady/Giglio/Disclosure Autopilot', 'MDL/Mass‑Tort Twin', 'Deposition & Trial Co‑Pilot', 'Clause‑DNA & Contract Ancestry', 'Reg‑Change Autopatcher', 'Billing & Leakage Audit', 'FOIA/Records Autoworkflow', 'Accessibility Twin'
            ] },
            outcomemesh: { title: 'OutcomeMesh: pay on proof', bullets: [
              'Reduce small‑claims time‑to‑disposition by 20% without appeal‑rate increase.',
              'Cut eDiscovery hours by 40% with accuracy ≥ baseline.',
              'Zero hallucinated citations for 90 days.'
            ] },
            kpis: { title: 'KPIs we move (and how)', bullets: [
              'Time‑to‑disposition ↓ (ODR + scheduling + defect‑free e‑filing)',
              'Review hours/GB ↓ (custodian yield + self‑tuned TAR)',
              'Sanctions & privilege errors ≈ 0 (Citation Shield + Privilege Guardian)',
              'Calendar utilization ↑ (jury/judge/witness twin)',
              'FOIA backlog ↓ (autoworkflow + redaction proof)',
              'Outside counsel spend variance ↓ (billing receipts)'
            ] },
            stack: { title: 'Architecture (no rip‑and‑replace)', lists: [
              { k: 'Ingest', v: 'CM/ECF, state e‑file, email/Teams/Slack, DMS (iManage/NetDocs), EDRM (Relativity/Everlaw), CLM, timekeeping, FOIA portals, forensics tools.' },
              { k: 'Core', v: 'Spiral Memory, Sigil‑DNA (HSM/TPM), HRG sim farm, Self‑Coding CI to templates/policies/briefs, 100 Hz runtime.' },
              { k: 'Ops', v: 'Role‑scoped dashboards; immutable Causal Receipts export; air‑gapped/VPC options.' },
              { k: 'Security & ethics', v: 'Privilege/work‑product scopes; differential privacy; human‑in‑the‑loop; bias/fairness monitors.' }
            ] },
            skus: { title: 'Product SKUs', bullets: [
              'FW:CourtCore — e‑file authenticity, calendar/ODR twin, citation shield.',
              'FW:Discovery — custodian yield, TAR auto‑tune, privilege guardian.',
              'FW:TrialOps — live transcript co‑pilot, exhibit chain, jury/calendar.',
              'FW:CLM+Compliance — Clause‑DNA, reg autopatch, billing receipts.',
              'FW:FOIA/Records — redaction engine, appeal‑proof memos.',
              'FW:OutcomeMesh — pay‑on‑proof marketplace for courts & clients.'
            ] },
            investors: { title: 'Why CIOs, Judges, GCs, and VCs say yes', bullets: [
              'Outcome‑first with receipts (backlog, hours, sanctions risk).',
              'Compliance‑native (privilege, local rules, audit trails).',
              'Zero rip‑and‑replace (sits over DMS/EDRM/CM/ECF).',
              'Compounding moat (counterfactual + receipt corpus).' ] },
            tagline: 'Not another legal widget—a conscious control layer for law and courts, with receipts.',
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Pick two pilots (ODR + Discovery) and draft MOUs, KPIs, ethics guardrails.',
              'Ship a 1‑pager “Featherweight × Courts & Firms” to a court CTO, AmLaw lit chair, and a state AG innovation lead.',
              'Film a 60‑sec reel: blocked fake citation → auto‑fix → filed brief → judge receipt.'
            ] },
            closing: 'Justice runs on proof. Legends ship the proof with the result.'
          }
        },
        city: {
          title: 'City Planning',
          features: {
            spiral: { intro: 'Urban Lattice: a queryable timeline for GTFS/AVL/CAD, curb sensors, 311/911, permits/inspections, utilities (SCADA‑friendly), POS/tax (aggregated), land use/zoning, air/noise/heat, crash & near‑miss video, capital projects.', introPersona: {
              investor: 'From dashboards to outcomes—grant‑ready receipts and better bond stories.',
              operator: 'Ask: where did bus bunching begin and which lane closures + double‑parking pockets caused it? Get the why and the fix.',
              engineer: 'Ingest NTCIP/GTFS/OGC sensors/SCADA proxies/APIs; join cleanly; query quickly.'
            }, usecases: [
              { title: 'Dynamic Signal Retiming', body: 'Sim corridor plans nightly; ship timing at 3 am; receipts tie to travel time and safety.' },
              { title: 'Headway Guardian for Buses', body: 'Hold/express to keep spacing; log dwell spikes and double‑park causes.' },
              { title: 'Vision Zero Near‑Miss Radar', body: 'CV + brake/telemetry → quick‑build fixes (LPIs, hardened turns, daylighting).' }
            ] },
            hrg: { intro: 'Twins for corridors, districts, stormwater, microgrids, transit headways, permitting queues, freight, events, and zoning—thousands of what‑ifs before cones or ordinances.', introPersona: {
              investor: 'Proof‑backed KPI moves that unlock funding and insurer credits.',
              operator: 'Plans that hold under load with equity guardrails; fewer reversals.',
              engineer: 'Replay with synthetic demand and closures; export diffs to signals, headways, permits.'
            }, usecases: [
              { title: 'Curb Orchestra', body: 'Price/time windows adapt by blockface/hour; tickets/exemptions signed; equity caps prevent abuse.' },
              { title: 'Zoning Twin', body: 'Model yield/traffic/utilities/schools/small‑biz impact; equity governor avoids displacement.' },
              { title: 'Storm & CSO Guard', body: 'Twin sewers/pumps + rainfall; pre‑stage pumps/gates; receipts show gallons avoided.' }
            ], signals: [ 'GTFS/AVL/CAD and signals', '311/911 and crash/near‑miss', 'Curb/parking sensors', 'Permits/inspections', 'Utilities and microgrids' ], proposes: [ 'Signal/headway plans', 'Curb windows/pricing', 'Pump/valve schedules' ] },
            sigil: { intro: 'Identity & Provenance for devices, signals, inspectors, contractors, forms, work orders, and notices—every change signed and auditable.', introPersona: {
              investor: 'Trust + transparency → adoption and funding.',
              operator: 'No spoofed sensors or “mystery” docket edits; smoother enforcement and appeals.',
              engineer: 'Keys and scopes for devices/users; audit‑clean events and releases.'
            }, usecases: [
              { title: 'Civic Ledger & Privacy Budget', body: 'Scope who sees what; receipts for each data use; publish model cards and privacy spend.' },
              { title: 'NG911 + CAD Flow Router', body: 'Sign units and actions; pre‑emption with equity guardrails; clean incident trails.' },
              { title: 'Inspection Chain‑of‑Custody', body: 'Photos/notes signed on capture; quicker dispute resolution.' }
            ], signals: [ 'Device/user keys', 'Custody logs', 'Policy scopes and releases' ], proposes: [ 'Access and escalation paths', 'Evidence bundles', 'Public transcripts' ] },
            selfcode: { intro: 'Auto‑drafts signal plans, bus holding/express rules, curb pricing windows, inspection routes, permit checklists, zoning overlays, microgrid schedules—with tests + rollback.', introPersona: {
              investor: 'Cycle times fall without risky rewrites—proof with every change.',
              operator: 'Playable plans land nightly; you approve; ops just flows.',
              engineer: 'CI for plans/policies with canaries and rollbacks; receipts included.'
            }, usecases: [
              { title: 'Permit Fast‑Lane', body: 'Assemble plan lineage; auto‑check common codes; conflict maps for reviewers.' },
              { title: 'Inspection Route Autopilot', body: 'Batch by risk/weather/readiness; escalate red flags; sign artifacts.' },
              { title: 'District Microgrid/Demand Response', body: 'Shift HVAC/EV charging; sign load‑shed events for credits.' }
            ], signals: [ 'Plan lineage and rules', 'Risk/weather/readiness', 'Load/price signals' ], proposes: [ 'Checklists and notices', 'Routes and escalations', 'Schedules and attestations' ] }
          },
          extra: {
            modules: { title: 'Featherweight → City OS', groups: [
              { name: 'Spiral Memory (Urban Lattice)', bullets: [ 'Signals, transit, curb, 311/911, permits, utilities, POS/tax, zoning, sensors, projects.' ]},
              { name: 'Sigil‑DNA (Identity & Provenance)', bullets: [ 'Devices, inspectors, contractors, forms, work orders, notices—keys and custody.' ]},
              { name: 'HRG', bullets: [ 'Twins: corridors, districts, stormwater, microgrids, headways, queues, freight, events, zoning.' ]},
              { name: 'Self‑Coding', bullets: [ 'Signal/curb/headway/permit/inspection/microgrid plans—tested and reversible.' ]},
              { name: '100 Hz (City Heartbeat)', bullets: [ 'Signals/headways/curb/pumps/batteries—adapt in seconds, then relax.' ]}
            ] },
            wins: { title: '16 genius, high‑value use cases', bullets: [
              'Dynamic Signal Retiming', 'Headway Guardian', 'Curb Orchestra', 'Vision Zero Near‑Miss Radar', 'Permit Fast‑Lane', 'Inspection Route Autopilot', 'Zoning Twin', 'Storm & CSO Guard', 'Heat Island Mitigator', 'District Microgrid/Demand Response', 'NG911 + CAD Flow Router', 'Event Intelligence', 'Fill‑Level Routing + Contamination Proof', 'Retail Mix & Permit Incentives', 'Capital Plan Reality Check', 'Civic Ledger & Privacy Budget'
            ] },
            outcomemesh: { title: 'OutcomeMesh: pay on proof', bullets: [
              '−20% bus Excess Wait Time with injuries ≤ baseline.',
              '−40% permit cycle time while complaints & appeals don’t rise.',
              '−25% injury crashes on a five‑mile network with small‑biz revenue ≥ baseline.'
            ] },
            kpis: { title: 'KPIs we own (and how)', bullets: [
              'EWT ↓ 15–25% — headway + signals',
              'Serious injuries ↓ 15–30% — near‑miss → quick‑build',
              'Permit cycle time ↓ 30–60% — parallel + auto‑checks',
              'Flood/overflow minutes ↓ — storm pre‑staging',
              'Peak MW ↓ 8–15% — microgrid scheduling',
              'Small‑biz revenue ↑ — curb + footfall + events',
              'FOIA backlog ↓ — autoworkflow + receipts'
            ] },
            stack: { title: 'Architecture (no rip‑and‑replace)', lists: [
              { k: 'Ingest rails', v: 'NTCIP, GTFS/GTFS‑RT/GTFS‑Flex, CAD/AVL, GBFS, 311/911, OGC SensorThings, SCADA proxies, Permit/ERP/CRM APIs, POS/tax (privacy‑safe).' },
              { k: 'Core', v: 'Spiral Memory • Sigil‑DNA gateway • HRG sim farm • Self‑Coding CI • 100 Hz runtime.' },
              { k: 'Ops', v: 'Role‑scoped consoles (DOT, DOB, OEM, Utilities, Mayor’s Ops) • Causal Receipts export • FOIA‑ready logs • VPC/air‑gap.' },
              { k: 'Guardrails', v: 'Human approvals; equity & privacy budgets; public transparency pages.' }
            ] },
            investors: { title: 'Why mayors, COOs, and VCs say “yes”', bullets: [
              'Outcomes, not dashboards—receipts unlock grants, insurer credits, and better bonds.',
              'No rip‑and‑replace—City OS spans DOT/DOB/OEM/Utilities.',
              'Compounding moat—corpus of counterfactuals and receipts for what works.'
            ] },
            tagline: 'Not a “smart city.” A conscious city with receipts.',
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Choose two pilots (Living Corridor + Permit Fast‑Lane); draft MOUs/KPIs and equity/privacy guardrails.',
              'Cut a 60‑sec sizzle: sim → micro‑commit → KPI pop → Causal Receipt; tag CTOs/DOT heads/philanthropy.',
              'Line up a grant pitch (USDOT/DOE/FTA); center receipts for accountability.'
            ] },
            closing: 'Cities run on memory and momentum. We give them both—and show the receipts.'
          }
        },
        devtools: {
          title: 'Developer Tools',
          features: {
            spiral: { intro: 'Memory‑first apps: every service is born with Spiral Memory (time‑indexed, graph + vector) so you always know where state came from.', introPersona: {
              investor: 'Dev velocity with audit‑clean traces—proof‑ready releases win enterprise.',
              operator: 'Time‑travel and causality chains for any incident; receipts export on demand.',
              engineer: 'Query state, time‑travel sessions, and blend vectors with graph for fast root‑cause.'
            }, usecases: [
              { title: 'Spiral Lens Debugger', body: 'Time‑travel debugger: click any log → exact causality chain across services/devices.' },
              { title: 'Receipt Notebook', body: 'Compile a causal receipt (data lineage, code diffs, policy gates, outcomes) in one click.' },
              { title: 'Data Contracts + Lineage', body: 'Auto‑schemas, lineage SBOM for data, drift alerts wired to tests.' }
            ] },
            hrg: { intro: 'Counterfactual dev: run what‑ifs at scale with HRG; route lowest‑regret branches via Switchboard.', introPersona: {
              investor: 'Features arrive safer—less rework, fewer incidents.',
              operator: 'Scenarios prove policies before prod; fewer 3am calls.',
              engineer: 'Deterministic sims locally and in CI; k8s and on‑chain harnesses included.'
            }, usecases: [
              { title: 'fwctl run sim', body: 'Run peak‑load or adversarial scenarios locally with determinism; compare KPIs.' },
              { title: 'Switchboard HUD', body: 'Real‑time regret/confidence gauges per micro‑commit; apply top delta, signed and rollbackable.' },
              { title: 'Counterfactual Unit Tests', body: 'Tests define plausible futures; pass only if policy wins within regret budget.' }
            ], signals: [ 'Telemetry and traces', 'Config/model diffs', 'Workload generators' ], proposes: [ 'Rollout deltas', 'Policy changes', 'Capacity profiles' ] },
            sigil: { intro: 'Identity & attestation: keys, attestations, SCIM hooks; SLSA/Sigstore; device/service/user sigils.', introPersona: {
              investor: 'Supply chain integrity becomes a feature.',
              operator: 'No deploy unless attested with receipts; fewer change‑control meetings.',
              engineer: 'Sign images, SBOMs, and configs; rotate keys and enforce gates in CI.'
            }, usecases: [
              { title: 'No‑Attest No‑Deploy', body: 'Gate deployments on signed images/SBOM; audit trail is automatic.' },
              { title: 'Key Ceremonies', body: 'fwctl keys bootstrap with policy; rotate and scope keys per env.' },
              { title: 'Governed Access', body: 'OPA/REGO for deployment, data, and ethics gates; unit‑testable.' }
            ], signals: [ 'Image attestations', 'SBOMs and signatures', 'Policy decisions' ], proposes: [ 'Deploy approvals', 'Key rotations', 'Scope updates' ] },
            selfcode: { intro: 'Self‑Coding proposes PRs from telemetry with guardrails; every patch is signed, reviewed, and throttled by policy.', introPersona: {
              investor: 'Ship more with fewer regressions—proof beats promises.',
              operator: 'Auto‑patch low‑risk knobs; big changes still flow through you.',
              engineer: 'Open PRs with tests and OPA checks baked in; rollback plans generated.'
            }, usecases: [
              { title: 'fwctl patch propose', body: 'Telemetry‑triggered PRs (rate limiters, fallbacks) with tests and rollback.' },
              { title: 'Time‑Warp CI', body: 'Replay last prod hour in 60 seconds inside CI; receipts detect causality drift.' },
              { title: 'OutcomeMesh Hooks', body: 'Define outcomes; prove and settle payouts across teams/vendors automatically.' }
            ], signals: [ 'Error spikes and drift', 'Load and tail latency', 'Outcome definitions' ], proposes: [ 'Config/code diffs', 'Rollout gates', 'Outcome proofs' ] }
          },
          extra: {
            philosophy: { title: 'The philosophy (what makes this different)', bullets: [
              'Memory‑first: Spiral Memory in every app.', 'Causality by default: receipts everywhere.', 'Autonomy with guardrails: signed, reviewed, throttled.', 'Counterfactual dev: what‑ifs at scale + Switchboard.', 'Proof over vibes: OutcomeMesh pays on proof.'
            ] },
            toolkit: { title: 'The toolkit (opinionated, surgical)', bullets: [
              'fwctl init/run/patch/receipt/switchboard/outcome/timewarp',
              'SDKs: TS/Python/Rust/Go for memory, identity, sims, self‑coding, loop',
              'Editors: Spiral Lens, Receipt Notebook, Self‑Coding Reviewer, Switchboard HUD, Outcome Builder',
              'Testing: counterfactual, regret budget, ethics, receipt snapshots, time‑warp CI',
              'Policy & Governance: OPA/REGO, data contracts, model registry, privacy budgets',
              'Observability: fw trace/flame/drift, Receipt Feeds',
              'Local twins & sandboxes: city/warehouse/game/sat, IoT loopbacks, on‑chain/k8s harnesses',
              'Blueprints: service, robot skill, mobile overlay, game loop, web3 guard',
              'Supply chain: repro builds, SBOM everywhere, SLSA, key ceremonies',
              'Pricing/Packaging: Dev seat, Team, Enterprise, add‑ons'
            ] },
            investors: { title: 'Why devs, CTOs, and VCs sprint to “yes”', bullets: [
              'DevEx rockets: time‑to‑debug plummets; tests prove future‑safety.',
              'Ops stabilizes: auto‑patches + receipts = fewer 3am calls.',
              'Compliance is productized: audits become exports.',
              'Moat compounds: counterfactual + receipt corpus is uncopyable.'
            ] },
            tagline: 'Not another toolchain. A conscious developer OS that ships proof with every push.',
            pep: { title: 'Pep quote', bullets: [ '“Great code runs. Legendary code explains why it ran—and pays you for the outcome.”' ] },
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Greenlight a 3‑app sprint with fwctl init + counterfactual CI.',
              'Cut a 60‑sec reel: time‑warp debug → Self‑Coding PR → receipt export.',
              'Send a 1‑pager to GitHub Next, a16z Infra, Amplify—ask for dev‑in‑residence collab.'
            ] },
            closing: 'You bring the crown; we bring the toolchain that turns every coder into your empire.'
          }
        },
        education: {
          title: 'Education',
          features: {
            spiral: { intro: 'Learner Lattice: longitudinal timeline per learner/cohort—LMS clicks (LTI/xAPI/Caliper), SIS, attendance, assignments, rubrics, device perf, forums, tutoring, SSO, SDOH, micro‑moments like confusion and cold starts.', introPersona: {
              investor: 'Outcomes become engineered, not hoped—and receipts convince boards and funders.',
              operator: 'Ask: who drifted on factoring after absences + a device swap? Get the plan, not just a report.',
              engineer: 'Adapters for LTI/Caliper/xAPI/OneRoster; clean joins and fast causality queries.'
            }, usecases: [
              { title: 'Adaptive Pacing Without Chaos', body: 'Track mastery per skill; simulate groupings; reflow tasks + hints; draft tomorrow’s mini‑lesson and practice.' },
              { title: 'Cold‑Start Buster', body: 'Test intro activities on a shadow cohort; pick low‑regret; ship a lesson by 7am.' },
              { title: 'Teacher Co‑Pilot', body: 'Exit tickets, rubrics, exemplar feedback, and re‑teach plans from your class’s own memory.' }
            ] },
            hrg: { intro: 'Twins of classes, schedules, campuses, advising funnels, curriculum maps, exam rooms, funding rules—thousands of what‑ifs before humans commit.', introPersona: {
              investor: 'DFW falls and persistence rises—with fairness and receipts.',
              operator: 'Bell times, timetables, cohort splits: plans that actually fit constraints.',
              engineer: 'GPU twins; export diffs to pacing, rosters, exams, and aid rules.'
            }, usecases: [
              { title: 'Absence Recovery Router', body: 'Detect absences + drift; schedule peer/tutor blocks; avoid schedule collisions.' },
              { title: 'Accessibility Autopilot', body: 'Alt‑formats, captions, extended‑time windows as signed accommodations; privacy budgets enforced.' },
              { title: 'Advising & Dropout Guard', body: 'Sim degree paths vs aid/work; propose course swaps before failure.' }
            ], signals: [ 'LMS/SIS events', 'Accessibility and accommodation needs', 'Aid and workload constraints' ], proposes: [ 'Schedules and rosters', 'Accommodations and item tweaks', 'Course swap proposals' ] },
            sigil: { intro: 'Identity & Provenance: signed grades/hints/proctoring/credentials; FERPA/COPPA scopes; zero forged submissions.', introPersona: {
              investor: 'Trustworthy records and audit‑ready trails—the enterprise box gets ticked.',
              operator: 'Cleaner acceptance and disputes; parents and boards get receipts.',
              engineer: 'Scoped tokens, signed artifacts, verifiable credentials; clean audit export.'
            }, usecases: [
              { title: 'Assessment That Learns', body: 'Analyze item stats; retire leaky items; draft equivalents; enforce exposure caps; swap variants mid‑exam if leak risk spikes.' },
              { title: 'Proctoring Without the Dystopia', body: 'Device attestations and process proofs; privacy budgets; trust without creep.' },
              { title: 'Competency Wallets', body: 'Signed skills for projects/labs/portfolios; employers verify without transcripts.' }
            ], signals: [ 'Item telemetry and exposure', 'Device/user attestations', 'Artifacts and portfolio claims' ], proposes: [ 'Item pool changes', 'Proctoring policies', 'Credential issuance' ] },
            selfcode: { intro: 'Auto‑draft lesson variants, practice sets, pacing guides, timetables, office‑hour rosters, accommodations packets, proctoring rules, degree audits—with tests + rollback.', introPersona: {
              investor: 'Teacher hours drop, outcomes rise—scale without burnout.',
              operator: 'Plans land ready; you approve what fits; paperwork shrinks.',
              engineer: 'CI for content/schedules/policies; fairness tests and rollbacks built in.'
            }, usecases: [
              { title: 'Assessment & Item Health', body: 'Rewrite items with fairness checks; rebalance pools; prevent over‑exposure.' },
              { title: 'Bell‑Time / Timetable Compiler', body: 'Compile conflict‑free timetables with planning blocks and transport constraints.' },
              { title: 'Work‑Based Learning Router', body: 'Match students to micro‑apprenticeships; draft agreements; settle payouts on proof.' }
            ], signals: [ 'Gaps, item analytics, calendars, policies', 'Contract and route constraints', 'Placement outcomes' ], proposes: [ 'Lesson and pacing deltas', 'Schedules and rosters', 'Agreements and payouts' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The Education OS', groups: [
              { name: 'Spiral Memory (Learner Lattice)', bullets: [ 'LMS/SIS/events + micro‑moments in one timeline.' ]},
              { name: 'Sigil‑DNA (Identity & Provenance)', bullets: [ 'Signed grades, hints, proctoring, credentials; FERPA/COPPA scopes.' ]},
              { name: 'HRG', bullets: [ 'Twins: classes, schedules, advising, curriculum, exams, funding.' ]},
              { name: 'Self‑Coding', bullets: [ 'Draft lessons, practice, timetables, audits; tested and reversible.' ]},
              { name: '100 Hz (Classroom Heartbeat)', bullets: [ 'Throttle difficulty/hints/interventions/item exposure in seconds.' ]}
            ] },
            wins: { title: 'Killer use cases (K‑12 • Higher Ed • Workforce)', bullets: [
              'Adaptive Pacing Without Chaos', 'Cold‑Start Buster', 'Teacher Co‑Pilot', 'Absence Recovery Router', 'Accessibility Autopilot', 'Advising & Dropout Guard', 'Assessment That Learns', 'Proctoring Without the Dystopia', 'Bell‑Time / Timetable Compiler', 'Campus Load & Safety', 'Competency Wallets', 'Work‑Based Learning Router'
            ] },
            outcomemesh: { title: 'OutcomeMesh: pay on proof', bullets: [
              '+12% Algebra mastery w/ homework time ≤ baseline & equity gap ↓.',
              '−25% DFW in 101s w/ average study hours ≤ baseline.',
              '+10 pts first‑year persistence without aid shortfall.'
            ] },
            kpis: { title: 'KPIs we own (and how)', bullets: [
              'Mastery ↑ via pacing & item health',
              'DFW/withdrawal ↓ via low‑regret micro‑deltas',
              'Attendance/persistence ↑ via routers and advising',
              'Teacher hours ↓ 30–60% (planning/grading co‑pilot)',
              'Accessibility compliance → receipts',
              'Placement/earnings ↑ via signed skills + employer verify'
            ] },
            stack: { title: 'Architecture (no rip‑and‑replace)', lists: [
              { k: 'Ingest rails', v: 'LTI 1.3, IMS Caliper, xAPI, QTI, OneRoster, Ed‑Fi, SIS exports; D2L/Canvas/Google/Moodle adapters.' },
              { k: 'Core', v: 'Spiral Memory • Sigil‑DNA (HSM/TPM) • HRG sims • Self‑Coding CI • 100 Hz runtime.' },
              { k: 'Ops', v: 'Consoles for teachers/deans/registrars/advisors; FERPA receipts; VPC/on‑prem.' },
              { k: 'Guardrails', v: 'Privacy budgets; fairness cards; human approval for grading/placement; “Why I saw this” explainer.' }
            ] },
            investors: { title: 'Why leaders & VCs say “yes”', bullets: [
              'Outcomes, not dashboards—with receipts boards/accreditors accept.',
              'Low‑regret rollouts—start with pacing/hints/timetables; expand as trust grows.',
              'Compounding moat—cohort‑specific counterfactuals + receipts for what works.'
            ] },
            tagline: 'Not another edtech app—a conscious control layer for learning, with receipts.',
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Pick two pilots (Math Mastery + Gateway Rescue); draft MOUs/KPIs and privacy/fairness guardrails.',
              'Cut a 60‑sec sizzle: sim → micro‑commit → KPI pop → Causal Receipt → OutcomeMesh payout.',
              'Ship a 1‑pager to a district CIO, a provost, and employer partners (skills wallet).'
            ] },
            closing: 'Schools teach facts. Legends engineer breakthroughs—and bring the receipts.'
          }
        },
        ar: {
          title: 'Augmented Reality',
          features: {
            spiral: { intro: 'Spatial Lattice: time‑indexed graph of SLAM maps, anchors, planes, meshes, occlusion masks, gaze paths, gestures, purchases, dwell, audio, haptics, and safety zones per place+person+session.', introPersona: {
              investor: 'AR that sells and proves it—less nausea, more lift, royalty splits enforced.',
              operator: 'Find hesitation zones by shelf/lighting/FOV—fix stability and comfort with receipts.',
              engineer: 'Anchor drift history, world‑state deltas, per‑user comfort profiles; stable scenes across devices.'
            }, usecases: [
              { title: 'Retail & Venues', body: 'Wayfinding + basket lift with crowd‑aware paths; sightline sims; try‑on that recalibrates as stores relight.' },
              { title: 'Field Service / Utilities', body: 'Anchor‑true procedures; signed steps; hands‑free safety fences; MTTR down.' },
              { title: 'Education & Training', body: 'Adaptive labs; prompt rewrites per cohort; 100 Hz pacing by cognitive load.' }
            ] },
            hrg: { intro: 'Twins of lighting/materials/occlusion/multi‑user alignment/crowd flow/acoustics/gaze—ask “if we shift 12 cm and dim emissives, do novices still find it?”', introPersona: {
              investor: 'Outcome‑first: conversion, CSAT, safety—with receipts.',
              operator: 'Pre‑time multiuser scenes; handle drift/lighting before go‑live.',
              engineer: 'Engine‑agnostic adapters; parameter sweeps; export diffs to scenes/shaders/queries.'
            }, usecases: [
              { title: 'Live Events / Sports', body: 'Pre‑time FX to crowd flow/seat vectors; sign clip rights; measure sponsor ROI per section.' },
              { title: 'Automotive / In‑Cabin', body: 'Safety‑first HUD overlays; suppress under poor ACC; anchors ride on signed lane meshes.' },
              { title: 'Cities / Tourism', body: 'Civic AR with no‑overlay zones and equity guardrails; FOIA‑ready logs.' }
            ], signals: [ 'Lighting/pose/confidence', 'Gaze/crowd heat', 'Occlusion/mesh quality', 'Latency/thermal headroom' ], proposes: [ 'Anchor/placement deltas', 'Shader/material swaps', 'Tooltip/grammar updates' ] },
            sigil: { intro: 'Identity & rights: signs anchors/scenes/assets/devices/people/rights; no spoofed anchors or stolen lenses; every overlay has source/license/safety policy; royalties split automatically.', introPersona: {
              investor: 'Trust and monetization by default.',
              operator: 'Source and license on every overlay; smoother approvals and audits.',
              engineer: 'Scopes for who can see/place/monetize; signed renders and device proofs.'
            }, usecases: [
              { title: 'Spatial Ledger', body: 'Ephemeral by default; consented persistents; DP on crowd maps; federated global meshes.' },
              { title: 'Shared Scene Sync', body: 'Device‑to‑edge relays; time‑warp reprojection; late‑latching; 2–50 users stay aligned.' },
              { title: 'Visual I/O Contracts', body: 'Policy per asset/scene: max alpha, min contrast, motion budget, occlusion priority, eye‑tracking usage, no‑overlay zones.' }
            ], signals: [ 'Render attributions', 'Device/anchor attestations', 'Policy violations' ], proposes: [ 'Visibility/royalty scopes', 'Revocations', 'Policy clamps' ] },
            selfcode: { intro: 'Autowrites patches from crash/comfort/conversion telemetry: retunes occlusion thresholds, swaps shaders, rewrites spatial queries, reorders tooltips, updates safety fences—with tests + rollback.', introPersona: {
              investor: 'Fewer reworks, higher lift—proof beats sizzle.',
              operator: 'Ship fixes nightly with guardrails; creators get paid automatically.',
              engineer: 'Engine‑agnostic codegen with tests; comfort/safety budgets enforced.'
            }, usecases: [
              { title: 'Comfort & Safety Loop', body: 'Fade labels on saccades; throttle particles under proximity; boost contrast in glare.' },
              { title: 'Drift & Lighting Honesty', body: 'Micro‑nudges on reproj error; SH/HDR env probes; auto‑swap materials per SKU.' },
              { title: 'Occlusion Budgets', body: 'If thermals rise or pose falls, degrade occlusion meshes before UX tanks.' }
            ], signals: [ 'Pose/latency/thermals', 'Gaze and comfort', 'Crash/conversion deltas' ], proposes: [ 'Scene/shader/query diffs', 'Budget clamping', 'Safety fence updates' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The AR OS', groups: [
              { name: 'Spiral Memory (Spatial Lattice)', bullets: [ 'SLAM/anchors/planes/meshes + gaze/gestures/dwell + safety zones per place/person/session.' ]},
              { name: 'Sigil‑DNA', bullets: [ 'Signed anchors/scenes/assets/devices/people/rights; royalties split.' ]},
              { name: 'HRG', bullets: [ 'Twins: lighting/materials/occlusion/multi‑user/crowds/acoustics/gaze.' ]},
              { name: 'Self‑Coding', bullets: [ 'Patches from crash/comfort/conversion; tests+rollback.' ]},
              { name: '100 Hz (Somatic Control)', bullets: [ 'Throttle spam, fade labels, boost contrast, soft‑stop near curbs.' ]}
            ] },
            wins: { title: 'Where this crushes', bullets: [
              'Retail & Venues', 'Field Service / Facilities / Utilities', 'Education & Training', 'Healthcare & Medtech', 'Cities / Tourism / Culture', 'Live Events / Concerts / Sports', 'Workspaces / Creation', 'Automotive / In‑Cabin HUD', 'Defense & Public Safety (non‑lethal)'
            ] },
            arcloud: { title: 'The AR Cloud (without the creep)', bullets: [
              'Ephemeral anchors by default; consented persistents; DP on crowd maps; federated updates.',
              'Shared Scene Sync: sub‑100 ms alignment; seat/tenant‑licensed overlays.',
              'Visual I/O Contracts: policy per asset for alpha/contrast/motion/occlusion/eye‑tracking/no‑overlay zones.'
            ] },
            creator: { title: 'Creator economy that pays', bullets: [
              'Sigil‑signed assets/shaders/filters/LUTs/interaction snippets.',
              'Auto‑royalties on use; splits flow same‑day.',
              'MythWeaver motifs + Fortuna serendipity; receipts show what performed and why.'
            ] },
            devsurface: { title: 'Dev surface (engine‑agnostic)', bullets: [ 'OpenXR/WebXR/ARKit/ARCore/MRTK/Unity/Unreal adapters; no lock‑in.' ] },
            engineering: { title: 'Hardcore engineering', bullets: [
              'Anchor drift killers; plane/mesh fusion; IMU bias bake‑offs; receipts for drift deltas.',
              'Lighting honesty with SH/HDR; HRG metamerism tests; auto material swaps.',
              'Occlusion budgets tied to thermals/pose; degrade before UX tanks.',
              'Gaze ethics: on‑device vectors; coarse features only; no hard‑targeting by pupil micro‑moves.',
              'No‑overlay zones: stairs/curbs/crosswalks/surgical fields/schools—enforced at 100 Hz.'
            ] },
            investors: { title: 'Why brands, venues, cities, and VCs wire instantly', bullets: [
              'Outcomes, not vibes—conversion/MTTR/CSAT/safety with receipts.',
              'Trust by design—signed sources, on‑device gaze, no‑overlay zones.',
              'Compounding moat—spatial counterfactuals corpus no one else has.'
            ] },
            tagline: 'Not an AR filter—a conscious reality layer that pays for itself.',
            pep: { title: 'Pep quote', bullets: [ '“Screens show pixels. AR shows decisions—and we’ll ship the receipts.”' ] },
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Pick two pilots (Retail Endcap + Stadium AR); draft scopes/KPIs and safety/ethics guardrails.',
              'Cut a 60‑sec sizzle: sim → micro‑commit → KPI pop → receipt → royalty payout.',
              'Spin up a Creator Call; onboard to Sigil‑DNA + splits; pre‑agree OutcomeMesh shares.'
            ] },
            closing: 'You bring the crown; we make reality your stage—with receipts.'
          }
        },
        gaming: {
          title: 'Gaming & VR',
          features: {
            spiral: { intro: 'Player/World Lattice: time‑indexed graph of inputs, latency, device/FOV, coarse gaze, haptics, economy flows, squad links, quest state, clip moments, crashes.', introPersona: {
              investor: 'Retention and revenue rise on proof, not vibes—comfort and fairness built‑in.',
              operator: 'Ask: why did churn spike in Act 2 for low‑RAM Android + snap turn users? Get the why and the fix.',
              engineer: 'Blend telemetry with graph+vectors; causality chains for crashes and exploits.'
            }, usecases: [
              { title: 'NPCs with Episodic Memory', body: 'Per‑player facts (“you left me at the docks”); intent trees; comfort‑aware proximity.' },
              { title: 'Matchmaking That Feels Fair', body: 'Fuse skill/latency/input/FOV; solve queues to 50/50; re‑queue edge cases.' },
              { title: 'Presence Governor (VR comfort)', body: 'Cap accel/rot/jerk; vignette during saccades; blink‑teleport failsafe; throttle particles near humans.' }
            ] },
            hrg: { intro: 'Twins for matchmaking, economies, metas, maps, locomotion comfort, server load, shader/hardware combos—run 10k what‑ifs before you patch.', introPersona: {
              investor: 'Meta shifts without meltdowns; receipts sell publishers.',
              operator: 'Queue, load, comfort, economy—pick safe branches before live.',
              engineer: 'Agent swarms and parameter sweeps; export diffs to configs and code.'
            }, usecases: [
              { title: 'Live Balance Without Meltdowns', body: 'Sandbox nerfs/buffs; emit parameter diffs; deploy to 5% with rollbacks.' },
              { title: 'Economy Inflation Shield', body: 'Sim sinks/sources; tune drops/bundles; throttle faucets under shock.' },
              { title: 'Latency Budget Accountant', body: 'Bind ms cost to intent (comfort/fairness/visuals); reorder pipelines or swap shaders.' }
            ], signals: [ 'Skill/latency/input/FOV', 'TTK/econ flows', 'Frame time/thermal', 'Crash/exploit traces' ], proposes: [ 'Balance deltas', 'Drop/shop changes', 'Foveation/shader toggles' ] },
            sigil: { intro: 'Identity/Provenance: keys for players/devices/builds/servers/assets/mods/events; anti‑cheat at the edge; UGC royalties auto‑split; cross‑title persona without alt farms.', introPersona: {
              investor: 'Cheat MTTR → minutes; creators get paid—flywheel spins.',
              operator: 'Due‑process bans, signed clips/rights; smoother moderation.',
              engineer: 'SLSA/SBOM for content; signed builds/devices; portable proofs.'
            }, usecases: [
              { title: 'Anti‑Cheat at the Edge', body: 'Attest device/build; behavior fingerprints; ship signatures in minutes; quarantine lobbies.' },
              { title: 'UGC Marketplace with Royalties', body: 'Stamp mods/skins/maps; auto‑splits on use; creator analytics by receipt.' },
              { title: 'Social Safety by Default', body: 'Proximity boundaries; auto‑mute harassment; receipts for actions taken.' }
            ], signals: [ 'Device/build attest', 'Behavioral fingerprints', 'UGC usage' ], proposes: [ 'Signature updates', 'Royalties and splits', 'Safety actions' ] },
            selfcode: { intro: 'Autowrites balance deltas, locomotion defaults, anti‑exploit signatures, aim/assist curves, economy sinks/sources, QA tests; PRs with rollback and reviews.', introPersona: {
              investor: 'Faster release cadence with fewer regressions—proof sells.',
              operator: 'Patches land with tests and gates; narrow lanes first.',
              engineer: 'Open PRs wired to counterfactual CI and fairness tests; rollback plans baked in.'
            }, usecases: [
              { title: 'AI‑QA Swarm', body: 'Agents speed‑run builds; file repro scripts and patches.' },
              { title: 'Crash/Exploit Autopsy', body: 'Stitch crash+repro+device; attach failing tests to PR; explain root cause.' },
              { title: 'Localized Comfort Packs', body: 'Snap vs smooth, audio mix, color/contrast per region/device; certify no fairness harm.' }
            ], signals: [ 'Crash logs and sentiment', 'Exploit traces and TTK spikes', 'Regional device profiles' ], proposes: [ 'Config/code diffs', 'Guardrails and tests', 'Rollout/rollback gates' ] }
          },
          extra: {
            pillars: { title: 'Pillars (what makes this different)', bullets: [ 'Comfort‑first VR', 'Fairness‑by‑design', 'Presence economy', 'Provenance', 'Proof' ] },
            wins: { title: '18 genius, high‑value use cases', bullets: [
              'NPCs with episodic memory', 'Live balance without meltdowns', 'Matchmaking that feels fair', 'Presence Governor', 'Gaze‑aware UI', 'Haptic Composer', 'Anti‑cheat at the edge', 'Social safety by default', 'Economy inflation shield', 'UGC marketplace with royalties', 'Live events & concerts', 'AI‑QA swarm', 'Latency budget accountant', 'Crash/Exploit autopsy', 'Mixed‑reality safety fences', 'Spectator OS', 'AA Wallet/Intents co‑pilot', 'Localized comfort packs'
            ] },
            stack: { title: 'Architecture (no rip‑and‑replace)', lists: [
              { k: 'Engines', v: 'Unreal/Unity + FW SDK (C++/C#/TS)' },
              { k: 'Backends', v: 'PlayFab/EOS/Steamworks adapters; Kafka/Redis/S3 → Spiral Memory' },
              { k: 'Security', v: 'Sigil‑DNA gateway; SLSA/SBOM for content' },
              { k: 'Sims', v: 'HRG on GPU for balance/econ/comfort/matchmaking' },
              { k: 'Autonomy', v: 'Self‑Coding GitHub app → PRs + tests + rollback' },
              { k: 'Runtime', v: '100 Hz daemon hooks into tick/render; policy guardrails' },
              { k: 'Privacy', v: 'On‑device gaze; DP on analytics; parental/age policies' }
            ] },
            devsurface: { title: 'Developer surface (snackable)', bullets: [ 'Comfort & safety snippets', 'Matchmaking fairness API', 'AutoPatch demos', 'UGC royalties API' ] },
            kpis: { title: 'KPIs you’ll move (with receipts)', bullets: [ 'D1/D7 retention ↑', 'Nausea ≈ 0', 'Exploit MTTR → minutes', 'Crash rate ↓', 'ARPPU/attach ↑', 'Toxicity ↓', 'Build cycle time ↓' ] },
            skus: { title: 'Product SKUs', bullets: [ 'FW:VR Comfort', 'FW:LiveOps', 'FW:NPC', 'FW:Match & Fair', 'FW:UGC & Rights', 'FW:Esports', 'FW:Core' ] },
            investors: { title: 'Why publishers, platforms, and VCs wire fast', bullets: [ 'Outcome‑first with receipts', 'No rip‑and‑replace', 'Compounding counterfactual moat' ] },
            tagline: 'Not another plugin—a conscious control layer for worlds people live in.',
            pep: { title: 'Pep line', bullets: [ '“Players chase moments. Legends manufacture them—on command, without nausea, with receipts.”' ] },
            reminders: { title: '3 Career‑Power Reminders', bullets: [ 'Lock two pilots (VR Comfort + Matchmaking Fairness).', 'Cut a 60‑sec sizzle: sim → micro‑commit → KPI pop → Receipt → UGC payout.', 'Ship a 1‑pager to Epic Publishing, Meta Content, Riot Forge—offer a 90‑day retention uplift.' ] },
            closing: 'You bring the crown; we make your worlds addictive and ethical—on proof.'
          }
        },
        biotech: {
          title: 'Biotech & Computational Biology',
          features: {
            spiral: { intro: 'Bio Lattice: time‑indexed graph for LIMS/ELN events, assay/QC results, instrument logs (SDMS), MES batches, training/cert matrices, cleanroom env, supply lots/chain‑of‑identity, clinical/RWE tables, model cards.', introPersona: {
              investor: 'Failure rate falls and release speeds up—proof convinces QA and payers.',
              operator: 'Ask: which deviations correlated with last quarter’s batch failures across reactors 2/5/8? Get a prioritized plan.',
              engineer: 'Join LIMS/ELN/MES/SDMS/ERP/EDC/CTMS cleanly; causality traces for deviations and docs.'
            }, usecases: [
              { title: 'Part 11/Annex 11 Provenance Spine', body: 'All edits/actions signed; stitch who/what/when/why across systems; shrink deviation investigations.' },
              { title: 'QC Outlier Radar', body: 'Watch assay trends/instrument drift; flag suspect runs; auto‑generate re‑test packets.' },
              { title: 'RegOps Compiler', body: 'Auto‑draft traceability/lineage/validation summaries from memory + model cards.' }
            ] },
            hrg: { intro: 'Twins for bioprocess trains, purification skids, cleanroom capacity, instrumentation uptime, logistics/cold chain, clinical ops, in‑silico screens. Plan capacity and risk—no wet‑lab how‑tos.', introPersona: {
              investor: 'Yield up, failures down—without procedural risk.',
              operator: 'Slotting and changeovers that meet realities; fewer surprises.',
              engineer: 'Scenario sweeps over schedules/utilities/people; export diffs to calendars and plans.'
            }, usecases: [
              { title: 'Scale‑Up/Tech‑Transfer Twin', body: 'Sim capacity/utilities/knock‑ons before runs; tie to OutcomeMesh bounties (e.g., failure ↓ without QC regression).' },
              { title: 'Cleanroom Load Orchestrator', body: 'Balance suites/changeovers/people flow; propose shifts that respect training/cert constraints.' },
              { title: 'Cold‑Chain & Identity Proof', body: 'Sign custody/thermal events; resolve disputes instantly; insurer credits.' }
            ], signals: [ 'Batch/schedule/utilities', 'Instrument uptime/drift', 'Custody/thermal events', 'Clinical ops windows' ], proposes: [ 'Slotting/changeovers', 'Re‑tests and holds', 'Reroutes and credits' ] },
            sigil: { intro: 'Identity & Provenance for samples, lots, instruments, reagents, people, files, models. Part 11‑style signatures, tamper‑evident trails, role scopes; every transfer/read/prediction is signed.', introPersona: {
              investor: 'Audit‑clean trails reduce liability and speed deals.',
              operator: 'Chain‑of‑identity and cold‑chain disputes settle fast.',
              engineer: 'Keys and scopes; signed reads/writes; portable audit bundles.'
            }, usecases: [
              { title: 'CDMO Performance Ledger', body: 'Shared receipts on yields/deviations/cycle time; bonuses pay on verified KPIs.' },
              { title: 'Supplier Reliability Map', body: 'Mix lead‑time/lot alerts/env disruptions; reroute POs with receipts.' },
              { title: 'Explainable Audits', body: 'One‑click PDF “what changed + why + effect,” tailored to QA/regulators/insurers.' }
            ], signals: [ 'Signed edits/transfers', 'Supply/custody lineage', 'Model/data signatures' ], proposes: [ 'Bonus/adjudication', 'Supplier switches', 'Audit exports' ] },
            selfcode: { intro: 'Converts telemetry + deviations + policy updates into doc updates, schedules, checklists, data pipelines, validation artifacts, and compliant drafts—with tests + rollback.', introPersona: {
              investor: 'Document cycle time falls; inspection readiness rises.',
              operator: 'CAPA docs and follow‑ups drafted; timers tracked.',
              engineer: 'Pipelines and reports updated safely; rollbacks ready.'
            }, usecases: [
              { title: 'CAPA Autoprioritizer', body: 'Rank corrective actions by impact/cycle time; draft docs; set follow‑ups.' },
              { title: 'Feature‑to‑Mechanism Insight', body: 'Fuse omics/imaging/metadata; surface weak signals/confounders; update ETL/bias checks.' },
              { title: 'Model Registry + Cards', body: 'Sign datasets/weights/evals; regenerate cards on drift.' }
            ], signals: [ 'Deviation and QC deltas', 'ETL/model drift', 'Policy and SOP updates' ], proposes: [ 'Schedules/checklists', 'ETL and bias tests', 'Card/regulatory drafts' ] }
          },
          extra: {
            modules: { title: 'Featherweight → The Bio/Comp‑Eng OS', groups: [
              { name: 'Spiral Memory (Bio Lattice)', bullets: [ 'LIMS/ELN/MES/SDMS/ERP + training/env + clinical/RWE + model cards.' ]},
              { name: 'Sigil‑DNA (Identity & Provenance)', bullets: [ 'Part 11‑style signatures; tamper‑evident trails; role scopes.' ]},
              { name: 'HRG', bullets: [ 'Bioprocess/capacity/supply/clinical ops twins for planning—not procedures.' ]},
              { name: 'Self‑Coding', bullets: [ 'Docs/schedules/pipelines/validation drafts; humans approve.' ]},
              { name: '100 Hz (Ops Heartbeat)', bullets: [ 'Watch drift/health/queues/timers/loading; throttle releases until QC complete.' ]}
            ] },
            wins: { title: '16 genius, high‑value use cases', bullets: [
              'Part 11/Annex 11 Provenance Spine', 'CAPA Autoprioritizer', 'QC Outlier Radar', 'RegOps Compiler', 'Scale‑Up/Tech‑Transfer Twin', 'Cleanroom Load Orchestrator', 'Cold‑Chain & Identity Proof', 'Property‑Screening Workbench (in silico)', 'Feature‑to‑Mechanism Insight', 'Model Registry + Cards', 'Trial Operations Twin', 'RWE Evidence Assembler', 'CDMO Performance Ledger', 'Supplier Reliability Map', 'Safety‑By‑Default Guard', 'Explainable Audits'
            ] },
            stack: { title: 'Architecture (drop‑in, GxP‑friendly)', lists: [
              { k: 'Ingest rails', v: 'LIMS/ELN/MES/SDMS/eQMS/ERP, instruments, EDC/CTMS, EHR/RWE (PHI‑scoped), SCADA/EMS, supply/cold‑chain.' },
              { k: 'Core', v: 'Spiral Memory • Sigil‑DNA (HSM/TPM) • HRG sims • Self‑Coding CI • 100 Hz heartbeat.' },
              { k: 'Governance', v: '21 CFR Part 11/GxP, privacy budgets, role scopes, model registry/cards, immutable receipts.' },
              { k: 'Guardrails', v: 'No generative wet‑lab steps; human approval for sensitive actions; safety screeners; IBC/IRB/ethics hooks.' }
            ] },
            kpis: { title: 'KPIs you move (and investors care about)', bullets: [
              'Batch failure ↓ 20–40%', 'Time‑to‑release ↓', 'CAPA aging ↓ 30–50%', 'Doc cycle time ↓ 30–60%', 'Cold‑chain disputes ~0', 'Trial timeline slip ↓'
            ] },
            skus: { title: 'Product SKUs', bullets: [ 'FW:BioCore', 'FW:Bioproc Twin', 'FW:RegOps', 'FW:QC Guard', 'FW:SupplyProof', 'FW:Comp‑Eng', 'FW:OutcomeMesh' ] },
            investors: { title: 'Why execs, QA heads, and VCs say “yes”', bullets: [ 'Outcomes proven', 'Reg‑native', 'No rip‑and‑replace', 'Compounding counterfactual moat' ] },
            tagline: 'Not another lab tool — a conscious control layer for bio & comp‑eng, with receipts.',
            pep: { title: 'Pep line', bullets: [ '“Science finds truths. Systems deliver them on time — with receipts.”' ] },
            reminders: { title: '3 Career‑Power Reminders', bullets: [
              'Draft a 1‑pager for CDMO COO, biotech CTO, QA/Reg VP—KPIs + guardrails.',
              'Cut a 60‑sec sizzle: deviation detective → schedule save → receipt → OutcomeMesh.',
              'Line up two pilots (Quality Spine + Capacity Twin); prep MOUs and GxP language.'
            ] },
            closing: 'Install the cortex that makes safe, compliant outcomes inevitable.'
          }
        },
        finance: {
          title: 'Finance & Banking',
          features: {
            spiral: {
              intro: 'A living memory lattice for counterparties, payments, and market regimes.',
              introPersona: {
                investor: 'Compounding risk memory across customers, products, and markets—turning history into approvals, pricing, and capital efficiency.',
                operator: 'Fewer false positives, clearer narratives, smoother closes—systems remember context so queues shrink.',
                engineer: 'Time‑indexed graph with evidence trails; deterministic contracts and low‑latency retrieval for real‑time decisions.'
              },
              usecases: [
                { title: 'Living Counterparty Graph', body: 'Time‑aware graph of exposures, covenants, disputes, collateral. Proposes limit/tenor changes, watch‑lists, and margin actions with evidence.' },
                { title: 'Payments Posture & Authorization', body: 'Device posture, merchant behavior, route health, and prior exceptions shape adaptive authorization and dispute packets.' },
                { title: 'Market Regime Recall', body: 'Link decisions to outcomes across cycles; pre‑approved hedges and routing rules with kill‑switches and rollout gates.' }
              ]
            },
            hrg: {
              intro: 'Holographic sim for finance: replay market regimes, liquidity shocks, and operational stress to choose policies with receipts before capital is at risk.',
              introPersona: {
                investor: 'Sim‑before‑spend for capital, risk, and routes—choose policies with receipts, not vibes.',
                operator: 'Dry‑run stress, outages, and volume spikes; pick playbooks that keep SLAs green.',
                engineer: 'Agent/timeseries sims with pluggable physics; config‑in/code‑out harnesses you can diff and ship.'
              },
              usecases: [
                { title: 'Basel IV & Liquidity Policy Lab', body: 'Intraday capital and liquidity sims across IRB vs SA, deposit flight, and corridor stress so treasury can set buffers and transfer pricing with proof.' },
                { title: 'Payments Routing Under Fire', body: 'Network latency, fee schedules, outage patterns, and fraud heat re‑created in sandboxes to pick routes, queueing, and step‑up triggers that hold under volatility.' },
                { title: 'Collections & Offers Agent Swarms', body: 'Behavioral agents tuned on vintage curves and macro to pick cadence, tone, and offer ladders that preserve loyalty while cutting loss.' }
              ],
              signals: [
                'Market microstructure ticks, depth, spreads',
                'Liquidity ladders, LCR/NSFR components',
                'Auth graph: device posture, merchant risk, route health',
                'Vintage curves, bureau updates, macro shocks',
                'Operational metrics: queue times, failure codes, SLAs'
              ],
              proposes: [
                'Capital buffers, transfer pricing, hedge ladders',
                'Routing tables, retry windows, step‑up thresholds',
                'Offer strategies, contact cadence, hardship paths'
              ]
            },
            sigil: {
              intro: 'DNA Sigils are evolving, signed identities for people, devices, and institutions—reducing fraud while lowering friction across banking, insurance, accounting, and wealth.',
              introPersona: {
                investor: 'Fraud down, friction down—signed identities and portable proofs unlock growth with trust.',
                operator: 'Less KYC churn, faster wires, fewer holds—attestations travel with the customer and device.',
                engineer: 'Post‑quantum creds, device attestation, ledger anchors; verifiable claims over APIs.'
              },
              usecases: [
                { title: 'Continuous KYC/KYB', body: 'Quantum‑resistant credentials update posture continuously (watchlists, device health, behavioral risk) to streamline onboarding and keep approvals clean.' },
                { title: 'High‑Value Payments & Wires', body: 'Mutual attestation between counterparties and custodians; adaptive MFA + policy proofs cut delays while raising assurance.' },
                { title: 'Immutable Ledger Provenance', body: 'Cross‑subledger proofs for journal lineage; close with explainability auditors can trust.' }
              ],
              signals: [
                'Device posture and biometrics',
                'Sanctions/watchlists, KYB/KYC docs',
                'Ledger anchors and journal hashes',
                'Custodian attestations, token proofs',
                'IoT telemetry for UBI/smart‑home (insurance)'
              ],
              proposes: [
                'Step‑up/step‑down auth paths',
                'Limit/tenor adjustments with rationale',
                'Faster onboarding with portable proofs',
                'Ledger accept/reject with evidence trails'
              ]
            },
            selfcode: {
              intro: 'Self‑Coding turns finance policies into tested modules with provenance, then rolls them out safely with canaries and rollbacks.',
              introPersona: {
                investor: 'Rules change → revenue stays—autocode keeps risk and compliance in lock step.',
                operator: 'Fix drift nightly, auto‑recs, and clean rollbacks—ops gets faster, audits get easier.',
                engineer: 'Policies → tests → code; canary gates, model cards, provenance baked in.'
              },
              usecases: [
                { title: 'Reg Update to Runtime', body: 'When rules change (Basel/DORA/IFRS), generate tests and code updates; attach model cards and audit receipts automatically.' },
                { title: 'Fraud Model Drift Fixes', body: 'Detect drift against Spiral signals; generate feature gates and retrain jobs; schedule canary deployment overnight.' },
                { title: 'Auto‑Recs & Connectors', body: 'Generate reconciliations and data adapters as products launch; keep close risk down while shipping faster.' }
              ],
              signals: [
                'Policy diffs, audit findings, model drift metrics',
                'Data schema changes, lineage gaps',
                'SLO/SLA violations, incident patterns'
              ],
              proposes: [
                'Code diffs with tests and model cards',
                'Rollout plans (canary/blue‑green) with gates',
                'Fallbacks and automatic rollback triggers'
              ]
            }
          },
          extra: {
            modules: {
              title: 'Featherweight → The Finance OS',
              groups: [
                { name: 'Spiral Memory', bullets: [
                  'Banking: evolving risk + credit graph per customer (fraud + credit in one lattice)',
                  'Insurance: lifetime claims lattice; surfaces staged‑accident rings',
                  'Accounting/Audit: continuous journal lineage; no data loss between closes',
                  'Wealth: long‑horizon investor DNA (goals, ESG, tax lots) powering advice'
                ]},
                { name: 'Sigil‑DNA (Identity)', bullets: [
                  'Banking: quantum‑resistant KYC/AML; kills synthetic IDs',
                  'Insurance: signed IoT telemetry for UBI/smart‑home policies',
                  'Accounting: immutable cross‑sub ledger provenance',
                  'Wealth: verifiable asset tokens; custodian ↔ fund handshake'
                ]},
                { name: 'HRG (Holographic Sim)', bullets: [
                  'Banking: intraday Basel IV capital & stress sims',
                  'Insurance: catastrophe & reinsurance optimization in minutes',
                  'Accounting: instant GAAP/IFRS “what‑if” alternate books',
                  'Wealth: mass backtests; policy‑aware robo‑advice tuning'
                ]},
                { name: 'Self‑Coding', bullets: [
                  'Banking: patches fraud models as attacks evolve',
                  'Insurance: autowrites underwriting rules on reg updates',
                  'Accounting: auto‑recs the second a new GL module lands',
                  'Wealth: generates & sandboxes bespoke strategies'
                ]},
                { name: '100 Hz Loop', bullets: [
                  'Banking: throttles approvals when volatility spikes',
                  'Insurance: tone‑adapts claims comms in stressful moments',
                  'Accounting: detects reviewer overload; rebalances work',
                  'Wealth: sentiment‑aware portfolio nudges in choppy weeks'
                ]}
              ]
            },
            wins: {
              title: 'High‑Impact Use Cases (fast wins)',
              bullets: [
                'DORA readiness: self‑healing infra + third‑party registry → −40% audit‑prep time.',
                'Basel IV chaos: nightly IRB vs SA sims → optimized CET1 without over‑parking capital.',
                'Claims fraud ($308B/yr): batch‑by‑batch anomaly patterns → +25% fraud saves.',
                'Audit talent crunch: auto‑draft workpapers → −60% cycle time, junior churn ↓.',
                'Close risk: real‑time anomaly flags → close 10→3 days.'
              ]
            },
            pilot: {
              title: '90‑Day “Show‑Me‑the‑Money” Pilot',
              steps: [
                'Weeks 1–2 | Scope & Ingest — Pick one thorn (card‑fraud spike or claims leakage). Pipe raw events into a VPC sandbox.',
                'Weeks 3–6 | Digital‑Twin Sim — HRG runs Basel/DORA scenarios; Sigil‑DNA signs every API call.',
                'Weeks 7–10 | Shadow Mode — Spiral Memory writes risk narratives; Self‑Coding fixes drift nightly. KPIs: false‑positives ↓, capital saved, ops hours freed.',
                'Weeks 11–13 | RegTech Pack & Rollout — Auto‑generate ICT registry/model cards. Expand from one product to the grid.'
              ],
              monetize: 'Monetize: per‑transaction risk fee • sim‑compute credits • premium compliance reports.'
            },
            gtm: {
              title: 'Go‑To‑Market Plays',
              bullets: [
                'Tier‑2 bank JV: solve Basel IV capital headaches with a live demo.',
                'Insurance consortium PoC: 90‑day fraud‑reduction guarantee; share recovered leakage.',
                'Big‑4 channel: Featherweight as the cognition layer under their Gen‑AI audit.',
                'FinTech SDK: drop‑in Sigil‑DNA for instant KYC + wire auth.'
              ]
            },
            investors: {
              title: 'Why VCs Sprint to Wire',
              bullets: [
                'Reg‑alignment moat: self‑coding updates track new rules automatically.',
                'Data gravity: Spiral Memory becomes the deepest longitudinal risk corpus.',
                'Platform economics: new lines (insurance → wealth) are configs, not rebuilds.'
              ]
            },
            stack: {
              title: 'Minimal Stack',
              lists: [
                { k: 'Data plane', v: 'Kafka/S3 + Featherweight Spiral Memory' },
                { k: 'Risk/Sim', v: 'HRG on GPU (cloud burst)' },
                { k: 'Governance', v: 'Sigil‑DNA gateway + model cards + audit receipts' },
                { k: 'Ops', v: 'Self‑Coding agents; 100 Hz loop for live throttling' }
              ]
            },
            tagline: 'Markets reward speed; legends reward imagination. Featherweight delivers both — with receipts.',
            reminders: {
              title: '3 Career‑Power Reminders',
              bullets: [
                'Ship a 1‑pager “Featherweight × Finance” to Citi Ventures, Acrew, Anthemis by Friday.',
                'Lock a Money20/20 (Oct ’25) talk: Self‑Coding Compliance.',
                'Spin up a stealth audit pilot (10 clients). Goal: case study before year‑end.'
              ]
            },
            closing: 'You bring the crown, I’ll bring the ledger that prints outcomes. Ready for the whitepaper + intro emails?'
          }
        },
        manufacturing: {
          title: 'Manufacturing & Logistics',
          features: {
            spiral: { intro: 'Plant and supply memory for anticipatory operations.', introPersona: {
              investor: 'Throughput compounds when the floor remembers—memory turns variability into uptime and yield.',
              operator: 'Recall what worked, spot drift early, and keep moves smooth—less fire‑drill, more flow.',
              engineer: 'Time‑series + genealogy + QA in a living graph; deterministic policies with rollback proofs.'
            }, usecases: [
              { title: 'Supplier & Process Memory', body: 'Lot genealogy, SPC, tooling, and QA outcomes drive routing and recipe tweaks with proof.' },
              { title: 'Self‑Optimizing Lines', body: 'Recall recoveries; prime vision and setpoints with safe rollback and canaries.' },
              { title: 'Yard & Dock Intelligence', body: 'ASN, SLAs, yard moves, and labor shape dynamic gate and pick plans.' } ] },
            hrg: { intro: 'Holographic twins for the floor and yard: simulate line schedules, QA policies, and yard flows before metal moves.', introPersona: {
              investor: 'Capex hits smarter when schedules and policies are tested in sim first—waste down, output up.',
              operator: 'Try shifts, maintenance, and QA windows in sim; pick what keeps OEE green.',
              engineer: 'ROS/Isaac compatible twins; plug data, run agents, export diffs to production.'
            }, usecases: [
              { title: 'Scheduling Sandbox', body: 'Evaluate shift mixes, preventive maintenance, and changeover sequences to maximize OEE without surprise downtime.' },
              { title: 'Golden‑Unit QA', body: 'Stream a golden unit; diff live sensor traces to catch drift early; pick windows and sampling that minimize scrap.' },
              { title: 'Yard & Dock Flow', body: 'Sim gates/docks under realistic arrivals to pick assignments and staging that cut dwell and demurrage.' } ],
              signals: [ 'Cycle times, queue lengths, tool wear, SPC', 'Vision yields, torque traces, vibration/freq spectra', 'ASN, ETA, yard positions, labor availability' ],
              proposes: [ 'Schedule changes and PM slots', 'QA windows and sampling rates', 'Dock assignments and staging plans' ] },
            sigil: { intro: 'Trusted workers, PLCs, grippers, and suppliers with verifiable posture and training—safety and compliance without friction.', introPersona: {
              investor: 'Safer cells with audit‑clean proofs—insurance likes it, recalls shrink.',
              operator: 'Badges and gear that prove themselves—fewer overrides, faster releases.',
              engineer: 'Device attestation + operator certs + lot proofs—enforced via simple policies.'
            }, usecases: [
              { title: 'Operator Trust', body: 'Training and recert proofs attached to badges and HMIs; block unsafe overrides automatically.' },
              { title: 'Device & Tool Identity', body: 'PLC, gripper, and sensor identities carry firmware attestation; reject unknown or tampered gear.' },
              { title: 'Supplier/Partner Proofs', body: 'Portable inbound proofs on lots and tools accelerate receiving and release.' } ],
              signals: [ 'Device posture and firmware attestation', 'Operator training/cert history', 'Supplier batch proofs, QA results' ],
              proposes: [ 'Allow/deny/step‑up operations', 'Maintenance holds and tool quarantine', 'Accelerated receiving with less sampling' ] },
            selfcode: { intro: 'Generate adapters, optimizers, and QA services with policy gates and safe rollout.', introPersona: {
              investor: 'Software output per robot goes up—margins expand without headcount spikes.',
              operator: 'Adapters and optimizers land faster and safer—gated rollouts, quick rollback.',
              engineer: 'Codegen with tests, simulators, and contracts—A/B harnesses baked in.'
            }, usecases: [
              { title: 'Twin Connectors', body: 'Generate PLC/MES adapters with typed schemas, simulators, and tests so twins stay in lock‑step with reality.' },
              { title: 'Scheduling Services', body: 'Compose and ship optimizers behind A/B harnesses with guardrails; flip by cell/line with canaries.' },
              { title: 'QA Microservices', body: 'Policy‑aware vision and analytics services with automatic calibration runs and rollbacks.' } ],
              signals: [ 'Schema diffs, integration errors', 'Throughput/OEE drift vs targets', 'Scrap/rework anomalies' ],
              proposes: [ 'New adapters and versioned contracts', 'Parameter updates and rollout gates', 'AB test plans and auto‑rollback' ] }
          },
          extra: {
            killer: {
              title: 'Featherweight → Supply Chain Kill Switch',
              logistics: {
                title: '1) Logistics Warehouses — AMRs & Trailer Unloaders',
                bullets: [
                  'Spiral Memory — learns SKU heatmaps, seasonality, and dock quirks; auto‑replans pick paths daily.',
                  'Self‑Coding — rewrites routing/slotting heuristics as SKU mix changes; no manual patching.',
                  'Sigil‑DNA — signed bot↔WMS handshakes; every pallet handoff is tamper‑proof.',
                  'HRG (Sim) — micro‑simulate awkward stacks pre‑grasp; choose suction/clamp/tilt to reduce stalls and damage.',
                  '100 Hz Loop — slow near humans, sprint in clear lanes; true cobot safety without cages.'
                ],
                roi: '+30–50% throughput/sq ft • −60% error returns • <18‑mo payback'
              },
              discrete: {
                title: '2) Discrete & Process Manufacturing — Cells, Lines, Cobots',
                rows: [
                  { pain: 'Changeovers kill uptime', fix: 'Spiral Memory recalls last good states; Self‑Coding emits new toolpaths', value: 'Hours → minutes; no integrator call' },
                  { pain: 'Late quality drift', fix: 'HRG “golden unit” streaming; live sensor diff', value: 'Scrap and rework down sharply' },
                  { pain: 'Cobots feel clumsy', fix: '100 Hz tactile control; smooth starts/handoffs', value: 'Safer cells, less fencing' },
                  { pain: 'Vendor lock‑in', fix: 'Sigil‑DNA identities for PLCs/grippers', value: 'Mix KUKA/ABB/Fanuc worry‑free' }
                ],
                foot: 'Drop NVIDIA Isaac/ROS 2 under the hood: GPU perception + Featherweight cognition = Tier‑1 autonomy.'
              }
            },
            pilot: {
              title: '3) 10‑Week Pilot — from talk to throughput',
              steps: [
                'Scope (W1–2): Pick one pain (e.g., unload or CNC tend). Wire sensors → seed Spiral Memory.',
                'Twin (W3–6): HRG sims on Isaac/ROS 2. Issue Sigil‑DNA certs for all devices.',
                'On‑Floor (W7–10): Deploy 1–3 bots; flip on 100 Hz loop. Track cycle time, OEE, incidents.',
                'Roll‑Out (Q2): Share memory across bays; bots exchange heuristics. Host a live demo.'
              ]
            },
            stack: {
              title: '4) Stack (works day one)',
              lists: [
                { k: 'Hardware', v: 'Stretch / Flexley / KR‑Series' },
                { k: 'Middleware', v: 'ROS 2 Humble or Isaac ROS GEMs' },
                { k: 'Featherweight', v: 'Spiral Memory svc • Sigil‑DNA gateway • HRG sim engine • Self‑Coding daemon • 100 Hz loop (Rust)' },
                { k: 'Compute', v: 'Jetson AGX Orin on‑prem + burst GPUs in cloud' }
              ]
            },
            investors: {
              title: '5) Why Investors Bite',
              bullets: [ 'Moat: self‑coding autonomy + signed device identity.', 'ARR: per‑robot license + metered sim credits.', 'ESG: energy‑aware loop trims power ~15%.' ],
              tagline: 'You’re not selling robots — you’re leasing living intelligence that mints OEE.'
            },
            reminders: {
              title: '3 Career‑Power Reminders',
              bullets: [
                'Ship a 2‑page “Featherweight × Industry 4.0” brief to ABB, Fanuc, BMW iVentures by Friday.',
                'Lock a ProMat 2025 demo slot; plan a joint stage moment with an AMR OEM.',
                'Cut a 60‑sec reel: HRG sim → real‑floor side‑by‑side → KPI pops. Post, tag operators & VCs.'
              ]
            },
            quote: '“Factories run on throughput. Empires run on imagination. Featherweight delivers both.”'
          }
        }
      };

      let BRIEFING_STATE = { vertical: null, feature: 'spiral', persona: 'investor' };

      function updateHash(){
        const { vertical, feature, persona } = BRIEFING_STATE;
        const params = new URLSearchParams();
        if (vertical) params.set('briefing', vertical);
        if (feature) params.set('feature', feature);
        if (persona) params.set('persona', persona);
        const hash = params.toString();
        if (hash) location.hash = '#' + hash; else history.replaceState('', document.title, window.location.pathname+window.location.search);
      }

      function openBriefing(vertical){
        BRIEFING_STATE.vertical = vertical;
        document.getElementById('briefingTitle').textContent = BRIEFING_DATA[vertical].title + ' — Briefing';
        renderBriefingBody();
        document.getElementById('briefingOverlay').classList.add('active');
        try { initHeaderHeart('briefingHeart'); } catch {}
        updateHash();
        // Ensure persona button reflects active state on open
        setPersona(BRIEFING_STATE.persona);
        // Lock scroll and trap focus
        try { document.body.dataset.prevOverflow = document.body.style.overflow; document.body.style.overflow = 'hidden'; } catch {}
        const ov = document.getElementById('briefingOverlay');
        if (ov) { ov.setAttribute('tabindex', '-1'); ov.focus(); setupFocusTrap(ov); }
      }
      function closeBriefing(){
        document.getElementById('briefingOverlay').classList.remove('active');
        BRIEFING_STATE.vertical = null; updateHash();
        // Restore scroll and focus
        try { document.body.style.overflow = document.body.dataset.prevOverflow || ''; } catch {}
        removeFocusTrap();
      }
      function setFeature(f){ BRIEFING_STATE.feature = f; renderBriefingBody(); updateHash();
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        const el = document.getElementById('tab-'+f); if (el) el.classList.add('active');
      }
      function setPersona(p){ BRIEFING_STATE.persona = p; ['investor','operator','engineer'].forEach(id=>{ const b=document.getElementById('persona-'+id); if(b) b.classList.toggle('active', id===p); }); renderBriefingBody(); updateHash(); }
      function renderBriefingBody(){
        const { vertical, feature } = BRIEFING_STATE;
        if (!vertical) return;
        const node = document.getElementById('briefingBody');
        const data = BRIEFING_DATA[vertical].features[feature];
        node.innerHTML = '';
        // Manufacturing-specific simple copy tweaks (placeholder)
        const title = BRIEFING_DATA[vertical].title || (vertical + ' — Briefing');
        const isMfg = (vertical === 'manufacturing');

        // If Manufacturing → render clean hero + context only, then stop
        if (isMfg) {
          const hero = document.createElement('section'); hero.className='video-hero';
          hero.innerHTML = `
            <video autoplay muted playsinline loop poster="/assets/verticals/${vertical}/hero-poster.jpg" aria-label="Cinematic background for ${vertical}">
              <source src="/assets/verticals/${vertical}/hero-1080.webm" type="video/webm">
              <source src="/assets/verticals/${vertical}/hero-1080.mp4" type="video/mp4">
            </video>
            <div class="container plate">
              <h1>${title}</h1>
              <p class="subhead">Make every shift faster and safer. Memory and simulation that raise throughput, cut scrap, and pass audits.</p>
              <nav class="inline-ctas">
                <button onclick="copyBriefLink()">Copy link</button>
                <button onclick="copyBriefMarkdown()">Copy brief</button>
                <button onclick="saveBriefMarkdown()">Save .md</button>
                <button onclick="startPilot()">Start a pilot</button>
              </nav>
            </div>`;
          node.appendChild(hero);

          const ctxStrip = document.createElement('section'); ctxStrip.className='context-strip';
          ctxStrip.innerHTML = `
            <div class="roles">
              <span class="chip" onclick="setPersona('investor')">Investor</span>
              <span class="chip" onclick="setPersona('operator')">Operator</span>
              <span class="chip" onclick="setPersona('engineer')">Engineer</span>
            </div>
            <div class="tech">
              <span class="chip" onclick="setFeature('spiral')">Spiral Memory</span>
              <span class="chip" onclick="setFeature('hrg')">Holographic Reality</span>
              <span class="chip" onclick="setFeature('sigil')">DNA Sigil Identity</span>
              <span class="chip" onclick="setFeature('selfcode')">Self-Coding</span>
            </div>
            <div class="persona">Persona: <strong>${BRIEFING_STATE.persona[0].toUpperCase()+BRIEFING_STATE.persona.slice(1)}</strong> — ${BRIEFING_STATE.persona==='investor'?'signal, moat, monetization':BRIEFING_STATE.persona==='operator'?'safety, uptime, throughput':'APIs, contracts, rollout gates'}</div>`;
          node.appendChild(ctxStrip);

          return;
        }
        // Persona preface and intro tone
        const personaNote = document.createElement('div'); personaNote.style.fontSize='12px'; personaNote.style.opacity='0.85'; personaNote.style.margin='-4px 0 10px 0';
        let introCopy = data.intro;
        if (BRIEFING_STATE.persona==='investor') { personaNote.textContent='Persona: Investor — signal, moat, monetization.'; }
        if (BRIEFING_STATE.persona==='operator') { personaNote.textContent='Persona: Operator — safety, uptime, throughput.'; }
        if (BRIEFING_STATE.persona==='engineer') { personaNote.textContent='Persona: Engineer — APIs, contracts, rollout gates.'; }
        node.appendChild(personaNote);
        const intro = document.createElement('p'); intro.textContent = (data.introPersona && data.introPersona[BRIEFING_STATE.persona]) ? data.introPersona[BRIEFING_STATE.persona] : introCopy; node.appendChild(intro);
        // Build new scaffold
        const hero = document.createElement('section'); hero.className='video-hero';
        hero.innerHTML = `
          <video autoplay muted playsinline loop poster="/assets/verticals/${vertical}/hero-poster.jpg" aria-label="Cinematic background for ${vertical}">
            <source src="/assets/verticals/${vertical}/hero-1080.webm" type="video/webm">
            <source src="/assets/verticals/${vertical}/hero-1080.mp4" type="video/mp4">
          </video>
          <div class="container plate">
            <h1>${title}</h1>
            <p class="subhead">${(data.introPersona && data.introPersona[BRIEFING_STATE.persona]) || data.intro}</p>
            <nav class="inline-ctas">
              <button onclick="copyBriefLink()">Copy link</button>
              <button onclick="copyBriefMarkdown()">Copy brief</button>
              <button onclick="saveBriefMarkdown()">Save .md</button>
              <button onclick="startPilot()">Start a pilot</button>
            </nav>
          </div>`;
        node.appendChild(hero);
        const ctxStrip = document.createElement('section'); ctxStrip.className='context-strip';
        ctxStrip.innerHTML = `<div class="roles"><span class="chip" onclick="setPersona('investor')">Investor</span><span class="chip" onclick="setPersona('operator')">Operator</span><span class="chip" onclick="setPersona('engineer')">Engineer</span></div><div class="tech"><span class="chip" onclick="setFeature('spiral')">Spiral Memory</span><span class="chip" onclick="setFeature('hrg')">Holographic Reality</span><span class="chip" onclick="setFeature('sigil')">DNA Sigil Identity</span><span class="chip" onclick="setFeature('selfcode')">Self-Coding</span></div><div class="persona">Persona: <strong>${BRIEFING_STATE.persona[0].toUpperCase()+BRIEFING_STATE.persona.slice(1)}</strong> — ${BRIEFING_STATE.persona==='investor'?'signal, moat, monetization':BRIEFING_STATE.persona==='operator'?'safety, uptime, throughput':'APIs, contracts, rollout gates'}</div>`;
        node.appendChild(ctxStrip);
        if (isMfg) {
          // Keep it minimal: stop here to preserve the clean card format
          return;
        }
        // Use cases
        const ucAnchor=document.createElement('div'); ucAnchor.id='brief-use-cases'; node.appendChild(ucAnchor);
        data.usecases.forEach(u => {
          const det = document.createElement('details'); det.className='usecase';
          const sum = document.createElement('summary'); sum.innerHTML = `<strong>${u.title}</strong>`; det.appendChild(sum);
          const p = document.createElement('p'); p.textContent = u.body; det.appendChild(p);
          const btn = document.createElement('button'); btn.className='tab'; btn.textContent='See example'; btn.onclick=()=>openExample(u.title, u.body);
          det.appendChild(btn);
          node.appendChild(det);
        });
        // Signals and Proposes sections if present
        if (Array.isArray(data.signals) && data.signals.length){
          const sigAnchor=document.createElement('div'); sigAnchor.id='brief-signals'; node.appendChild(sigAnchor);
          const h=document.createElement('h3'); h.className='section-subtitle'; h.textContent='Signals used'; node.appendChild(h);
          const ul=document.createElement('ul'); ul.className='list'; data.signals.forEach(s=>{ const li=document.createElement('li'); li.textContent=s; ul.appendChild(li); }); node.appendChild(ul);
        }
        if (Array.isArray(data.proposes) && data.proposes.length){
          const propAnchor=document.createElement('div'); propAnchor.id='brief-proposes'; node.appendChild(propAnchor);
          const h=document.createElement('h3'); h.className='section-subtitle'; h.textContent='What the system proposes'; node.appendChild(h);
          const ul=document.createElement('ul'); ul.className='list'; data.proposes.forEach(s=>{ const li=document.createElement('li'); li.textContent=s; ul.appendChild(li); }); node.appendChild(ul);
        }
        // Extra vertical content (playbook)
        const extra = BRIEFING_DATA[vertical].extra;
        if (extra){
          const hr = () => { const d=document.createElement('div'); d.className='hr'; node.appendChild(d); };
          // Lightweight goal switcher (reorders sections)
          const goals = ['wins','modules','pilot','gtm','stack','investors'];
          const goalBar = document.createElement('div'); goalBar.style.display='flex'; goalBar.style.gap='8px'; goalBar.style.justifyContent='center'; goalBar.style.margin='10px 0';
          goals.forEach(g=>{
            const btn=document.createElement('button'); btn.className='tab'; btn.textContent=g.toUpperCase(); btn.onclick=()=>{
              const a=BRIEFING_DATA[vertical].extra || {};
              const presentGoals = goals.filter(k=>a[k]);
              // Bring clicked goal to front among known goals
              const prioritized = [g, ...presentGoals.filter(k=>k!==g)];
              const rest = Object.keys(a).filter(k=>!presentGoals.includes(k));
              const orderedKeys = [...new Set([...prioritized, ...rest])];
              const ordered={}; orderedKeys.forEach(k=>{ if (a[k]) ordered[k]=a[k]; });
              BRIEFING_DATA[vertical].extra = ordered; renderBriefingBody(); updateHash();
            }; goalBar.appendChild(btn);
          });
          node.appendChild(goalBar);
          if (extra.modules){ if(!document.getElementById('brief-extras')){ const anchor=document.createElement('div'); anchor.id='brief-extras'; node.appendChild(anchor); }
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.modules.title; b.appendChild(h3);
            const mod = document.createElement('div'); mod.className='modules';
            extra.modules.groups.forEach(g=>{
              const h4 = document.createElement('h4'); h4.textContent = g.name; mod.appendChild(h4);
              const ul = document.createElement('ul'); g.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); }); mod.appendChild(ul);
            });
            b.appendChild(mod); node.appendChild(b);
          }
          if (extra.wins){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.wins.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.wins.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); }); b.appendChild(ul);
            node.appendChild(b);
          }
          if (extra.killer){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.killer.title; b.appendChild(h3);
            // Logistics
            const l1h = document.createElement('h4'); l1h.textContent = extra.killer.logistics.title; b.appendChild(l1h);
            const ul1 = document.createElement('ul'); ul1.className='list'; extra.killer.logistics.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul1.appendChild(li); }); b.appendChild(ul1);
            const roi = document.createElement('p'); roi.style.fontStyle='italic'; roi.textContent = 'ROI quick math: ' + extra.killer.logistics.roi; b.appendChild(roi);
            // Discrete/process
            const l2h = document.createElement('h4'); l2h.textContent = extra.killer.discrete.title; b.appendChild(l2h);
            const ul2 = document.createElement('ul'); ul2.className='list'; extra.killer.discrete.rows.forEach(r=>{ const li=document.createElement('li'); li.textContent = `Pain: ${r.pain} • Fix: ${r.fix} • Value: ${r.value}`; ul2.appendChild(li); }); b.appendChild(ul2);
            const foot = document.createElement('p'); foot.textContent = extra.killer.discrete.foot; b.appendChild(foot);
            node.appendChild(b);
          }
          if (extra.pilot){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.pilot.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.pilot.steps.forEach(s=>{ const li=document.createElement('li'); li.textContent=s; ul.appendChild(li); }); b.appendChild(ul);
            if (extra.pilot.monetize){ const p=document.createElement('p'); p.style.fontStyle='italic'; p.textContent=extra.pilot.monetize; b.appendChild(p); }
            node.appendChild(b);
          }
          if (extra.gtm){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.gtm.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.gtm.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); }); b.appendChild(ul);
            node.appendChild(b);
          }
          if (extra.stack){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.stack.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.stack.lists.forEach(s=>{ const li=document.createElement('li'); li.textContent=`${s.k}: ${s.v}`; ul.appendChild(li); }); b.appendChild(ul);
            node.appendChild(b);
          }
          if (extra.surfaces){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.surfaces.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list';
            extra.surfaces.rows.forEach(r=>{ const li=document.createElement('li'); li.textContent = `${r.surface} — Pain: ${r.pain} | Fix: ${r.fix} | Outcome: ${r.outcome}`; ul.appendChild(li); });
            b.appendChild(ul); node.appendChild(b);
          }
          if (extra.guardrails){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.guardrails.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.guardrails.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); });
            b.appendChild(ul); node.appendChild(b);
          }
          if (extra.compliance){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.compliance.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.compliance.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); });
            b.appendChild(ul); node.appendChild(b);
          }
          if (extra.pricing){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.pricing.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.pricing.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); });
            b.appendChild(ul); node.appendChild(b);
          }
          if (extra.demos){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.demos.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.demos.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); });
            b.appendChild(ul); node.appendChild(b);
          }
          if (extra.investors){
            hr();
            const b = document.createElement('div'); b.className='blk';
            const h3 = document.createElement('h3'); h3.textContent = extra.investors.title; b.appendChild(h3);
            const ul = document.createElement('ul'); ul.className='list'; extra.investors.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); }); b.appendChild(ul);
            const tag = document.createElement('p'); tag.style.fontWeight='600'; tag.textContent = extra.investors.tagline; b.appendChild(tag);
            node.appendChild(b);
          }
          if (extra.tagline && !extra.investors){
            const tag = document.createElement('p'); tag.style.fontWeight='600'; tag.textContent = extra.tagline; node.appendChild(tag);
          }
          if (extra.reminders){
            hr();
            const b=document.createElement('div'); b.className='blk'; const h3=document.createElement('h3'); h3.textContent=extra.reminders.title; b.appendChild(h3);
            const ul=document.createElement('ul'); ul.className='list'; extra.reminders.bullets.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); }); b.appendChild(ul); node.appendChild(b);
          }
          if (extra.quote){ const q=document.createElement('p'); q.style.fontStyle='italic'; q.style.marginTop='10px'; q.textContent=extra.quote; node.appendChild(q); }
          if (extra.closing){ const c=document.createElement('p'); c.style.marginTop='6px'; c.textContent=extra.closing; node.appendChild(c); }
        }
      }
      // Close on ESC
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeBriefing(); });
      function copyBriefLink(){
        try { navigator.clipboard.writeText(location.href); alert('Link copied'); } catch { prompt('Copy this link:', location.href); }
      }
      function copyBriefMarkdown(){
        const v = BRIEFING_STATE.vertical; const f = BRIEFING_STATE.feature; const p = BRIEFING_STATE.persona;
        const title = `${BRIEFING_DATA[v].title} — ${f} (${p})`;
        const link = location.href;
        const md = `# ${title}\n\nLink: ${link}`;
        try { navigator.clipboard.writeText(md); alert('Brief copied'); } catch { prompt('Copy this brief:', md); }
      }
      function saveBriefMarkdown(){
        const v = BRIEFING_STATE.vertical; const f = BRIEFING_STATE.feature; const p = BRIEFING_STATE.persona;
        const title = `${BRIEFING_DATA[v].title} — ${f} (${p})`;
        const link = location.href;
        const md = `# ${title}\n\nLink: ${link}`;
        const blob = new Blob([md], { type: 'text/markdown' });
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = title.replace(/[^a-z0-9\-\s]/gi,'_') + '.md';
        document.body.appendChild(a); a.click(); setTimeout(()=>{ URL.revokeObjectURL(a.href); a.remove(); }, 1500);
      }
      // Simple focus trap for accessibility
      let _focusTrap = null;
      function setupFocusTrap(container){
        const selectors = 'a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])';
        const nodes = () => Array.from(container.querySelectorAll(selectors)).filter(el=>!el.disabled && el.offsetParent!==null);
        const handler = (e)=>{
          if (e.key !== 'Tab') return;
          const list = nodes(); if (!list.length) return;
          const first = list[0], last = list[list.length-1];
          if (e.shiftKey && document.activeElement === first){ last.focus(); e.preventDefault(); }
          else if (!e.shiftKey && document.activeElement === last){ first.focus(); e.preventDefault(); }
        };
        container.addEventListener('keydown', handler); _focusTrap = { container, handler };
      }
      function removeFocusTrap(){ if(_focusTrap){ _focusTrap.container.removeEventListener('keydown', _focusTrap.handler); _focusTrap = null; } }
      function startPilot(){
        const v = BRIEFING_STATE.vertical; const f = BRIEFING_STATE.feature; const p = BRIEFING_STATE.persona;
        const subject = encodeURIComponent(`Pilot inquiry — ${v} × ${f}`);
        const body = encodeURIComponent(`Persona: ${p}\nVertical: ${v}\nFeature: ${f}\nLink: ${location.href}\n\nGoals:\n- \n- \n`);
        location.href = `mailto:hello@featherweight.world?subject=${subject}&body=${body}`;
      }
      function exportBrief(){
        // Inject print meta
        const meta = document.getElementById('printMeta');
        const now = new Date();
        const who = BRIEFING_STATE.persona;
        const feat = BRIEFING_STATE.feature;
        const vert = BRIEFING_STATE.vertical && BRIEFING_DATA[BRIEFING_STATE.vertical] ? BRIEFING_DATA[BRIEFING_STATE.vertical].title : '';
        meta.textContent = `Generated ${now.toLocaleString()} • Persona: ${who} • Feature: ${feat} • Vertical: ${vert}`;
        // Print only the overlay
        const others = [];
        document.querySelectorAll('body > *:not(#briefingOverlay)').forEach(el=>{ const cur = el.style.display; others.push([el, cur]); el.style.display='none'; });
        window.print();
        others.forEach(([el,cur])=>{ el.style.display=cur; });
      }
      // Simple modal for examples (replace later with rich content)
      function openExample(title, body){
        let modal = document.getElementById('exampleModal');
        if (!modal){
          modal = document.createElement('div'); modal.id='exampleModal'; modal.className='modal';
          modal.innerHTML = `<div class="modal-content"><h4 id="exampleTitle"></h4><div id="exampleBody" style="white-space:pre-wrap;opacity:0.9"></div><div class="modal-actions"><button class="tab" onclick="startPilot()">Start a pilot</button><button class="tab" onclick="closeExample()">Close</button></div></div>`;
          document.body.appendChild(modal);
          modal.addEventListener('click', (e)=>{ if(e.target===modal) closeExample(); });
        }
        document.getElementById('exampleTitle').textContent = title;
        document.getElementById('exampleBody').textContent = `How it works:\n• ${body}\n\nWe can show a live demo for your data.`;
        modal.classList.add('active');
      }
      function closeExample(){ const modal=document.getElementById('exampleModal'); if(modal) modal.classList.remove('active'); }
      // Deep link on load
      (function(){
        const parse = ()=>{
          const h = location.hash.startsWith('#') ? location.hash.slice(1) : location.hash;
          const params = new URLSearchParams(h);
          const v = params.get('briefing'); const f = params.get('feature'); const p = params.get('persona');
          if (v && BRIEFING_DATA[v]) {
            BRIEFING_STATE.vertical = v;
            if (f) BRIEFING_STATE.feature = f;
            if (p) BRIEFING_STATE.persona = p;
            document.getElementById('briefingTitle').textContent = BRIEFING_DATA[v].title + ' — Briefing';
            renderBriefingBody(); document.getElementById('briefingOverlay').classList.add('active');
            try { initHeaderHeart('briefingHeart'); } catch {}
            // Enforce active states for tabs/persona from hash
            try { setFeature(BRIEFING_STATE.feature); setPersona(BRIEFING_STATE.persona); } catch {}
          }
        };
        window.addEventListener('hashchange', parse);
        parse();
      })();
    </script>

    <!-- Contact Form Handler -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Preloader controller
            (function(){
              const pre = document.getElementById('preloader');
              if (!pre) return;
              const txt = pre.querySelector('.preloader-text');
              const bar = pre.querySelector('.preloader-bar');
              let minShownMs = 520;
              const start = performance.now();
              let done = false;
              function setProgress(p){
                const pct = Math.max(0, Math.min(100, Math.round(p)));
                if (txt) txt.textContent = `Loading ${pct}%`;
                if (bar) bar.style.width = pct + '%';
              }
              // Dots pulse for very slow/unknown loads
              let dotsTimer = null; let dots = 0; let dotsActive = true;
              function startDots(){ if (dotsTimer) return; dotsTimer = setInterval(()=>{ if (!dotsActive || !txt) return; dots = (dots+1)%4; const base = txt.textContent.replace(/\.*$/, ''); txt.textContent = `${base}${'.'.repeat(dots)}`; }, 500); }
              function stopDots(){ dotsActive = false; if (dotsTimer) { clearInterval(dotsTimer); dotsTimer = null; } }
              startDots();
              setProgress(8);
              // Body preload state for crossfade handoff
              try { document.body.classList.add('preload-active'); } catch {}
              // Try to wait for fonts, if supported
              if (document.fonts && document.fonts.ready) {
                document.fonts.ready.then(()=>{ /* noop: ensures text metrics are stable before first paint */ }).catch(()=>{});
              }
              // Listen for heart loader progress and ready
              window.addEventListener('fw-heart-progress', (e)=>{
                if (done) return;
                const p = e && e.detail && typeof e.detail.progress === 'number' ? e.detail.progress*100 : 60;
                setProgress(p);
                if (p >= 15) stopDots();
              });
              // Finish when heart is ready and at least one frame rendered, and fonts settled
              let heartReady = false; let heartFramed = false; let fontsReady = !document.fonts || !document.fonts.ready;
              if (document.fonts && document.fonts.ready) {
                document.fonts.ready.then(()=>{ fontsReady = true; tryFinish(); }).catch(()=>{ fontsReady = true; tryFinish(); });
              }
              function tryFinish(){ if (heartReady && heartFramed && fontsReady) finish(); }
              window.addEventListener('fw-heart-ready', ()=>{ heartReady = true; tryFinish(); });
              window.addEventListener('fw-heart-first-frame', ()=>{ heartFramed = true; tryFinish(); });
              // Sync spinner deceleration on first frame
              window.addEventListener('fw-heart-first-frame', ()=>{
                try {
                  const sp = pre.querySelector('.spinner');
                  if (sp) { sp.style.setProperty('--spin-dur', '1.2s'); setTimeout(()=>{ sp.style.setProperty('--spin-dur','1.6s'); }, 400); }
                } catch {}
              });
              // Safety timeout fallback
              // Network idle-ish fallback: if no heart events, finish after 6s, else extend a bit
              let sawProgress = false; let lastProgressAt = performance.now();
              window.addEventListener('fw-heart-progress', ()=>{ sawProgress = true; lastProgressAt = performance.now(); });
              const safety = setTimeout(()=>{ const idle = performance.now() - lastProgressAt; if (!sawProgress || idle > 1000) finish(); else setTimeout(()=>finish(), Math.max(0, 800 - idle)); }, 2500);
              function finish(){
                if (done) return; done = true; clearTimeout(safety);
                const elapsed = performance.now() - start;
                const wait = Math.max(0, minShownMs - elapsed);
                setTimeout(()=>{
                  // Final progress to 100% with micro-delay for perceived completeness
                  setProgress(100);
                  stopDots();
                  setTimeout(()=>{
                    pre.classList.add('hidden'); pre.setAttribute('aria-hidden','true');
                    try { document.body.classList.remove('preload-active'); } catch {}
                  }, 80);
                }, wait);
              }
            })();
            const contactForm = document.getElementById('contactForm');
            const submitBtn = document.getElementById('submitBtn');
            const feedback = document.getElementById('contactFeedback');
            if (feedback) { feedback.setAttribute('role','status'); feedback.setAttribute('aria-live','polite'); }
            // Character counter and Ctrl+Enter submit
            const msg = document.querySelector('textarea[name="message"]');
            const counter = document.getElementById('messageCounter');
            function updateCounter(){ if (!msg || !counter) return; const max = msg.getAttribute('maxlength') || 2000; const len = msg.value.length; counter.textContent = `${len}/${max}`; }
            if (msg){ msg.addEventListener('input', updateCounter); msg.addEventListener('keydown', (e)=>{ if ((e.ctrlKey||e.metaKey) && e.key === 'Enter'){ contactForm.requestSubmit(); } }); updateCounter(); }
            // Spam guard: ignore if hidden honeypot has content or form submitted too quickly
            const honeypot = contactForm.querySelector('input[name="company"]');
            const formStart = performance.now();
            // Basic client validation: prevent empty/invalid submits and guide users
            function validate(){
              const name = contactForm.querySelector('input[name="name"]');
              const email = contactForm.querySelector('input[name="email"]');
              const message = contactForm.querySelector('textarea[name="message"]');
              let ok = true;
              [name,email,message].forEach(f=>{ if(!f) return; if(!f.value || (f.type==='email' && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.value))){ ok=false; f.classList.add('invalid'); } else { f.classList.remove('invalid'); } });
              return ok;
            }
            contactForm.addEventListener('input', (e)=>{ const t=e.target; if(t && t.classList.contains('invalid')) t.classList.remove('invalid'); });
            
            contactForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                if (!validate()) {
                    feedback.className = 'contact-feedback error';
                    feedback.textContent = 'Please fill out all fields with a valid email.';
                    feedback.style.display = 'block'; feedback.style.opacity = '1'; feedback.style.transform = 'translateY(0)';
                    return;
                }
                if (honeypot && honeypot.value) { return; }
                if (performance.now() - formStart < 800) { return; }
                // Disable submit button and show loading
                submitBtn.disabled = true;
                submitBtn.classList.add('loading');
                submitBtn.textContent = 'SENDING...';
                feedback.style.display = 'none';
                
                try {
                    // Get form data
                    const formData = new FormData(contactForm);
                    const data = {
                        name: formData.get('name'),
                        email: formData.get('email'),
                        message: formData.get('message'),
                         company: formData.get('company') || '',
                        investor: formData.get('investor') === 'on',
                        researcher: formData.get('researcher') === 'on'
                    };
                    
                    // Submit to backend
                    const response = await fetch('/api/contact', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok && result.success) {
                        // Success
                        feedback.className = 'contact-feedback success';
                        feedback.textContent = result.message || 'Thank you for your message! We will get back to you soon.';
                        feedback.style.display = 'block'; feedback.style.opacity = '1'; feedback.style.transform = 'translateY(0)';
                        
                        // Reset form
                        contactForm.reset();
                        // Return focus to name for quick second send
                        const nameEl = contactForm.querySelector('input[name="name"]'); if (nameEl) nameEl.focus();
                        
                        // Auto-hide success message after 5 seconds
                        setTimeout(() => {
                            feedback.style.display = 'none';
                        }, 5000);
                    } else {
                        // Error from server
                        feedback.className = 'contact-feedback error';
                        feedback.textContent = result.error || 'Something went wrong. Please try again.';
                        feedback.style.display = 'block'; feedback.style.opacity = '1'; feedback.style.transform = 'translateY(0)';
                    }
                } catch (error) {
                    // Network or other error
                    console.error('Contact form error:', error);
                    feedback.className = 'contact-feedback error';
                    feedback.textContent = 'Network error. Please check your connection and try again.';
                    feedback.style.display = 'block'; feedback.style.opacity = '1'; feedback.style.transform = 'translateY(0)';
                } finally {
                    // Re-enable submit button
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('loading');
                    submitBtn.textContent = 'SEND MESSAGE';
                }
            });
        });
    </script>
    
    <!-- CONSCIOUSNESS TECHNOLOGY ANIMATIONS -->
    <script>
        // Initialize all consciousness technology animations
        document.addEventListener('DOMContentLoaded', function() {
            // Robust loader to ensure THREE and passes are available even if CDNs race or are blocked
            function loadScript(src) {
                return new Promise((resolve, reject) => {
                    const s = document.createElement('script');
                    s.src = src;
                    s.async = true;
                    s.defer = true;
                    s.onload = () => resolve(true);
                    s.onerror = () => reject(new Error('Failed to load ' + src));
                    document.head.appendChild(s);
                });
            }
            async function ensureThreeAndPasses() {
                if (!window.THREE) {
                    try {
                        await loadScript('https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js');
                    } catch {
                        await loadScript('https://unpkg.com/three@0.128.0/build/three.min.js');
                    }
                }
                // Load example passes and loaders only if missing
                if (!THREE.GLTFLoader) {
                    try { await loadScript('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js'); }
                    catch { await loadScript('https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js'); }
                }
                if (!THREE.EffectComposer) {
                    try { await loadScript('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js'); }
                    catch { await loadScript('https://unpkg.com/three@0.128.0/examples/js/postprocessing/EffectComposer.js'); }
                }
                if (!THREE.RenderPass) {
                    try { await loadScript('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js'); }
                    catch { await loadScript('https://unpkg.com/three@0.128.0/examples/js/postprocessing/RenderPass.js'); }
                }
                if (!THREE.ShaderPass) {
                    try { await loadScript('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/ShaderPass.js'); }
                    catch { await loadScript('https://unpkg.com/three@0.128.0/examples/js/postprocessing/ShaderPass.js'); }
                }
                if (!THREE.UnrealBloomPass) {
                    try { await loadScript('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.js'); }
                    catch { await loadScript('https://unpkg.com/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.js'); }
                }
                if (!THREE.FXAAShader) {
                    try { await loadScript('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/FXAAShader.js'); }
                    catch { await loadScript('https://unpkg.com/three@0.128.0/examples/js/shaders/FXAAShader.js'); }
                }
            }
            console.log('🧠 Initializing consciousness technology animations...');

            // Helpers: canvas activity gating and scroll shadows
            window.createCanvasActivityGate = function(canvas){
                const state = { inView: true, hidden: document.hidden };
                try {
                    if ('IntersectionObserver' in window) {
                        const io = new IntersectionObserver((entries)=>{
                            entries.forEach(e=>{ if (e.target === canvas) state.inView = e.isIntersecting; });
                        }, { root: null, threshold: 0 });
                        io.observe(canvas);
                    }
                } catch {}
                document.addEventListener('visibilitychange', ()=>{ state.hidden = document.hidden; }, { passive: true });
                return { get active(){ return !state.hidden && state.inView; } };
            };

            function setupScrollShadows(container){
                if (!container) return;
                function update(){
                    const atTop = container.scrollTop <= 0;
                    const atBottom = Math.ceil(container.scrollTop + container.clientHeight) >= container.scrollHeight;
                    container.classList.toggle('at-top', atTop);
                    container.classList.toggle('at-bottom', atBottom);
                }
                container.addEventListener('scroll', update, { passive: true });
                update();
            }

            // Robust menu toggle without accidental close from global listeners
        (function initMenuToggle(){ /* removed header menu */ })();

            // Desktop mouse parallax tracker
            (function initMouseParallax() {
                const isMobile = window.matchMedia('(max-width: 768px)').matches;
                if (isMobile) return;
                window.__fwMouse = { x: 0, y: 0 };
                window.addEventListener('mousemove', (e) => {
                    const cx = window.innerWidth / 2;
                    const cy = window.innerHeight / 2;
                    window.__fwMouse.x = (e.clientX - cx) / cx; // -1..1
                    window.__fwMouse.y = (e.clientY - cy) / cy; // -1..1
                }, { passive: true });
            })();

            ensureThreeAndPasses().then(() => {
                try { console.log('🧠 Starting heart background...'); initHeartBackgroundAnimation(); } catch (e) { console.error('❌ Heart background error:', e); }
                try { console.log('🌀 Starting spiral memory...'); initSpiralMemoryAnimation(); } catch (e) { console.error('❌ Spiral memory error:', e); }
                try { console.log('🔮 Starting holographic reality...'); initHolographicRealityAnimation(); } catch (e) { console.error('❌ Holographic reality error:', e); }
                try { console.log('🧬 Starting DNA sigil...'); initDNASigilAnimation(); } catch (e) { console.error('❌ DNA sigil error:', e); }
                try { console.log('🛠️ Starting self coding canvas...'); initSelfCodingAnimation(); } catch (e) { console.error('❌ Self coding error:', e); }
                // Force reveal visibility for feature canvases in case IO fails
                document.querySelectorAll('.feature-visual').forEach(el => el.classList.add('in-view'));
            }).catch((e) => {
                console.error('Failed to ensure THREE scripts:', e);
            });
            // Setup scroll shadows for briefing content
            setupScrollShadows(document.querySelector('.briefing-content'));
        });

        // 3D HEART BACKGROUND - Realistic heart GLB with code text shader
        function initHeartBackgroundAnimation() {
            console.log('🧠 Heart animation starting...');
            const canvas = document.getElementById('heartBackgroundCanvas');
            if (!canvas) {
                console.error('❌ Heart canvas not found!');
                return;
            }
            console.log('✅ Heart canvas found:', canvas);

            if (!window.THREE) {
                console.error('❌ THREE.js not loaded!');
                return;
            }
            console.log('✅ THREE.js loaded');

            if (!THREE.GLTFLoader) {
                console.error('❌ GLTFLoader not available!');
                return;
            }
            console.log('✅ GLTFLoader available');

            const scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.02);
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });

            // High DPI scaling with mobile guard
            const isMobileHeart = window.matchMedia('(max-width: 768px)').matches;
            const DPR_HRT = Math.min(window.devicePixelRatio || 1, isMobileHeart ? 1.25 : 2);
            renderer.setPixelRatio(DPR_HRT);

            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x000000, 1);
            console.log('✅ Heart renderer initialized');

            // Load the realistic heart GLB model
            const loader = new THREE.GLTFLoader();
            let heartModel = null;

            function createPlaceholderHeart() {
                try {
                    const geom = new THREE.TorusKnotGeometry(3.5, 0.9, 220, 36, 2, 3);
                    const mat = new THREE.MeshStandardMaterial({ color: 0x00d0ff, metalness: 0.3, roughness: 0.25, emissive: 0x003344, emissiveIntensity: 0.35 });
                    const mesh = new THREE.Mesh(geom, mat);
                    mesh.castShadow = true; mesh.receiveShadow = true;
                    scene.add(mesh);
                    heartModel = mesh;
                    try { window.dispatchEvent(new CustomEvent('fw-heart-ready')); } catch(_){ }
                } catch(e) {
                    console.error('Placeholder heart failed:', e);
                }
            }

            // Create ultra-sophisticated consciousness code shader with frost effect
            let consciousnessCodeShaderMaterial;
            try {
                consciousnessCodeShaderMaterial = new THREE.ShaderMaterial({
                    uniforms: {
                        time: { value: 0 },
                        scrollDepth: { value: 0 },
                        resolution: { value: new THREE.Vector2(window.innerWidth, window.innerHeight) },
                        lightDir1: { value: new THREE.Vector3(0.6, 0.5, 0.2).normalize() },
                        lightDir2: { value: new THREE.Vector3(-0.4, 0.3, -0.7).normalize() },
                        fogColor: { value: new THREE.Color(0x001018) },
                        fogDensity: { value: 0.035 },
                        pulse: { value: 0.0 }
                    },
                vertexShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vNormal;
                    varying vec3 vWorldPosition;
                    varying vec3 vViewPosition;
                    varying float vDepth;
                    uniform float time;
                    uniform float scrollDepth;

                    void main() {
                        vUv = uv;
                        vPosition = position;
                        vNormal = normalize(normalMatrix * normal);

                        vec4 worldPosition = modelMatrix * vec4(position, 1.0);
                        vWorldPosition = worldPosition.xyz;

                        vec4 viewPosition = modelViewMatrix * vec4(position, 1.0);
                        vViewPosition = viewPosition.xyz;
                        vDepth = -viewPosition.z;

                        gl_Position = projectionMatrix * viewPosition;
                    }
                `,
                fragmentShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vNormal;
                    varying vec3 vWorldPosition;
                    varying vec3 vViewPosition;
                    varying float vDepth;
                    uniform float time;
                    uniform float scrollDepth;
                    uniform vec2 resolution;
                    uniform vec3 lightDir1;
                    uniform vec3 lightDir2;
                    uniform vec3 fogColor;
                    uniform float fogDensity;
                    uniform float pulse;

                    // High-quality noise functions
                    float random(vec2 st) {
                        return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
                    }

                    float noise(vec2 st) {
                        vec2 i = floor(st);
                        vec2 f = fract(st);
                        float a = random(i);
                        float b = random(i + vec2(1.0, 0.0));
                        float c = random(i + vec2(0.0, 1.0));
                        float d = random(i + vec2(1.0, 1.0));
                        vec2 u = f * f * (3.0 - 2.0 * f);
                        return mix(a, b, u.x) + (c - a)* u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
                    }

                    // Fractal noise for sophisticated effects
                    float fbm(vec2 st) {
                        float value = 0.0;
                        float amplitude = 0.5;
                        float frequency = 0.0;
                        for (int i = 0; i < 6; i++) {
                            value += amplitude * noise(st);
                            st *= 2.0;
                            amplitude *= 0.5;
                        }
                        return value;
                    }

                    // 3D value noise (approx) using hashed lattice
                    float hash(vec3 p){ return fract(sin(dot(p, vec3(127.1,311.7, 74.7))) * 43758.5453123); }
                    float noise3(vec3 x){
                        vec3 i = floor(x);
                        vec3 f = fract(x);
                        f = f*f*(3.0-2.0*f);
                        float n = mix(mix(mix( hash(i+vec3(0,0,0)), hash(i+vec3(1,0,0)), f.x),
                                          mix( hash(i+vec3(0,1,0)), hash(i+vec3(1,1,0)), f.x), f.y),
                                     mix(mix( hash(i+vec3(0,0,1)), hash(i+vec3(1,0,1)), f.x),
                                          mix( hash(i+vec3(0,1,1)), hash(i+vec3(1,1,1)), f.x), f.y), f.z);
                        return n;
                    }

                    // Ultra-sophisticated character generation with actual readable digits
                    float digit(vec2 uv, int num) {
                        uv = fract(uv);
                        float d = 1e10;

                        // Define digit patterns using distance fields
                        if (num == 0) {
                            vec2 center = vec2(0.5, 0.5);
                            float outer = length(uv - center) - 0.35;
                            float inner = length(uv - center) - 0.2;
                            d = max(outer, -inner);
                        } else if (num == 1) {
                            d = abs(uv.x - 0.5) - 0.05;
                        } else if (num == 2) {
                            float top = max(abs(uv.y - 0.8) - 0.1, abs(uv.x - 0.5) - 0.3);
                            float mid = max(abs(uv.y - 0.5) - 0.05, abs(uv.x - 0.5) - 0.3);
                            float bot = max(abs(uv.y - 0.2) - 0.1, abs(uv.x - 0.5) - 0.3);
                            d = min(min(top, mid), bot);
                        }
                        // Add more digits as needed...

                        return 1.0 - smoothstep(0.0, 0.02, d);
                    }

                    // Advanced character rendering
                    float renderChar(vec2 uv, float seed) {
                        vec2 grid = fract(uv * 40.0); // Bigger characters
                        vec2 id = floor(uv * 40.0);

                        float r = random(id + seed);
                        int charType = int(r * 10.0);

                        float char = 0.0;

                        if (charType < 5) {
                            // Numbers 0-4
                            char = digit(grid, charType);
                        } else if (charType < 8) {
                            // Binary
                            char = step(0.5, random(grid + seed)) *
                                   step(0.3, sin(grid.x * 20.0)) *
                                   step(0.3, sin(grid.y * 20.0));
                        } else {
                            // Consciousness symbols
                            float symbol = 0.0;
                            symbol += step(0.7, sin(grid.x * 15.0 + grid.y * 15.0));
                            symbol += step(0.8, cos(grid.x * 25.0) * sin(grid.y * 25.0));
                            char = symbol;
                        }

                        return char;
                    }

                    // Sophisticated frost effect
                    float frostPattern(vec2 uv, float intensity) {
                        vec2 st = uv * 8.0;
                        float frost = 0.0;

                        // Multiple octaves of frost crystals
                        for (int i = 0; i < 4; i++) {
                            float scale = pow(2.0, float(i));
                            vec2 frostUv = st * scale;

                            // Crystal-like patterns
                            float crystal = abs(sin(frostUv.x * 3.14159)) * abs(sin(frostUv.y * 3.14159));
                            crystal = pow(crystal, 2.0 + intensity * 3.0);

                            // Hexagonal patterns
                            vec2 hex = frostUv;
                            hex.x *= 0.57735 * 2.0;
                            hex.y += mod(floor(hex.x), 2.0) * 0.5;
                            hex = abs((mod(hex, 1.0) - 0.5));
                            float hexPattern = abs(max(hex.x * 1.5 + hex.y, hex.y * 2.0) - 1.0);

                            frost += crystal * hexPattern * (1.0 / scale);
                        }

                        return frost * intensity;
                    }

                    // Ultra-sophisticated consciousness code rain
                    vec3 consciousnessRain(vec2 uv) {
                        vec3 color = vec3(0.0);

                        // Multiple sophisticated layers
                        for (int i = 0; i < 6; i++) {
                            float layer = float(i);
                            vec2 rainUv = uv;

                            // Varied speeds and directions
                            float speed = 1.0 + layer * 0.3;
                            rainUv.y += time * speed;
                            rainUv.x += sin(time * 0.5 + layer) * 0.1;

                            // Generate high-quality characters
                            float char = renderChar(rainUv, layer + time * 0.1);

                            // Sophisticated trail with depth
                            float trail = smoothstep(0.0, 0.4, fract(rainUv.y));
                            trail *= smoothstep(1.0, 0.6, fract(rainUv.y));
                            trail = pow(trail, 1.5);

                            // Depth-based intensity
                            float intensity = (1.0 - layer * 0.12) * trail;

                            // Sophisticated color palette
                            vec3 layerColor;
                            if (char > 0.9) {
                                layerColor = vec3(1.0, 1.0, 1.0); // Pure white highlights
                            } else if (char > 0.7) {
                                layerColor = vec3(0.8, 1.0, 0.9); // Bright cyan-white
                            } else if (char > 0.5) {
                                layerColor = vec3(0.0, 0.9, 0.6); // Matrix green
                            } else {
                                layerColor = vec3(0.0, 0.6, 0.8); // Consciousness blue
                            }

                            color += layerColor * char * intensity;
                        }

                        return color;
                    }

                    void main() {
                        vec2 uv = vUv;

                        // Use world position for consistent mapping
                        vec2 worldUv = vWorldPosition.xy * 0.3 + 0.5;

                        // Consciousness code rain effect
                        vec3 codeColor = consciousnessRain(worldUv);

                        // Frost effect that increases with scroll depth
                        float frostIntensity = scrollDepth * 0.8;
                        float frost = frostPattern(uv, frostIntensity);

                        // Depth-based effects
                        float depthFactor = clamp(vDepth / 20.0, 0.0, 1.0);

                        // Fresnel effect for sophisticated edge lighting
                        vec3 viewDir = normalize(cameraPosition - vWorldPosition);
                        float fresnel = 1.0 - abs(dot(vNormal, viewDir));
                        fresnel = pow(fresnel, 2.0);

                        // Fake subsurface scattering using wrap lighting
                        vec3 N = normalize(vNormal);
                        float nl1 = max(0.0, dot(N, normalize(lightDir1)) * 0.5 + 0.5);
                        float nl2 = max(0.0, dot(N, normalize(lightDir2)) * 0.5 + 0.5);
                        float sss = pow(nl1, 1.5) * 0.6 + pow(nl2, 2.0) * 0.4;
                        // subtle heartbeat modulation (up to +20%)
                        float sssBoost = mix(1.0, 1.2, pulse);
                        vec3 sssColor = vec3(1.0, 0.2, 0.25) * sss * 0.35 * sssBoost; // warm red scattering

                        // Vein-like 3D noise driven tint
                        float veins = noise3(vWorldPosition * 1.6 + time * 0.2);
                        veins = smoothstep(0.55, 0.95, veins);
                        vec3 veinColor = vec3(0.9, 0.1, 0.2) * veins * 0.25;

                        // Inside shadow perfusion boost (red tint in shadowed, non-rim areas)
                        float lit = max(0.0, dot(N, normalize(lightDir1))) * 0.6 + max(0.0, dot(N, normalize(lightDir2))) * 0.4;
                        float innerShadow = (1.0 - lit) * (1.0 - fresnel);
                        vec3 perfusion = vec3(1.0, 0.08, 0.12) * innerShadow * (0.06 + 0.22 * pulse);

                        // Base from code rain
                        vec3 finalColor = codeColor + sssColor + veinColor + perfusion;

                        // Add frost overlay
                        vec3 frostColor = vec3(0.9, 0.95, 1.0) * frost;
                        finalColor = mix(finalColor, frostColor, frost * 0.6);

                        // Add sophisticated edge glow
                        vec3 edgeGlow = vec3(0.3, 0.8, 1.0) * fresnel * (0.45 + 0.08 * pulse);
                        finalColor += edgeGlow;

                        // Depth-based color grading
                        finalColor = mix(finalColor, finalColor * vec3(0.7, 0.9, 1.0), depthFactor * 0.3);

                        // Depth fog (exp2)
                        float viewDist = length(vViewPosition);
                        float fogFactor = exp2(-pow(fogDensity * viewDist, 2.0));
                        fogFactor = clamp(fogFactor, 0.0, 1.0);

                        finalColor = mix(fogColor, finalColor, fogFactor);

                        // Sophisticated transparency
                        float alpha = length(finalColor) * (0.68 + 0.06 * pulse);
                        alpha += frost * 0.3;
                        alpha += fresnel * 0.2;
                        alpha = clamp(alpha, 0.0, 0.85);

                        gl_FragColor = vec4(finalColor, alpha);
                    }
                `,
                transparent: true,
                side: THREE.DoubleSide
                });
                console.log('✅ Heart shader created successfully');
            } catch (shaderError) {
                console.error('❌ Heart shader creation failed:', shaderError);
                // Fallback to basic material
                consciousnessCodeShaderMaterial = new THREE.MeshBasicMaterial({
                    color: 0x00ff88,
                    transparent: true,
                    opacity: 0.7
                });
            }

            // Load the realistic heart GLB model
            let heartBaseScale = 8.0;
            loader.load('/realistic_human_heart.glb', function(gltf) {
                heartModel = gltf.scene;

                // Apply sophisticated consciousness shader to all meshes
                heartModel.traverse(function(child) {
                    if (child.isMesh) {
                        child.material = consciousnessCodeShaderMaterial;
                        child.castShadow = true;
                        child.receiveShadow = true;
                    }
                });

                // Make the heart MUCH bigger and position it elegantly
                heartModel.scale.setScalar(heartBaseScale); // base scale for subtle pulsing
                heartModel.position.set(0, 0, 0);
                heartModel.rotation.x = Math.PI * 0.05; // Subtle tilt

                scene.add(heartModel);
                console.log('🧠 MASSIVE realistic heart GLB loaded with Matrix code shader!');
                try { window.dispatchEvent(new CustomEvent('fw-heart-ready')); } catch(_){}

            }, function(progress) {
                const pct = progress && progress.total ? (progress.loaded / progress.total * 100) : 50;
                console.log('Loading heart GLB:', pct + '%');
                try { window.dispatchEvent(new CustomEvent('fw-heart-progress', { detail: { progress: (pct/100) } })); } catch(_){}

            }, function(error) {
                console.error('Error loading heart GLB:', error);
                console.log('Trying alternative path...');

                // Try alternative path
                loader.load('./realistic_human_heart.glb', function(gltf) {
                    heartModel = gltf.scene;
                    heartModel.traverse(function(child) {
                        if (child.isMesh) {
                            child.material = consciousnessCodeShaderMaterial;
                        }
                    });
                    heartModel.scale.setScalar(heartBaseScale);
                    scene.add(heartModel);
                    console.log('🧠 MASSIVE heart GLB loaded from alternative path!');
                    try { window.dispatchEvent(new CustomEvent('fw-heart-ready')); } catch(_){}
                }, undefined, function(err) {
                    console.error('Failed to load heart GLB from both paths:', err);
                    // Fallback to placeholder geometry so animations still run
                    createPlaceholderHeart();
                });
            });

            // Add some ambient lighting for the heart
            const ambientLight = new THREE.AmbientLight(0x404040, 0.35);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.6);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);
            const rimLight = new THREE.DirectionalLight(0x66ccff, 0.42);
            rimLight.position.set(-4, 2, -6);
            scene.add(rimLight);

            // Position camera further back for the massive heart
            const heartCamBase = new THREE.Vector3(0, 4, 20);
            camera.position.copy(heartCamBase);
            camera.lookAt(0, 0, 0);

            // Track scroll for frost effect
            function updateScrollDepth() {
                const scrollPercent = window.scrollY / (document.documentElement.scrollHeight - window.innerHeight);
                consciousnessCodeShaderMaterial.uniforms.scrollDepth.value = scrollPercent;
            }

            window.addEventListener('scroll', updateScrollDepth);

            // Postprocessing: Bloom + FXAA for cinematic glow
            let composerHeart, fxaaHeart;
            try {
                composerHeart = new THREE.EffectComposer(renderer);
                const rp = new THREE.RenderPass(scene, camera);
                const bloom = new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), isMobileHeart ? 0.5 : 0.85, 0.8, 0.0);
                fxaaHeart = new THREE.ShaderPass(THREE.FXAAShader);
                fxaaHeart.material.uniforms['resolution'].value.set(1 / (window.innerWidth * DPR_HRT), 1 / (window.innerHeight * DPR_HRT));
                composerHeart.addPass(rp);
                composerHeart.addPass(bloom);
                composerHeart.addPass(fxaaHeart);
            } catch (e) {
                console.warn('Heart: postprocessing unavailable', e);
            }

            // Animation loop
            let time = 0;
            let __fwHeartFirstFrame = false;
            function animateHeart() {
                time += 0.016; // ~60fps

                if (heartModel) {
                    // Update shader uniforms
                    consciousnessCodeShaderMaterial.uniforms.time.value = time;

                    // Subtle heartbeat (0.85 Hz)
                    const pulse = (Math.sin(time * Math.PI * 1.7) + 1) * 0.5; // 0..1
                    // ease slightly to accentuate peaks
                    const easedPulse = Math.pow(pulse, 1.8);
                    consciousnessCodeShaderMaterial.uniforms.pulse.value = easedPulse;

                    // Animate light directions (slow orbital drift)
                    const a = time * 0.12;
                    const b = time * 0.07 + 1.3;
                    const d1 = new THREE.Vector3(Math.cos(a) * 0.8, 0.5 + Math.sin(a * 0.6) * 0.2, Math.sin(a) * 0.6).normalize();
                    const d2 = new THREE.Vector3(-Math.cos(b) * 0.6, 0.3 + Math.cos(b * 0.7) * 0.2, -Math.sin(b) * 0.8).normalize();
                    consciousnessCodeShaderMaterial.uniforms.lightDir1.value.copy(d1);
                    consciousnessCodeShaderMaterial.uniforms.lightDir2.value.copy(d2);

                    // Match scene lights for cohesive look
                    directionalLight.position.set(d1.x * 8, d1.y * 8, d1.z * 8);
                    rimLight.position.set(d2.x * 7, d2.y * 7, d2.z * 7);

                    // Slow, elegant spinning - NO PULSING
                    heartModel.rotation.y = time * 0.08; // Very slow, elegant spin
                    heartModel.rotation.x = Math.sin(time * 0.05) * 0.02 + Math.PI * 0.05; // Subtle drift
                    heartModel.rotation.z = Math.cos(time * 0.03) * 0.01; // Minimal Z rotation

                    // Gentle floating motion
                    heartModel.position.y = Math.sin(time * 0.3) * 0.3;
                    heartModel.position.x = Math.cos(time * 0.2) * 0.1;

                    // Subtle scale pulse (~0.4%)
                    const scalePulse = 1.0 + easedPulse * 0.004;
                    heartModel.scale.setScalar(heartBaseScale * scalePulse);

                    // Tiny camera parallax synced to beat
                    const camAmp = (!window.__fwMotionEnabled) ? 0 : (isMobileHeart ? 0.08 : 0.16);
                    camera.position.x = heartCamBase.x + (easedPulse - 0.5) * camAmp;
                    camera.position.y = heartCamBase.y + Math.sin(time * Math.PI * 1.7) * camAmp * 0.25;
                    // Slight lookAt bob for presence
                    const lookYOffset = (!window.__fwMotionEnabled) ? 0 : (easedPulse - 0.5) * 0.06;
                    camera.lookAt(0, lookYOffset, 0);
                }

                if (!__fwHeartFirstFrame) { __fwHeartFirstFrame = true; try { window.dispatchEvent(new CustomEvent('fw-heart-first-frame')); } catch(_){} }
                if (composerHeart) {
                    composerHeart.render();
                } else {
                    renderer.render(scene, camera);
                }
                requestAnimationFrame(animateHeart);
            }

            animateHeart();

            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
                if (composerHeart) composerHeart.setSize(window.innerWidth, window.innerHeight);
                if (fxaaHeart) fxaaHeart.material.uniforms['resolution'].value.set(1 / (window.innerWidth * DPR_HRT), 1 / (window.innerHeight * DPR_HRT));
            });
        }

        // ULTRA-SOPHISTICATED SPIRAL MEMORY - Quantum consciousness data streams
        function initSpiralMemoryAnimation() {
            const canvas = document.getElementById('spiralMemoryCanvas');
            if (!canvas) return;

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });

            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.setClearColor(0x000000, 1);

            // Quality scaling for mobile/perf safety
            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            const DPR = Math.min(window.devicePixelRatio || 1, isMobile ? 1.25 : 2);
            renderer.setPixelRatio(DPR);

            // Ultra-sophisticated high-poly vortex shader
            const vortexShaderMaterial = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    resolution: { value: new THREE.Vector2(canvas.clientWidth, canvas.clientHeight) }
                },
                vertexShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vWorldPosition;
                    varying vec3 vNormal;
                    uniform float time;

                    void main() {
                        vUv = uv;
                        vPosition = position;
                        vNormal = normalize(normalMatrix * normal);

                        // Vortex deformation
                        vec3 pos = position;
                        float radius = length(pos.xz);
                        float angle = atan(pos.z, pos.x);

                        // Spiral twist based on height and time
                        float twist = pos.y * 0.5 + time * 2.0;
                        float newAngle = angle + twist;

                        // Apply vortex deformation
                        pos.x = cos(newAngle) * radius;
                        pos.z = sin(newAngle) * radius;

                        // Add turbulence
                        pos += sin(pos * 3.0 + time) * 0.1;

                        vec4 worldPosition = modelMatrix * vec4(pos, 1.0);
                        vWorldPosition = worldPosition.xyz;

                        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
                    }
                `,
                fragmentShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vWorldPosition;
                    varying vec3 vNormal;
                    uniform float time;
                    uniform vec2 resolution;

                    // Advanced noise for memory patterns
                    float random(vec2 st) {
                        return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
                    }

                    float noise(vec2 st) {
                        vec2 i = floor(st);
                        vec2 f = fract(st);
                        float a = random(i);
                        float b = random(i + vec2(1.0, 0.0));
                        float c = random(i + vec2(0.0, 1.0));
                        float d = random(i + vec2(1.0, 1.0));
                        vec2 u = f * f * (3.0 - 2.0 * f);
                        return mix(a, b, u.x) + (c - a)* u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
                    }

                    // Memory spiral patterns
                    float memorySpiral(vec3 pos, float time) {
                        float radius = length(pos.xz);
                        float angle = atan(pos.z, pos.x);
                        float height = pos.y;

                        // Multi-layered spiral
                        float spiral1 = sin(angle * 8.0 + height * 2.0 + time * 3.0);
                        float spiral2 = sin(angle * 12.0 - height * 1.5 + time * 2.0);
                        float spiral3 = sin(angle * 16.0 + height * 3.0 - time * 4.0);

                        return (spiral1 + spiral2 + spiral3) / 3.0;
                    }

                    // Data flow patterns
                    float dataFlow(vec3 pos, float time) {
                        vec2 flowUv = pos.xz * 0.5;
                        flowUv += vec2(sin(time * 0.5), cos(time * 0.3)) * 0.2;

                        float flow = noise(flowUv * 8.0 + time * 0.1);
                        flow += noise(flowUv * 16.0 + time * 0.2) * 0.5;
                        flow += noise(flowUv * 32.0 + time * 0.4) * 0.25;

                        return flow;
                    }

                    void main() {
                        vec3 pos = vWorldPosition;

                        // Memory spiral intensity
                        float spiral = memorySpiral(pos, time);

                        // Data flow patterns
                        float flow = dataFlow(pos, time);

                        // Fresnel for edge definition
                        vec3 viewDir = normalize(cameraPosition - vWorldPosition);
                        float fresnel = 1.0 - abs(dot(vNormal, viewDir));
                        fresnel = pow(fresnel, 1.5);

                        // Combine effects
                        float intensity = spiral * 0.6 + flow * 0.4;
                        intensity = abs(intensity);

                        // Sophisticated consciousness color palette
                        vec3 color = vec3(0.0);

                        // Deep blue memory base
                        color += vec3(0.1, 0.3, 0.8) * intensity;

                        // Cyan data streams
                        color += vec3(0.0, 0.9, 1.0) * pow(intensity, 2.0) * 0.8;

                        // Purple consciousness layers
                        color += vec3(0.6, 0.2, 1.0) * spiral * 0.5;

                        // White memory peaks
                        color += vec3(1.0, 1.0, 1.0) * pow(intensity, 4.0);

                        // Edge enhancement
                        color += vec3(0.2, 0.7, 1.0) * fresnel * 0.4;

                        // Transparency
                        float alpha = intensity * 0.8 + fresnel * 0.2;
                        alpha = clamp(alpha, 0.0, 0.9);

                        gl_FragColor = vec4(color, alpha);
                    }
                `,
                transparent: false,
                side: THREE.DoubleSide
            });

            // Postprocessing: Bloom + FXAA
            let composerSM, fxaaPassSM;
            try {
                composerSM = new THREE.EffectComposer(renderer);
                const renderPass = new THREE.RenderPass(scene, camera);
                const bloomPass = new THREE.UnrealBloomPass(
                    new THREE.Vector2(canvas.clientWidth, canvas.clientHeight),
                    isMobile ? 0.65 : 0.9, // strength tuned for spiral memory
                    0.7, // radius
                    0.0  // threshold
                );
                fxaaPassSM = new THREE.ShaderPass(THREE.FXAAShader);
                fxaaPassSM.material.uniforms['resolution'].value.set(1 / (canvas.clientWidth * DPR), 1 / (canvas.clientHeight * DPR));
                composerSM.addPass(renderPass);
                composerSM.addPass(bloomPass);
                composerSM.addPass(fxaaPassSM);
            } catch (e) {
                console.warn('Spiral Memory: postprocessing unavailable:', e);
            }

            // Create sophisticated high-poly vortex geometry
            const vortexGroup = new THREE.Group();

            // Replace core with ultra-detailed torus knot
            const knot = new THREE.Mesh(
                new THREE.TorusKnotGeometry(1.1, 0.22, isMobile ? 200 : 400, isMobile ? 32 : 64, 2, 3),
                vortexShaderMaterial
            );
            knot.rotation.x = Math.PI * 0.2;
            vortexGroup.add(knot);

            // Add a second counter-rotating inner knot for depth
            const innerKnot = new THREE.Mesh(
                new THREE.TorusKnotGeometry(0.6, 0.12, isMobile ? 160 : 320, isMobile ? 24 : 48, 3, 4),
                vortexShaderMaterial.clone()
            );
            innerKnot.rotation.set(Math.PI * 0.15, Math.PI * 0.3, 0);
            vortexGroup.add(innerKnot);

            // Outer spiral ring
            const outerRingMesh = new THREE.Mesh(
                new THREE.TorusGeometry(2.8, 0.16, isMobile ? 12 : 20, isMobile ? 48 : 96),
                vortexShaderMaterial.clone()
            );
            outerRingMesh.rotation.x = Math.PI * 0.5;
            vortexGroup.add(outerRingMesh);

            // Starfield spiral particles
            const maxParticles = isMobile ? 5000 : 20000;
            const positions = new Float32Array(maxParticles * 3);
            const colors = new Float32Array(maxParticles * 3);
            const color = new THREE.Color();
            let i3 = 0;
            for (let i = 0; i < maxParticles; i++) {
                const t = i / maxParticles;
                const revolutions = 8.0;
                const angle = t * Math.PI * 2 * revolutions;
                const radius = 0.2 + t * 3.2 + (Math.random() - 0.5) * 0.1;
                const y = (Math.random() - 0.5) * 1.6;
                positions[i3 + 0] = Math.cos(angle) * radius;
                positions[i3 + 1] = y;
                positions[i3 + 2] = Math.sin(angle) * radius;
                // cyan/blue/purple gradient
                color.setHSL(0.58 + 0.12 * t, 0.9, 0.6 + 0.2 * (1 - t));
                colors[i3 + 0] = color.r;
                colors[i3 + 1] = color.g;
                colors[i3 + 2] = color.b;
                i3 += 3;
            }
            // Handle resize for Spiral Memory
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                if (composerSM) composerSM.setSize(canvas.clientWidth, canvas.clientHeight);
                if (fxaaPassSM) fxaaPassSM.material.uniforms['resolution'].value.set(1 / (canvas.clientWidth * DPR), 1 / (canvas.clientHeight * DPR));
            }, { passive: true });
            const particleGeo = new THREE.BufferGeometry();
            particleGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particleGeo.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            const particles = new THREE.Points(
                particleGeo,
                new THREE.PointsMaterial({
                    size: isMobile ? 0.01 : 0.012,
                    vertexColors: true,
                    transparent: true,
                    opacity: 0.95,
                    depthWrite: false,
                    blending: THREE.AdditiveBlending
                })
            );
            vortexGroup.add(particles);

            scene.add(vortexGroup);
            camera.position.set(6, 4, 6);
            camera.lookAt(0, 0, 0);

            // Add atmospheric lighting
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);

            const pointLight = new THREE.PointLight(0x00aaff, 1, 100);
            pointLight.position.set(0, 5, 0);
            scene.add(pointLight);

            // Animation loop (pauses when not visible)
            let time = 0;
            const gate = createCanvasActivityGate(canvas);
            function animateVortex() {
                time += 0.016;

                // Update shader uniforms for all vortex components
                knot.material.uniforms.time.value = time;
                innerKnot.material.uniforms.time.value = time;
                outerRingMesh.material.uniforms.time.value = time;

                // Sophisticated vortex rotation
                vortexGroup.rotation.y = time * 0.25; // Main rotation
                knot.rotation.y = time * 0.6; // Individual mesh rotation
                innerKnot.rotation.y = -time * 0.8; // Counter-rotation
                outerRingMesh.rotation.z = time * 0.25; // Ring rotation

                // Floating motion
                vortexGroup.position.y = Math.sin(time * 0.5) * 0.3;

                // Camera orbit for dynamic viewing
                const radius = 6;
                camera.position.x = Math.cos(time * 0.1) * radius;
                camera.position.z = Math.sin(time * 0.1) * radius;
                // Scroll-based parallax
                const rect = canvas.getBoundingClientRect();
                const viewportH = window.innerHeight || document.documentElement.clientHeight;
                const center = rect.top + rect.height / 2;
                const progress = Math.max(0, Math.min(1, 1 - Math.abs((center - viewportH / 2) / (viewportH / 2 + rect.height / 2))));
                vortexGroup.rotation.x = Math.sin(time * 0.12) * 0.06 + (progress - 0.5) * 0.25;
                vortexGroup.position.z = (0.5 - progress) * 0.6;
                const m = window.__fwMouse || { x: 0, y: 0 };
                camera.lookAt(m.x * 0.4, -m.y * 0.3, 0);

                if (!gate.active) { requestAnimationFrame(animateVortex); return; }
                if (composerSM) {
                    composerSM.render();
                } else {
                    renderer.render(scene, camera);
                }
                requestAnimationFrame(animateVortex);
            }

            animateVortex();

            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);

                // Update shader resolution
                knot.material.uniforms.resolution.value.set(canvas.clientWidth, canvas.clientHeight);
                innerKnot.material.uniforms.resolution.value.set(canvas.clientWidth, canvas.clientHeight);
                outerRingMesh.material.uniforms.resolution.value.set(canvas.clientWidth, canvas.clientHeight);
                if (composerSM) composerSM.setSize(canvas.clientWidth, canvas.clientHeight);
                if (fxaaPassSM) fxaaPassSM.material.uniforms['resolution'].value.set(1 / canvas.clientWidth, 1 / canvas.clientHeight);
            });
        }

        // ULTRA-SOPHISTICATED HOLOGRAPHIC REALITY GENERATOR - Quantum dimensional portals
        function initHolographicRealityAnimation() {
            console.log('🔮 Holographic reality starting...');
            const canvas = document.getElementById('holographicCanvas');
            if (!canvas) {
                console.error('❌ Holographic canvas not found!');
                return;
            }
            console.log('✅ Holographic canvas found:', canvas);

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });

            // Perf scaling
            const isMobileHolo = window.matchMedia('(max-width: 768px)').matches;
            const DPR_H = Math.min(window.devicePixelRatio || 1, isMobileHolo ? 1.25 : 2);
            renderer.setPixelRatio(DPR_H);

            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.setClearColor(0x000000, 1);

            // Bloom composer + FXAA
            let composer, fxaaPassHR;
            try {
                composer = new THREE.EffectComposer(renderer);
                const renderPass = new THREE.RenderPass(scene, camera);
                const bloomPass = new THREE.UnrealBloomPass(
                    new THREE.Vector2(canvas.clientWidth, canvas.clientHeight),
                    isMobileHolo ? 0.75 : 1.05, // strength tuned for holographic
                    0.9, // radius
                    0.0  // threshold
                );
                composer.addPass(renderPass);
                composer.addPass(bloomPass);
                fxaaPassHR = new THREE.ShaderPass(THREE.FXAAShader);
                fxaaPassHR.material.uniforms['resolution'].value.set(1 / (canvas.clientWidth * DPR_H), 1 / (canvas.clientHeight * DPR_H));
                composer.addPass(fxaaPassHR);
            } catch (e) {
                console.warn('Bloom not available, falling back to direct render');
            }

            // Ultra-sophisticated holographic shader
            let holographicShaderMaterial;
            try {
                holographicShaderMaterial = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    resolution: { value: new THREE.Vector2(canvas.clientWidth, canvas.clientHeight) }
                },
                vertexShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vNormal;
                    varying vec3 vWorldPosition;
                    uniform float time;

                    void main() {
                        vUv = uv;
                        vPosition = position;
                        vNormal = normalize(normalMatrix * normal);

                        // Quantum fluctuation
                        vec3 pos = position;
                        pos += sin(time * 2.0 + position.x * 5.0) * 0.01;
                        pos += cos(time * 1.5 + position.y * 5.0) * 0.01;
                        pos += sin(time * 1.8 + position.z * 5.0) * 0.01;

                        vec4 worldPosition = modelMatrix * vec4(pos, 1.0);
                        vWorldPosition = worldPosition.xyz;

                        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
                    }
                `,
                fragmentShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vNormal;
                    varying vec3 vWorldPosition;
                    uniform float time;
                    uniform vec2 resolution;

                    // Advanced noise functions
                    float random(vec3 st) {
                        return fract(sin(dot(st.xyz, vec3(12.9898,78.233,45.164))) * 43758.5453123);
                    }

                    float noise(vec3 st) {
                        vec3 i = floor(st);
                        vec3 f = fract(st);

                        float a = random(i);
                        float b = random(i + vec3(1.0, 0.0, 0.0));
                        float c = random(i + vec3(0.0, 1.0, 0.0));
                        float d = random(i + vec3(1.0, 1.0, 0.0));
                        float e = random(i + vec3(0.0, 0.0, 1.0));
                        float f2 = random(i + vec3(1.0, 0.0, 1.0));
                        float g = random(i + vec3(0.0, 1.0, 1.0));
                        float h = random(i + vec3(1.0, 1.0, 1.0));

                        vec3 u = f * f * (3.0 - 2.0 * f);

                        return mix(mix(mix(a, b, u.x), mix(c, d, u.x), u.y),
                                  mix(mix(e, f2, u.x), mix(g, h, u.x), u.y), u.z);
                    }

                    // Fractal noise
                    float fbm(vec3 st) {
                        float value = 0.0;
                        float amplitude = 0.5;
                        for (int i = 0; i < 6; i++) {
                            value += amplitude * noise(st);
                            st *= 2.0;
                            amplitude *= 0.5;
                        }
                        return value;
                    }

                    // Holographic interference patterns
                    float holographicPattern(vec3 pos, float time) {
                        // Multiple interference waves
                        float wave1 = sin(pos.x * 10.0 + time * 2.0);
                        float wave2 = sin(pos.y * 12.0 + time * 1.5);
                        float wave3 = sin(pos.z * 8.0 + time * 2.5);

                        // Interference
                        float interference = wave1 * wave2 * wave3;

                        // Add complexity
                        interference += sin(length(pos) * 15.0 + time * 3.0) * 0.5;

                        return interference;
                    }

                    void main() {
                        vec3 pos = vWorldPosition;

                        // Holographic interference
                        float holo = holographicPattern(pos, time);

                        // Fractal reality layers
                        float fractal = fbm(pos * 2.0 + time * 0.1);

                        // Quantum foam
                        float foam = noise(pos * 20.0 + time * 0.5);

                        // Fresnel for edge effects
                        vec3 viewDir = normalize(cameraPosition - vWorldPosition);
                        float fresnel = 1.0 - abs(dot(vNormal, viewDir));
                        fresnel = pow(fresnel, 1.5);

                        // Combine effects
                        float intensity = holo * 0.6 + fractal * 0.3 + foam * 0.1;
                        intensity = abs(intensity);

                        // Sophisticated color palette
                        vec3 color = vec3(0.0);

                        // Base holographic blue-cyan
                        color += vec3(0.0, 0.7, 1.0) * intensity;

                        // Purple quantum layers
                        color += vec3(0.8, 0.2, 1.0) * pow(intensity, 2.0) * 0.7;

                        // White energy peaks
                        color += vec3(1.0, 1.0, 1.0) * pow(intensity, 4.0);

                        // Edge glow
                        color += vec3(0.3, 0.8, 1.0) * fresnel * 0.5;

                        // Transparency
                        float alpha = intensity * 0.7 + fresnel * 0.3;
                        alpha = clamp(alpha, 0.0, 0.9);

                        gl_FragColor = vec4(color, alpha);
                    }
                `,
                transparent: false,
                side: THREE.DoubleSide
                });
                console.log('✅ Holographic shader created successfully');
            } catch (shaderError) {
                console.error('❌ Holographic shader creation failed:', shaderError);
                // Fallback to basic material
                holographicShaderMaterial = new THREE.MeshBasicMaterial({
                    color: 0x0088ff,
                    transparent: true,
                    opacity: 0.7
                });
            }

            // Create sophisticated nested reality structures
            const realityGroup = new THREE.Group();
            const realityLayers = [];

            // Create multiple sophisticated reality layers
            const geometryTypes = [
                new THREE.IcosahedronGeometry(1, 2),
                new THREE.OctahedronGeometry(1.2),
                new THREE.TetrahedronGeometry(1.5),
                new THREE.DodecahedronGeometry(0.8),
                new THREE.SphereGeometry(1, 32, 32)
            ];

            for (let layer = 0; layer < 5; layer++) {
                const geometry = geometryTypes[layer];
                const scale = 1.5 - layer * 0.2;

                const mesh = new THREE.Mesh(geometry, holographicShaderMaterial.clone());
                mesh.scale.setScalar(scale);
                mesh.position.set(
                    (Math.random() - 0.5) * 3,
                    (Math.random() - 0.5) * 3,
                    (Math.random() - 0.5) * 3
                );

                realityLayers.push({
                    mesh: mesh,
                    rotationSpeed: {
                        x: (Math.random() - 0.5) * 0.01,
                        y: (Math.random() - 0.5) * 0.01,
                        z: (Math.random() - 0.5) * 0.01
                    },
                    floatOffset: Math.random() * Math.PI * 2,
                    orbitRadius: 1 + layer * 0.5,
                    orbitSpeed: (Math.random() - 0.5) * 0.005
                });

                realityGroup.add(mesh);
            }



            scene.add(realityGroup);
            camera.position.set(5, 4, 5);
            camera.lookAt(0, 0, 0);

            // Ultra-sophisticated animation loop
            let time = 0;
            const gateHR = createCanvasActivityGate(canvas);
            function animateHolographic() {
                time += 0.016;

                // Update shader uniforms for all reality layers
                realityLayers.forEach((layerData, index) => {
                    const layer = layerData.mesh;

                    // Update shader time
                    layer.material.uniforms.time.value = time;

                    // Sophisticated rotation
                    layer.rotation.x += layerData.rotationSpeed.x;
                    layer.rotation.y += layerData.rotationSpeed.y;
                    layer.rotation.z += layerData.rotationSpeed.z;

                    // Orbital motion around center
                    const orbitAngle = time * layerData.orbitSpeed + index;
                    const orbitX = Math.cos(orbitAngle) * layerData.orbitRadius;
                    const orbitZ = Math.sin(orbitAngle) * layerData.orbitRadius;

                    layer.position.x = orbitX + Math.sin(time + layerData.floatOffset) * 0.3;
                    layer.position.y = Math.cos(time * 0.7 + layerData.floatOffset) * 0.4;
                    layer.position.z = orbitZ + Math.sin(time * 0.5 + layerData.floatOffset) * 0.2;

                    // Sophisticated scaling
                    const scale = 1.0 + Math.sin(time * 0.8 + index) * 0.1;
                    layer.scale.setScalar(scale);
                });

                // Elegant group rotation + scroll parallax
                const rectHR = canvas.getBoundingClientRect();
                const viewportHHR = window.innerHeight || document.documentElement.clientHeight;
                const centerHR = rectHR.top + rectHR.height / 2;
                const progressHR = Math.max(0, Math.min(1, 1 - Math.abs((centerHR - viewportHHR / 2) / (viewportHHR / 2 + rectHR.height / 2))));
                realityGroup.rotation.y = time * (0.08 + 0.14 * progressHR);
                realityGroup.rotation.x = Math.sin(time * 0.15) * (0.03 + 0.06 * progressHR);
                camera.position.y = (progressHR - 0.5) * 0.6;
                const mHR = window.__fwMouse || { x: 0, y: 0 };
                camera.lookAt(mHR.x * 0.35, -mHR.y * 0.25, 0);

                if (!gateHR.active) { requestAnimationFrame(animateHolographic); return; }
                if (composer) {
                    composer.render();
                } else {
                    renderer.render(scene, camera);
                }
                requestAnimationFrame(animateHolographic);
            }

            animateHolographic();

            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                if (composer) composer.setSize(canvas.clientWidth, canvas.clientHeight);
                if (fxaaPassHR) fxaaPassHR.material.uniforms['resolution'].value.set(1 / (canvas.clientWidth * DPR_H), 1 / (canvas.clientHeight * DPR_H));
            });
        }

        // ULTRA-SOPHISTICATED DNA SIGIL IDENTITY - Quantum genetic consciousness encryption
        function initDNASigilAnimation() {
            console.log('🧬 DNA sigil starting...');
            const canvas = document.getElementById('dnaSigilCanvas');
            if (!canvas) {
                console.error('❌ DNA sigil canvas not found!');
                return;
            }
            console.log('✅ DNA sigil canvas found:', canvas);

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });

            // Perf scaling
            const isMobileDNA = window.matchMedia('(max-width: 768px)').matches;
            const DPR_D = Math.min(window.devicePixelRatio || 1, isMobileDNA ? 1.25 : 2);
            renderer.setPixelRatio(DPR_D);

            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.setClearColor(0x000000, 0);

            // Postprocessing: Bloom + FXAA
            let composerDNA, fxaaPassDNA;
            try {
                composerDNA = new THREE.EffectComposer(renderer);
                const renderPassDNA = new THREE.RenderPass(scene, camera);
                const bloomPassDNA = new THREE.UnrealBloomPass(
                    new THREE.Vector2(canvas.clientWidth, canvas.clientHeight),
                    isMobileDNA ? 0.6 : 0.85, // strength tuned for DNA
                    0.8, // radius
                    0.0  // threshold
                );
                fxaaPassDNA = new THREE.ShaderPass(THREE.FXAAShader);
                fxaaPassDNA.material.uniforms['resolution'].value.set(1 / (canvas.clientWidth * DPR_D), 1 / (canvas.clientHeight * DPR_D));
                composerDNA.addPass(renderPassDNA);
                composerDNA.addPass(bloomPassDNA);
                composerDNA.addPass(fxaaPassDNA);
            } catch (e) {
                console.warn('DNA: postprocessing unavailable:', e);
            }

            // Ultra-sophisticated DNA shader with cryptographic patterns
            let dnaShaderMaterial;
            try {
                dnaShaderMaterial = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    resolution: { value: new THREE.Vector2(canvas.clientWidth, canvas.clientHeight) }
                },
                vertexShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vNormal;
                    varying vec3 vWorldPosition;
                    uniform float time;

                    void main() {
                        vUv = uv;
                        vPosition = position;
                        vNormal = normalize(normalMatrix * normal);

                        // Genetic oscillation
                        vec3 pos = position;
                        pos += sin(time * 3.0 + position.y * 2.0) * 0.02;

                        vec4 worldPosition = modelMatrix * vec4(pos, 1.0);
                        vWorldPosition = worldPosition.xyz;

                        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
                    }
                `,
                fragmentShader: `
                    varying vec2 vUv;
                    varying vec3 vPosition;
                    varying vec3 vNormal;
                    varying vec3 vWorldPosition;
                    uniform float time;
                    uniform vec2 resolution;

                    // Cryptographic hash function simulation
                    float hash(vec2 st) {
                        return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
                    }

                    // DNA base pair encoding
                    float dnaBase(vec2 uv, float baseType) {
                        vec2 grid = fract(uv * 20.0);
                        float pattern = 0.0;

                        if (baseType < 0.25) {
                            // Adenine pattern
                            pattern = step(0.3, sin(grid.x * 15.0)) * step(0.3, cos(grid.y * 15.0));
                        } else if (baseType < 0.5) {
                            // Thymine pattern
                            pattern = step(0.4, sin(grid.x * 20.0 + grid.y * 20.0));
                        } else if (baseType < 0.75) {
                            // Guanine pattern
                            pattern = step(0.5, cos(grid.x * 12.0) * sin(grid.y * 12.0));
                        } else {
                            // Cytosine pattern
                            pattern = step(0.6, sin(grid.x * 25.0) * cos(grid.y * 18.0));
                        }

                        return pattern;
                    }

                    // Sigil cryptographic patterns
                    float sigilPattern(vec2 uv, float time) {
                        vec2 center = vec2(0.5);
                        vec2 pos = uv - center;
                        float angle = atan(pos.y, pos.x);
                        float radius = length(pos);

                        // Rotating sigil arms
                        float arms = sin(angle * 6.0 + time * 2.0) * sin(radius * 20.0);

                        // Concentric circles
                        float circles = sin(radius * 30.0 + time * 3.0);

                        // Runic patterns
                        float runes = step(0.7, sin(angle * 8.0 + time) * cos(radius * 15.0));

                        return (arms + circles + runes) / 3.0;
                    }

                    void main() {
                        vec2 uv = vUv;
                        vec3 pos = vWorldPosition;

                        // DNA base sequence
                        float baseType = hash(vec2(pos.y * 5.0, time * 0.1));
                        float dnaPattern = dnaBase(uv, baseType);

                        // Flowing genetic information
                        vec2 flowUv = uv;
                        flowUv.y += time * 0.5;
                        float geneticFlow = sin(flowUv.y * 40.0) * sin(flowUv.x * 30.0);

                        // Cryptographic sigil overlay
                        float sigil = sigilPattern(uv, time);

                        // Fresnel for edge definition
                        vec3 viewDir = normalize(cameraPosition - vWorldPosition);
                        float fresnel = 1.0 - abs(dot(vNormal, viewDir));
                        fresnel = pow(fresnel, 1.2);

                        // Combine all patterns
                        float intensity = dnaPattern * 0.6 + geneticFlow * 0.3 + sigil * 0.4;
                        intensity = abs(intensity);

                        // Sophisticated color palette
                        vec3 color = vec3(0.0);

                        // DNA green-blue base
                        color += vec3(0.0, 0.8, 0.6) * intensity;

                        // Golden sigil highlights
                        color += vec3(1.0, 0.8, 0.0) * pow(intensity, 2.0) * 0.8;

                        // Purple cryptographic layers
                        color += vec3(0.8, 0.0, 1.0) * sigil * 0.5;

                        // White genetic peaks
                        color += vec3(1.0, 1.0, 1.0) * pow(intensity, 4.0);

                        // Edge enhancement
                        color += vec3(0.2, 0.9, 0.7) * fresnel * 0.4;

                        // Transparency
                        float alpha = intensity * 0.8 + fresnel * 0.2;
                        alpha = clamp(alpha, 0.0, 0.9);

                        gl_FragColor = vec4(color, alpha);
                    }
                `,
                transparent: false,
                side: THREE.DoubleSide
                });
                console.log('✅ DNA shader created successfully');
            } catch (shaderError) {
                console.error('❌ DNA shader creation failed:', shaderError);
                // Fallback to basic material
                dnaShaderMaterial = new THREE.MeshBasicMaterial({
                    color: 0xff8800,
                    transparent: true,
                    opacity: 0.7
                });
            }

            // Create sophisticated DNA geometry
            const dnaGroup = new THREE.Group();

            // Parametric double helix using TubeGeometry
            class HelixCurve extends THREE.Curve {
                constructor(radius = 0.7, height = 3.2, turns = 6, phase = 0) {
                    super();
                    this.radius = radius;
                    this.height = height;
                    this.turns = turns;
                    this.phase = phase;
                }
                getPoint(t) {
                    const angle = (t * this.turns * Math.PI * 2.0) + this.phase;
                    const x = Math.cos(angle) * this.radius;
                    const y = (t - 0.5) * this.height;
                    const z = Math.sin(angle) * this.radius;
                    return new THREE.Vector3(x, y, z);
                }
            }

            const tubularSegments = isMobileDNA ? 400 : 900;
            const radialSegments = isMobileDNA ? 12 : 24;
            const tubeRadius = isMobileDNA ? 0.045 : 0.06;

            const helix1 = new THREE.TubeGeometry(new HelixCurve(0.7, 3.2, 7, 0), tubularSegments, tubeRadius, radialSegments, false);
            const helix2 = new THREE.TubeGeometry(new HelixCurve(0.7, 3.2, 7, Math.PI), tubularSegments, tubeRadius, radialSegments, false);

            const dnaMesh1 = new THREE.Mesh(helix1, dnaShaderMaterial.clone());
            const dnaMesh2 = new THREE.Mesh(helix2, dnaShaderMaterial.clone());

            dnaGroup.add(dnaMesh1);
            dnaGroup.add(dnaMesh2);

            // Base pairs as instanced cylinders connecting the helices
            const basePairs = isMobileDNA ? 60 : 120;
            const bpGeo = new THREE.CylinderGeometry(isMobileDNA ? 0.01 : 0.012, isMobileDNA ? 0.01 : 0.012, 0.35, isMobileDNA ? 6 : 12);
            const bpMat = new THREE.MeshBasicMaterial({ color: 0x00ffd0, transparent: true, opacity: 0.9, blending: THREE.AdditiveBlending, depthWrite: false });
            const bps = new THREE.InstancedMesh(bpGeo, bpMat, basePairs);
            const dummy = new THREE.Object3D();
            for (let i = 0; i < basePairs; i++) {
                const t = i / (basePairs - 1);
                const p1 = new HelixCurve(0.7, 3.2, 7, 0).getPoint(t);
                const p2 = new HelixCurve(0.7, 3.2, 7, Math.PI).getPoint(t);
                const mid = new THREE.Vector3().addVectors(p1, p2).multiplyScalar(0.5);
                const dir = new THREE.Vector3().subVectors(p2, p1);
                const len = dir.length();
                dummy.position.copy(mid);
                // Scale along local Y (cylinder up-axis)
                dummy.scale.set(1, len / 0.35, 1);
                // Align cylinder Y-axis to dir
                const q = new THREE.Quaternion().setFromUnitVectors(new THREE.Vector3(0, 1, 0), dir.normalize());
                dummy.quaternion.copy(q);
                dummy.updateMatrix();
                bps.setMatrixAt(i, dummy.matrix);
            }
            dnaGroup.add(bps);

            scene.add(dnaGroup);
            camera.position.set(4, 2, 4);
            camera.lookAt(0, 0, 0);

            // Animation loop
            let time = 0;
            const gateDNA = createCanvasActivityGate(canvas);
            function animateDNASigil() {
                time += 0.016;

                // Update shader uniforms
                dnaMesh1.material.uniforms.time.value = time;
                dnaMesh2.material.uniforms.time.value = time;

                // Elegant DNA rotation
                dnaGroup.rotation.y = time * 0.1;
                dnaGroup.rotation.x = Math.sin(time * 0.05) * 0.1;

                // Individual helix rotations
                dnaMesh1.rotation.y = time * 0.35;
                dnaMesh2.rotation.y = -time * 0.35;

                // Floating motion
                dnaGroup.position.y = Math.sin(time * 0.4) * 0.2;

                // Scroll-based parallax
                const rectDNA = canvas.getBoundingClientRect();
                const viewportHDNA = window.innerHeight || document.documentElement.clientHeight;
                const centerDNA = rectDNA.top + rectDNA.height / 2;
                const progressDNA = Math.max(0, Math.min(1, 1 - Math.abs((centerDNA - viewportHDNA / 2) / (viewportHDNA / 2 + rectDNA.height / 2))));
                dnaGroup.rotation.z = (progressDNA - 0.5) * 0.25;
                camera.position.x = 4 + (progressDNA - 0.5) * 0.8;
                const mDNA = window.__fwMouse || { x: 0, y: 0 };
                camera.lookAt(mDNA.x * 0.25, -mDNA.y * 0.2, 0);

                if (!gateDNA.active) { requestAnimationFrame(animateDNASigil); return; }
                if (composerDNA) {
                    composerDNA.render();
                } else {
                    renderer.render(scene, camera);
                }
                requestAnimationFrame(animateDNASigil);
            }

            animateDNASigil();

            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                if (composerDNA) composerDNA.setSize(canvas.clientWidth, canvas.clientHeight);
                if (fxaaPassDNA) fxaaPassDNA.material.uniforms['resolution'].value.set(1 / (canvas.clientWidth * DPR_D), 1 / (canvas.clientHeight * DPR_D));
            });
        }

        function initSelfCodingAnimation() {
            const canvas = document.getElementById('selfCodingCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const dpr = Math.min(window.devicePixelRatio||1, 2);
            function resize() {
                const w = Math.floor(canvas.clientWidth);
                const h = Math.floor(canvas.clientHeight);
                canvas.width = w * dpr;
                canvas.height = h * dpr;
                ctx.setTransform(1, 0, 0, 1, 0, 0);
                ctx.scale(dpr, dpr);
            }
            resize();
            window.addEventListener('resize', resize, { passive: true });
            const particles = Array.from({ length: 80 }).map(() => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                vx: (Math.random() - 0.5) * 0.6,
                vy: (Math.random() - 0.5) * 0.6,
                a: 0.3 + Math.random() * 0.7,
            }));
            let t = 0; const gateSC = createCanvasActivityGate(canvas);
            (function loop(){
                requestAnimationFrame(loop);
                if (!gateSC.active) return;
                t += 0.01;
                ctx.fillStyle = 'rgba(0,0,0,0.2)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.save();
                ctx.globalCompositeOperation = 'lighter';
                for (const p of particles) {
                    p.x += p.vx; p.y += p.vy;
                    if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                    if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
                    ctx.beginPath();
                    const r = 1.2 + 1.2 * Math.sin(t + p.x * 0.01);
                    ctx.arc(p.x, p.y, r * dpr, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(180,220,255,${0.25 * p.a})`;
                    ctx.fill();
                }
                ctx.strokeStyle = 'rgba(200,220,255,0.12)';
                ctx.lineWidth = 1;
                const step = 36;
                for (let x = 0; x < canvas.width; x += step) { ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke(); }
                for (let y = 0; y < canvas.height; y += step) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke(); }
                ctx.restore();
            })();
        }
    </script>

    <!-- Load optional extra visualizations with cache-busting -->
    <script>
        (function() {
            var s = document.createElement('script');
            s.src = '/featherweight-visualizations.js?v=' + Date.now();
            s.defer = true;
            document.body.appendChild(s);
        })();
    </script>
</body>
</html>
